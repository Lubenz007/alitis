{"/about/":{"data":{"":" More Later :) . "},"title":"alit.is"},"/demo/":{"data":{"":" "},"title":"Docs"},"/demo/finops/":{"data":{"":"Demo report, takes few sec to load."},"title":"Finops Hubs"},"/demo/maester/":{"data":{"":"","cis-131-l1-ensure-the-password-expiration-policy-is-set-to-set-passwords-to-never-expire-recommended#CIS 1.3.1 (L1) Ensure the \u0026lsquo;Password expiration policy\u0026rsquo; is set to \u0026lsquo;Set passwords to never expire (recommended)\u0026rsquo;":"","eidscaaf02-authentication-method---fido2-security-key---allow-self-service-set-up#EIDSCA.AF02: Authentication Method - FIDO2 security key - Allow self-service set up.":"","eidscaaf03-authentication-method---fido2-security-key---enforce-attestation#EIDSCA.AF03: Authentication Method - FIDO2 security key - Enforce attestation.":"","eidscaaf04-authentication-method---fido2-security-key---enforce-key-restrictions#EIDSCA.AF04: Authentication Method - FIDO2 security key - Enforce key restrictions.":"","eidscaaf05-authentication-method---fido2-security-key---restricted#EIDSCA.AF05: Authentication Method - FIDO2 security key - Restricted.":"","eidscaaf06-authentication-method---fido2-security-key---restrict-specific-keys#EIDSCA.AF06: Authentication Method - FIDO2 security key - Restrict specific keys.":"","eidscaam02-authentication-method---microsoft-authenticator---allow-use-of-microsoft-authenticator-otp#EIDSCA.AM02: Authentication Method - Microsoft Authenticator - Allow use of Microsoft Authenticator OTP.":"","eidscaam03-authentication-method---microsoft-authenticator---require-number-matching-for-push-notifications#EIDSCA.AM03: Authentication Method - Microsoft Authenticator - Require number matching for push notifications.":"","eidscaam04-authentication-method---microsoft-authenticator---included-usersgroups-of-number-matching-for-push-notifications#EIDSCA.AM04: Authentication Method - Microsoft Authenticator - Included users/groups of number matching for push notifications.":"","eidscaam06-authentication-method---microsoft-authenticator---show-application-name-in-push-and-passwordless-notifications#EIDSCA.AM06: Authentication Method - Microsoft Authenticator - Show application name in push and passwordless notifications.":"","eidscaam07-authentication-method---microsoft-authenticator---included-usersgroups-to-show-application-name-in-push-and-passwordless-notifications#EIDSCA.AM07: Authentication Method - Microsoft Authenticator - Included users/groups to show application name in push and passwordless notifications.":"","eidscaam09-authentication-method---microsoft-authenticator---show-geographic-location-in-push-and-passwordless-notifications#EIDSCA.AM09: Authentication Method - Microsoft Authenticator - Show geographic location in push and passwordless notifications.":"","eidscaam10-authentication-method---microsoft-authenticator---included-usersgroups-to-show-geographic-location-in-push-and-passwordless-notifications#EIDSCA.AM10: Authentication Method - Microsoft Authenticator - Included users/groups to show geographic location in push and passwordless notifications.":"","eidscaas04-authentication-method---sms---use-for-sign-in#EIDSCA.AS04: Authentication Method - SMS - Use for sign-in.":"","eidscaat02-authentication-method---temporary-access-pass---one-time#EIDSCA.AT02: Authentication Method - Temporary Access Pass - One-time.":"","eidscacp01-default-settings---consent-policy-settings---group-owner-consent-for-apps-accessing-data#EIDSCA.CP01: Default Settings - Consent Policy Settings - Group owner consent for apps accessing data.":"","eidscacp03-default-settings---consent-policy-settings---block-user-consent-for-risky-apps#EIDSCA.CP03: Default Settings - Consent Policy Settings - Block user consent for risky apps.":"","eidscacp04-default-settings---consent-policy-settings---users-can-request-admin-consent-to-apps-they-are-unable-to-consent-to#EIDSCA.CP04: Default Settings - Consent Policy Settings - Users can request admin consent to apps they are unable to consent to.":"","eidscacr02-consent-framework---admin-consent-request---reviewers-will-receive-email-notifications-for-requests#EIDSCA.CR02: Consent Framework - Admin Consent Request - Reviewers will receive email notifications for requests.":"","eidscacr03-consent-framework---admin-consent-request---reviewers-will-receive-email-notifications-when-admin-consent-requests-are-about-to-expire#EIDSCA.CR03: Consent Framework - Admin Consent Request - Reviewers will receive email notifications when admin consent requests are about to expire.":"","eidscacr04-consent-framework---admin-consent-request---consent-request-duration-days#EIDSCA.CR04: Consent Framework - Admin Consent Request - Consent request duration (days).":"","eidscapr01-default-settings---password-rule-settings---password-protection---mode#EIDSCA.PR01: Default Settings - Password Rule Settings - Password Protection - Mode.":"","eidscapr03-default-settings---password-rule-settings---enforce-custom-list#EIDSCA.PR03: Default Settings - Password Rule Settings - Enforce custom list.":"","how-to-fix#How to fix":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--cis-121-l2-ensure-that-only-organizationally-managedapproved-public-groups-exist#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e CIS 1.2.1 (L2) Ensure that only organizationally managed/approved public groups exist":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--cis-133-l2-ensure-external-sharing-of-calendars-is-not-available#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e CIS 1.3.3 (L2) Ensure \u0026lsquo;External sharing\u0026rsquo; of calendars is not available":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--cis-136-l2-ensure-the-customer-lockbox-feature-is-enabled#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e CIS 1.3.6 (L2) Ensure the customer lockbox feature is enabled":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--cis-211-l2-ensure-safe-links-for-office-applications-is-enabled-only-checks-default-policy#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e CIS 2.1.1 (L2) Ensure Safe Links for Office Applications is Enabled (Only Checks Default Policy)":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--cis-213-l1-ensure-notifications-for-internal-users-sending-malware-is-enabled-only-checks-default-policy#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e CIS 2.1.3 (L1) Ensure notifications for internal users sending malware is Enabled (Only Checks Default Policy)":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--cis-215-l2-ensure-safe-attachments-for-sharepoint-onedrive-and-microsoft-teams-is-enabled#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e CIS 2.1.5 (L2) Ensure Safe Attachments for SharePoint, OneDrive, and Microsoft Teams is Enabled":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--cis-216-l1-ensure-exchange-online-spam-policies-are-set-to-notify-administrators-only-checks-default-policy#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e CIS 2.1.6 (L1) Ensure Exchange Online Spam Policies are set to notify administrators (Only Checks Default Policy)":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--cis-217-l1-ensure-that-an-anti-phishing-policy-has-been-created-only-checks-default-policy#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e CIS 2.1.7 (L1) Ensure that an anti-phishing policy has been created (Only Checks Default Policy)":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--eidscaaf01-authentication-method---fido2-security-key---state#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e EIDSCA.AF01: Authentication Method - FIDO2 security key - State.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--eidscaag01-authentication-method---general-settings---manage-migration#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e EIDSCA.AG01: Authentication Method - General Settings - Manage migration.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--eidscaag02-authentication-method---general-settings---report-suspicious-activity---state#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e EIDSCA.AG02: Authentication Method - General Settings - Report suspicious activity - State.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--eidscaam01-authentication-method---microsoft-authenticator---state#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e EIDSCA.AM01: Authentication Method - Microsoft Authenticator - State.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--eidscaap01-default-authorization-settings---enabled-self-service-password-reset-for-administrators#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e EIDSCA.AP01: Default Authorization Settings - Enabled Self service password reset for administrators.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--eidscaap04-default-authorization-settings---guest-invite-restrictions#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e EIDSCA.AP04: Default Authorization Settings - Guest invite restrictions.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--eidscaap05-default-authorization-settings---sign-up-for-email-based-subscription#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e EIDSCA.AP05: Default Authorization Settings - Sign-up for email based subscription.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--eidscaap07-default-authorization-settings---guest-user-access#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e EIDSCA.AP07: Default Authorization Settings - Guest user access.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--eidscaap08-default-authorization-settings---user-consent-policy-assigned-for-applications#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e EIDSCA.AP08: Default Authorization Settings - User consent policy assigned for applications.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--eidscaap09-default-authorization-settings---risk-based-step-up-consent#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e EIDSCA.AP09: Default Authorization Settings - Risk-based step-up consent.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--eidscaap10-default-authorization-settings---default-user-role-permissions---allowed-to-create-apps#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e EIDSCA.AP10: Default Authorization Settings - Default User Role Permissions - Allowed to create Apps.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--eidscaat01-authentication-method---temporary-access-pass---state#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e EIDSCA.AT01: Authentication Method - Temporary Access Pass - State.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--eidscacr01-consent-framework---admin-consent-request---policy-to-enable-or-disable-admin-consent-request-feature#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e EIDSCA.CR01: Consent Framework - Admin Consent Request - Policy to enable or disable admin consent request feature.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--eidscapr02-default-settings---password-rule-settings---password-protection---enable-password-protection-on-windows-server-active-directory#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e EIDSCA.PR02: Default Settings - Password Rule Settings - Password Protection - Enable password protection on Windows Server Active Directory.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--eidscapr05-default-settings---password-rule-settings---smart-lockout---lockout-duration-in-seconds#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e EIDSCA.PR05: Default Settings - Password Rule Settings - Smart Lockout - Lockout duration in seconds.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--eidscapr06-default-settings---password-rule-settings---smart-lockout---lockout-threshold#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e EIDSCA.PR06: Default Settings - Password Rule Settings - Smart Lockout - Lockout threshold.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--eidscast08-default-settings---classification-and-m365-groups---m365-groups---allow-guests-to-become-group-owner#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e EIDSCA.ST08: Default Settings - Classification and M365 Groups - M365 groups - Allow Guests to become Group Owner.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--eidscast09-default-settings---classification-and-m365-groups---m365-groups---allow-guests-to-have-access-to-groups-content#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e EIDSCA.ST09: Default Settings - Classification and M365 Groups - M365 groups - Allow Guests to have access to groups content.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--msaad11-legacy-authentication-shall-be-blocked#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MS.AAD.1.1: Legacy authentication SHALL be blocked.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--msaad21-users-detected-as-high-risk-shall-be-blocked#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MS.AAD.2.1: Users detected as high risk SHALL be blocked.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--msaad23-sign-ins-detected-as-high-risk-shall-be-blocked#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MS.AAD.2.3: Sign-ins detected as high risk SHALL be blocked.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--msaad31-phishing-resistant-mfa-shall-be-enforced-for-all-users#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MS.AAD.3.1: Phishing-resistant MFA SHALL be enforced for all users.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--msaad32-if-phishing-resistant-mfa-has-not-been-enforced-an-alternative-mfa-method-shall-be-enforced-for-all-users#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MS.AAD.3.2: If phishing-resistant MFA has not been enforced, an alternative MFA method SHALL be enforced for all users.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--msaad33-if-phishing-resistant-mfa-has-not-been-enforced-and-microsoft-authenticator-is-enabled-it-shall-be-configured-to-show-login-context-information#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MS.AAD.3.3: If phishing-resistant MFA has not been enforced and Microsoft Authenticator is enabled, it SHALL be configured to show login context information.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--msaad34-the-authentication-methods-manage-migration-feature-shall-be-set-to-migration-complete#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MS.AAD.3.4: The Authentication Methods Manage Migration feature SHALL be set to Migration Complete.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--msaad35-the-authentication-methods-sms-voice-call-and-email-one-time-passcode-otp-shall-be-disabled#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MS.AAD.3.5: The authentication methods SMS, Voice Call, and Email One-Time Passcode (OTP) SHALL be disabled.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--msaad36-phishing-resistant-mfa-shall-be-required-for-highly-privileged-roles#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MS.AAD.3.6: Phishing-resistant MFA SHALL be required for highly privileged roles.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--msaad37-managed-devices-should-be-required-for-authentication#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MS.AAD.3.7: Managed devices SHOULD be required for authentication.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--msaad38-managed-devices-should-be-required-to-register-mfa#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MS.AAD.3.8: Managed Devices SHOULD be required to register MFA.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--msaad41-security-logs-shall-be-sent-to-the-agencys-security-operations-center-for-monitoring#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MS.AAD.4.1: Security logs SHALL be sent to the agency\u0026rsquo;s security operations center for monitoring.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--msaad51-only-administrators-shall-be-allowed-to-register-applications#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MS.AAD.5.1: Only administrators SHALL be allowed to register applications.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--msaad52-only-administrators-shall-be-allowed-to-consent-to-applications#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MS.AAD.5.2: Only administrators SHALL be allowed to consent to applications.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--msaad53-an-admin-consent-workflow-shall-be-configured-for-applications#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MS.AAD.5.3: An admin consent workflow SHALL be configured for applications.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--msaad54-group-owners-shall-not-be-allowed-to-consent-to-applications#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MS.AAD.5.4: Group owners SHALL NOT be allowed to consent to applications.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--msaad72-privileged-users-shall-be-provisioned-with-finer-grained-roles-instead-of-global-administrator#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MS.AAD.7.2: Privileged users SHALL be provisioned with finer-grained roles instead of Global Administrator.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--msaad74-permanent-active-role-assignments-shall-not-be-allowed-for-highly-privileged-roles#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MS.AAD.7.4: Permanent active role assignments SHALL NOT be allowed for highly privileged roles.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--msaad76-activation-of-the-global-administrator-role-shall-require-approval#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MS.AAD.7.6: Activation of the Global Administrator role SHALL require approval.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--msaad77-eligible-and-active-highly-privileged-role-assignments-shall-trigger-an-alert#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MS.AAD.7.7: Eligible and Active highly privileged role assignments SHALL trigger an alert.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--msaad78-user-activation-of-the-global-administrator-role-shall-trigger-an-alert#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MS.AAD.7.8: User activation of the Global Administrator role SHALL trigger an alert.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--msaad79-user-activation-of-other-highly-privileged-roles-should-trigger-an-alert#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MS.AAD.7.9: User activation of other highly privileged roles SHOULD trigger an alert.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--msaad82-only-users-with-the-guest-inviter-role-should-be-able-to-invite-guest-users#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MS.AAD.8.2: Only users with the Guest Inviter role SHOULD be able to invite guest users.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--msaad83-guest-invites-should-only-be-allowed-to-specific-external-domains-that-have-been-authorized-by-the-agency-for-legitimate-business-purposes#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MS.AAD.8.3: Guest invites SHOULD only be allowed to specific external domains that have been authorized by the agency for legitimate business purposes.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--msexo011-automatic-forwarding-to-external-domains-shall-be-disabled#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MS.EXO.01.1: Automatic forwarding to external domains SHALL be disabled.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--msexo022-an-spf-policy-shall-be-published-for-each-domain-designating-only-these-addresses-as-approved-senders#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MS.EXO.02.2: An SPF policy SHALL be published for each domain, designating only these addresses as approved senders.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--msexo031-dkim-should-be-enabled-for-all-domains#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MS.EXO.03.1: DKIM SHOULD be enabled for all domains.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--msexo041-a-dmarc-policy-shall-be-published-for-every-second-level-domain#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MS.EXO.04.1: A DMARC policy SHALL be published for every second-level domain.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--msexo042-the-dmarc-message-rejection-option-shall-be-preject#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MS.EXO.04.2: The DMARC message rejection option SHALL be p=reject.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--msexo062-calendar-details-shall-not-be-shared-with-all-domains#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MS.EXO.06.2: Calendar details SHALL NOT be shared with all domains.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--msexo071-external-sender-warnings-shall-be-implemented#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MS.EXO.07.1: External sender warnings SHALL be implemented.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--msexo081-a-dlp-solution-shall-be-used#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MS.EXO.08.1: A DLP solution SHALL be used.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--msexo082-the-dlp-solution-shall-protect-personally-identifiable-information-pii-and-sensitive-information-as-defined-by-the-agency#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MS.EXO.08.2: The DLP solution SHALL protect personally identifiable information (PII) and sensitive information, as defined by the agency.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--msexo091-emails-shall-be-filtered-by-attachment-file-types#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MS.EXO.09.1: Emails SHALL be filtered by attachment file types.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--msexo092-the-attachment-filter-should-attempt-to-determine-the-true-file-type-and-assess-the-file-extension#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MS.EXO.09.2: The attachment filter SHOULD attempt to determine the true file type and assess the file extension.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--msexo093-disallowed-file-types-shall-be-determined-and-enforced#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MS.EXO.09.3: Disallowed file types SHALL be determined and enforced.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--msexo095-at-a-minimum-click-to-run-files-should-be-blocked-eg-exe-cmd-and-vbe#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MS.EXO.09.5: At a minimum, click-to-run files SHOULD be blocked (e.g., .exe, .cmd, and .vbe).":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--msexo101-emails-shall-be-scanned-for-malware#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MS.EXO.10.1: Emails SHALL be scanned for malware.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--msexo102-emails-identified-as-containing-malware-shall-be-quarantined-or-dropped#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MS.EXO.10.2: Emails identified as containing malware SHALL be quarantined or dropped.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--msexo103-email-scanning-shall-be-capable-of-reviewing-emails-after-delivery#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MS.EXO.10.3: Email scanning SHALL be capable of reviewing emails after delivery.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--msexo111-impersonation-protection-checks-should-be-used#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MS.EXO.11.1: Impersonation protection checks SHOULD be used.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--msexo112-user-warnings-comparable-to-the-user-safety-tips-included-with-eop-should-be-displayed#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MS.EXO.11.2: User warnings, comparable to the user safety tips included with EOP, SHOULD be displayed.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--msexo113-the-phishing-protection-solution-should-include-an-ai-based-phishing-detection-tool-comparable-to-eop-mailbox-intelligence#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MS.EXO.11.3: The phishing protection solution SHOULD include an AI-based phishing detection tool comparable to EOP Mailbox Intelligence.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--msexo141-a-spam-filter-shall-be-enabled#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MS.EXO.14.1: A spam filter SHALL be enabled.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--msexo142-spam-and-high-confidence-spam-shall-be-moved-to-either-the-junk-email-folder-or-the-quarantine-folder#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MS.EXO.14.2: Spam and high confidence spam SHALL be moved to either the junk email folder or the quarantine folder.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--msexo143-allowed-domains-shall-not-be-added-to-inbound-anti-spam-protection-policies#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MS.EXO.14.3: Allowed domains SHALL NOT be added to inbound anti-spam protection policies.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--msexo151-url-comparison-with-a-block-list-should-be-enabled#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MS.EXO.15.1: URL comparison with a block-list SHOULD be enabled.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--msexo152-direct-download-links-should-be-scanned-for-malware#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MS.EXO.15.2: Direct download links SHOULD be scanned for malware.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--msexo153-user-click-tracking-should-be-enabled#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MS.EXO.15.3: User click tracking SHOULD be enabled.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--msexo171-microsoft-purview-audit-standard-logging-shall-be-enabled#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MS.EXO.17.1: Microsoft Purview Audit (Standard) logging SHALL be enabled.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--msexo173-audit-logs-shall-be-maintained-for-at-least-the-minimum-duration-dictated-by-omb-m-21-31-appendix-c#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MS.EXO.17.3: Audit logs SHALL be maintained for at least the minimum duration dictated by OMB M-21-31 (Appendix C).":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--mssharepoint11-external-sharing-for-sharepoint-shall-be-limited-to-existing-guests-or-only-people-in-your-organization#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MS.SHAREPOINT.1.1: External sharing for SharePoint SHALL be limited to Existing guests or Only People in your organization.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--mssharepoint13-external-sharing-shall-be-restricted-to-approved-external-domains-andor-users-in-approved-security-groups-per-interagency-collaboration-needs#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MS.SHAREPOINT.1.3: External sharing SHALL be restricted to approved external domains and/or users in approved security groups per interagency collaboration needs.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--mt1001-at-least-one-conditional-access-policy-is-configured-with-device-compliance#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MT.1001: At least one Conditional Access policy is configured with device compliance.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--mt1003-at-least-one-conditional-access-policy-is-configured-with-all-apps#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MT.1003: At least one Conditional Access policy is configured with All Apps.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--mt1004-at-least-one-conditional-access-policy-is-configured-with-all-apps-and-all-users#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MT.1004: At least one Conditional Access policy is configured with All Apps and All Users.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--mt1006-at-least-one-conditional-access-policy-is-configured-to-require-mfa-for-admins#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MT.1006: At least one Conditional Access policy is configured to require MFA for admins.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--mt1007-at-least-one-conditional-access-policy-is-configured-to-require-mfa-for-all-users#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MT.1007: At least one Conditional Access policy is configured to require MFA for all users.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--mt1008-at-least-one-conditional-access-policy-is-configured-to-require-mfa-for-azure-management#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MT.1008: At least one Conditional Access policy is configured to require MFA for Azure management.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--mt1009-at-least-one-conditional-access-policy-is-configured-to-block-other-legacy-authentication#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MT.1009: At least one Conditional Access policy is configured to block other legacy authentication.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--mt1010-at-least-one-conditional-access-policy-is-configured-to-block-legacy-authentication-for-exchange-activesync#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MT.1010: At least one Conditional Access policy is configured to block legacy authentication for Exchange ActiveSync.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--mt1011-at-least-one-conditional-access-policy-is-configured-to-secure-security-info-registration-only-from-a-trusted-location#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MT.1011: At least one Conditional Access policy is configured to secure security info registration only from a trusted location.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--mt1012-at-least-one-conditional-access-policy-is-configured-to-require-mfa-for-risky-sign-ins#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MT.1012: At least one Conditional Access policy is configured to require MFA for risky sign-ins.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--mt1013-at-least-one-conditional-access-policy-is-configured-to-require-new-password-when-user-risk-is-high#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MT.1013: At least one Conditional Access policy is configured to require new password when user risk is high.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--mt1014-at-least-one-conditional-access-policy-is-configured-to-require-compliant-or-entra-hybrid-joined-devices-for-admins#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MT.1014: At least one Conditional Access policy is configured to require compliant or Entra hybrid joined devices for admins.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--mt1015-at-least-one-conditional-access-policy-is-configured-to-block-access-for-unknown-or-unsupported-device-platforms#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MT.1015: At least one Conditional Access policy is configured to block access for unknown or unsupported device platforms.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--mt1016-at-least-one-conditional-access-policy-is-configured-to-require-mfa-for-guest-access#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MT.1016: At least one Conditional Access policy is configured to require MFA for guest access.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--mt1017-at-least-one-conditional-access-policy-is-configured-to-enforce-non-persistent-browser-session-for-non-corporate-devices#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MT.1017: At least one Conditional Access policy is configured to enforce non persistent browser session for non-corporate devices.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--mt1018-at-least-one-conditional-access-policy-is-configured-to-enforce-sign-in-frequency-for-non-corporate-devices#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MT.1018: At least one Conditional Access policy is configured to enforce sign-in frequency for non-corporate devices.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--mt1019-at-least-one-conditional-access-policy-is-configured-to-enable-application-enforced-restrictions#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MT.1019: At least one Conditional Access policy is configured to enable application enforced restrictions.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--mt1024-entra-recommendation---designate-more-than-one-global-admin#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MT.1024: Entra Recommendation - Designate more than one global admin.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--mt1024-entra-recommendation---do-not-allow-users-to-grant-consent-to-unreliable-applications#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MT.1024: Entra Recommendation - Do not allow users to grant consent to unreliable applications.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--mt1024-entra-recommendation---enable-self-service-password-reset#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MT.1024: Entra Recommendation - Enable self-service password reset.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--mt1024-entra-recommendation---protect-your-tenant-with-insider-risk-condition-in-conditional-access-policy#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MT.1024: Entra Recommendation - Protect your tenant with Insider Risk condition in Conditional Access policy.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--mt1024-entra-recommendation---remove-unused-applications#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MT.1024: Entra Recommendation - Remove unused applications.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--mt1024-entra-recommendation---remove-unused-credentials-from-applications#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MT.1024: Entra Recommendation - Remove unused credentials from applications.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--mt1028-no-user-with-mailbox-and-permanent-role-assignment-on-control-plane#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MT.1028: No user with mailbox and permanent role assignment on Control Plane.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--mt1029-stale-accounts-are-not-assigned-to-privileged-roles#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MT.1029: Stale accounts are not assigned to privileged roles.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--mt1030-eligible-role-assignments-on-control-plane-are-in-use-by-administrators#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MT.1030: Eligible role assignments on Control Plane are in use by administrators.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--mt1031-privileged-role-on-control-plane-are-managed-by-pim-only#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MT.1031: Privileged role on Control Plane are managed by PIM only.":"","img-srchttpsmaesterdevimgtest-resulticon-failpng-altfailed-icon-height18--mt1032-limited-number-of-global-admins-are-assigned#\u003cimg src=\"https://maester.dev/img/test-result/icon-fail.png\" alt=\"Failed icon\" height=\"18\" /\u003e MT.1032: Limited number of Global Admins are assigned.":"","img-srchttpsmaesterdevimgtest-resulticon-notrunpng-altnot-run-icon-height18--mt1033-user-should-be-blocked-from-using-legacy-authentication-userprincipalname#\u003cimg src=\"https://maester.dev/img/test-result/icon-notrun.png\" alt=\"Not Run icon\" height=\"18\" /\u003e MT.1033: User should be blocked from using legacy authentication (\u003cuserPrincipalName\u003e)":"","img-srchttpsmaesterdevimgtest-resulticon-notrunpng-altnot-run-icon-height18--mt1033-user-should-be-blocked-from-using-legacy-authentication-userprincipalname-1#\u003cimg src=\"https://maester.dev/img/test-result/icon-notrun.png\" alt=\"Not Run icon\" height=\"18\" /\u003e MT.1033: User should be blocked from using legacy authentication (\u003cuserPrincipalName\u003e)":"","img-srchttpsmaesterdevimgtest-resulticon-notrunpng-altnot-run-icon-height18--mt1033-user-should-be-blocked-from-using-legacy-authentication-userprincipalname-2#\u003cimg src=\"https://maester.dev/img/test-result/icon-notrun.png\" alt=\"Not Run icon\" height=\"18\" /\u003e MT.1033: User should be blocked from using legacy authentication (\u003cuserPrincipalName\u003e)":"","img-srchttpsmaesterdevimgtest-resulticon-notrunpng-altnot-run-icon-height18--mt1033-user-should-be-blocked-from-using-legacy-authentication-userprincipalname-3#\u003cimg src=\"https://maester.dev/img/test-result/icon-notrun.png\" alt=\"Not Run icon\" height=\"18\" /\u003e MT.1033: User should be blocked from using legacy authentication (\u003cuserPrincipalName\u003e)":"","img-srchttpsmaesterdevimgtest-resulticon-notrunpng-altnot-run-icon-height18--mt1033-user-should-be-blocked-from-using-legacy-authentication-userprincipalname-4#\u003cimg src=\"https://maester.dev/img/test-result/icon-notrun.png\" alt=\"Not Run icon\" height=\"18\" /\u003e MT.1033: User should be blocked from using legacy authentication (\u003cuserPrincipalName\u003e)":"","img-srchttpsmaesterdevimgtest-resulticon-passpng-altpassed-icon-height18--cis-111-l1-ensure-administrative-accounts-are-separate-and-cloud-only#\u003cimg src=\"https://maester.dev/img/test-result/icon-pass.png\" alt=\"Passed icon\" height=\"18\" /\u003e CIS 1.1.1 (L1) Ensure Administrative accounts are separate and cloud-only":"","img-srchttpsmaesterdevimgtest-resulticon-passpng-altpassed-icon-height18--cis-113-l1-ensure-that-between-two-and-four-global-admins-are-designated#\u003cimg src=\"https://maester.dev/img/test-result/icon-pass.png\" alt=\"Passed icon\" height=\"18\" /\u003e CIS 1.1.3 (L1) Ensure that between two and four global admins are designated":"","img-srchttpsmaesterdevimgtest-resulticon-passpng-altpassed-icon-height18--cis-122-l1-ensure-sign-in-to-shared-mailboxes-is-blocked#\u003cimg src=\"https://maester.dev/img/test-result/icon-pass.png\" alt=\"Passed icon\" height=\"18\" /\u003e CIS 1.2.2 (L1) Ensure sign-in to shared mailboxes is blocked":"","img-srchttpsmaesterdevimgtest-resulticon-passpng-altpassed-icon-height18--cis-212-l1-ensure-the-common-attachment-types-filter-is-enabled-only-checks-default-policy#\u003cimg src=\"https://maester.dev/img/test-result/icon-pass.png\" alt=\"Passed icon\" height=\"18\" /\u003e CIS 2.1.2 (L1) Ensure the Common Attachment Types Filter is enabled (Only Checks Default Policy)":"","img-srchttpsmaesterdevimgtest-resulticon-passpng-altpassed-icon-height18--cis-214-l2-ensure-safe-attachments-policy-is-enabled-only-checks-default-policy#\u003cimg src=\"https://maester.dev/img/test-result/icon-pass.png\" alt=\"Passed icon\" height=\"18\" /\u003e CIS 2.1.4 (L2) Ensure Safe Attachments policy is enabled (Only Checks Default Policy)":"","img-srchttpsmaesterdevimgtest-resulticon-passpng-altpassed-icon-height18--eidscaag03-authentication-method---general-settings---report-suspicious-activity---included-usersgroups#\u003cimg src=\"https://maester.dev/img/test-result/icon-pass.png\" alt=\"Passed icon\" height=\"18\" /\u003e EIDSCA.AG03: Authentication Method - General Settings - Report suspicious activity - Included users/groups.":"","img-srchttpsmaesterdevimgtest-resulticon-passpng-altpassed-icon-height18--eidscaap06-default-authorization-settings---user-can-join-the-tenant-by-email-validation#\u003cimg src=\"https://maester.dev/img/test-result/icon-pass.png\" alt=\"Passed icon\" height=\"18\" /\u003e EIDSCA.AP06: Default Authorization Settings - User can join the tenant by email validation.":"","img-srchttpsmaesterdevimgtest-resulticon-passpng-altpassed-icon-height18--eidscaap14-default-authorization-settings---default-user-role-permissions---allowed-to-read-other-users#\u003cimg src=\"https://maester.dev/img/test-result/icon-pass.png\" alt=\"Passed icon\" height=\"18\" /\u003e EIDSCA.AP14: Default Authorization Settings - Default User Role Permissions - Allowed to read other users.":"","img-srchttpsmaesterdevimgtest-resulticon-passpng-altpassed-icon-height18--eidscaav01-authentication-method---voice-call---state#\u003cimg src=\"https://maester.dev/img/test-result/icon-pass.png\" alt=\"Passed icon\" height=\"18\" /\u003e EIDSCA.AV01: Authentication Method - Voice call - State.":"","img-srchttpsmaesterdevimgtest-resulticon-passpng-altpassed-icon-height18--msaad22-a-notification-should-be-sent-to-the-administrator-when-high-risk-users-are-detected#\u003cimg src=\"https://maester.dev/img/test-result/icon-pass.png\" alt=\"Passed icon\" height=\"18\" /\u003e MS.AAD.2.2: A notification SHOULD be sent to the administrator when high-risk users are detected.":"","img-srchttpsmaesterdevimgtest-resulticon-passpng-altpassed-icon-height18--msaad61-user-passwords-shall-not-expire#\u003cimg src=\"https://maester.dev/img/test-result/icon-pass.png\" alt=\"Passed icon\" height=\"18\" /\u003e MS.AAD.6.1: User passwords SHALL NOT expire.":"","img-srchttpsmaesterdevimgtest-resulticon-passpng-altpassed-icon-height18--msaad71-a-minimum-of-two-users-and-a-maximum-of-eight-users-shall-be-provisioned-with-the-global-administrator-role#\u003cimg src=\"https://maester.dev/img/test-result/icon-pass.png\" alt=\"Passed icon\" height=\"18\" /\u003e MS.AAD.7.1: A minimum of two users and a maximum of eight users SHALL be provisioned with the Global Administrator role.":"","img-srchttpsmaesterdevimgtest-resulticon-passpng-altpassed-icon-height18--msaad73-privileged-users-shall-be-provisioned-cloud-only-accounts-separate-from-an-on-premises-directory-or-other-federated-identity-providers#\u003cimg src=\"https://maester.dev/img/test-result/icon-pass.png\" alt=\"Passed icon\" height=\"18\" /\u003e MS.AAD.7.3: Privileged users SHALL be provisioned cloud-only accounts separate from an on-premises directory or other federated identity providers.":"","img-srchttpsmaesterdevimgtest-resulticon-passpng-altpassed-icon-height18--msaad75-provisioning-users-to-highly-privileged-roles-shall-not-occur-outside-of-a-pam-system#\u003cimg src=\"https://maester.dev/img/test-result/icon-pass.png\" alt=\"Passed icon\" height=\"18\" /\u003e MS.AAD.7.5: Provisioning users to highly privileged roles SHALL NOT occur outside of a PAM system.":"","img-srchttpsmaesterdevimgtest-resulticon-passpng-altpassed-icon-height18--msaad81-guest-users-should-have-limited-or-restricted-access-to-azure-ad-directory-objects#\u003cimg src=\"https://maester.dev/img/test-result/icon-pass.png\" alt=\"Passed icon\" height=\"18\" /\u003e MS.AAD.8.1: Guest users SHOULD have limited or restricted access to Azure AD directory objects.":"","img-srchttpsmaesterdevimgtest-resulticon-passpng-altpassed-icon-height18--msexo021-a-list-of-approved-ip-addresses-for-sending-mail-shall-be-maintained#\u003cimg src=\"https://maester.dev/img/test-result/icon-pass.png\" alt=\"Passed icon\" height=\"18\" /\u003e MS.EXO.02.1: A list of approved IP addresses for sending mail SHALL be maintained.":"","img-srchttpsmaesterdevimgtest-resulticon-passpng-altpassed-icon-height18--msexo051-smtp-auth-shall-be-disabled#\u003cimg src=\"https://maester.dev/img/test-result/icon-pass.png\" alt=\"Passed icon\" height=\"18\" /\u003e MS.EXO.05.1: SMTP AUTH SHALL be disabled.":"","img-srchttpsmaesterdevimgtest-resulticon-passpng-altpassed-icon-height18--msexo061-contact-folders-shall-not-be-shared-with-all-domains#\u003cimg src=\"https://maester.dev/img/test-result/icon-pass.png\" alt=\"Passed icon\" height=\"18\" /\u003e MS.EXO.06.1: Contact folders SHALL NOT be shared with all domains.":"","img-srchttpsmaesterdevimgtest-resulticon-passpng-altpassed-icon-height18--msexo084-at-a-minimum-the-dlp-solution-shall-restrict-sharing-credit-card-numbers-us-individual-taxpayer-identification-numbers-itin-and-us-social-security-numbers-ssn-via-email#\u003cimg src=\"https://maester.dev/img/test-result/icon-pass.png\" alt=\"Passed icon\" height=\"18\" /\u003e MS.EXO.08.4: At a minimum, the DLP solution SHALL restrict sharing credit card numbers, U.S. Individual Taxpayer Identification Numbers (ITIN), and U.S. Social Security numbers (SSN) via email.":"","img-srchttpsmaesterdevimgtest-resulticon-passpng-altpassed-icon-height18--msexo121-ip-allow-lists-should-not-be-created#\u003cimg src=\"https://maester.dev/img/test-result/icon-pass.png\" alt=\"Passed icon\" height=\"18\" /\u003e MS.EXO.12.1: IP allow lists SHOULD NOT be created.":"","img-srchttpsmaesterdevimgtest-resulticon-passpng-altpassed-icon-height18--msexo122-safe-lists-should-not-be-enabled#\u003cimg src=\"https://maester.dev/img/test-result/icon-pass.png\" alt=\"Passed icon\" height=\"18\" /\u003e MS.EXO.12.2: Safe lists SHOULD NOT be enabled.":"","img-srchttpsmaesterdevimgtest-resulticon-passpng-altpassed-icon-height18--msexo131-mailbox-auditing-shall-be-enabled#\u003cimg src=\"https://maester.dev/img/test-result/icon-pass.png\" alt=\"Passed icon\" height=\"18\" /\u003e MS.EXO.13.1: Mailbox auditing SHALL be enabled.":"","img-srchttpsmaesterdevimgtest-resulticon-passpng-altpassed-icon-height18--msexo161-alerts-shall-be-enabled#\u003cimg src=\"https://maester.dev/img/test-result/icon-pass.png\" alt=\"Passed icon\" height=\"18\" /\u003e MS.EXO.16.1: Alerts SHALL be enabled.":"","img-srchttpsmaesterdevimgtest-resulticon-passpng-altpassed-icon-height18--msexo172-microsoft-purview-audit-premium-logging-shall-be-enabled#\u003cimg src=\"https://maester.dev/img/test-result/icon-pass.png\" alt=\"Passed icon\" height=\"18\" /\u003e MS.EXO.17.2: Microsoft Purview Audit (Premium) logging SHALL be enabled.":"","img-srchttpsmaesterdevimgtest-resulticon-passpng-altpassed-icon-height18--mt1005-all-conditional-access-policies-are-configured-to-exclude-at-least-one-emergencybreak-glass-account-or-group#\u003cimg src=\"https://maester.dev/img/test-result/icon-pass.png\" alt=\"Passed icon\" height=\"18\" /\u003e MT.1005: All Conditional Access policies are configured to exclude at least one emergency/break glass account or group.":"","img-srchttpsmaesterdevimgtest-resulticon-passpng-altpassed-icon-height18--mt1020-all-conditional-access-policies-are-configured-to-exclude-directory-synchronization-accounts-or-do-not-scope-them#\u003cimg src=\"https://maester.dev/img/test-result/icon-pass.png\" alt=\"Passed icon\" height=\"18\" /\u003e MT.1020: All Conditional Access policies are configured to exclude directory synchronization accounts or do not scope them.":"","img-srchttpsmaesterdevimgtest-resulticon-passpng-altpassed-icon-height18--mt1022-all-users-utilizing-a-p1-license-should-be-licensed#\u003cimg src=\"https://maester.dev/img/test-result/icon-pass.png\" alt=\"Passed icon\" height=\"18\" /\u003e MT.1022: All users utilizing a P1 license should be licensed.":"","img-srchttpsmaesterdevimgtest-resulticon-passpng-altpassed-icon-height18--mt1023-all-users-utilizing-a-p2-license-should-be-licensed#\u003cimg src=\"https://maester.dev/img/test-result/icon-pass.png\" alt=\"Passed icon\" height=\"18\" /\u003e MT.1023: All users utilizing a P2 license should be licensed.":"","img-srchttpsmaesterdevimgtest-resulticon-passpng-altpassed-icon-height18--mt1024-entra-recommendation---do-not-expire-passwords#\u003cimg src=\"https://maester.dev/img/test-result/icon-pass.png\" alt=\"Passed icon\" height=\"18\" /\u003e MT.1024: Entra Recommendation - Do not expire passwords.":"","img-srchttpsmaesterdevimgtest-resulticon-passpng-altpassed-icon-height18--mt1024-entra-recommendation---enable-password-hash-sync-if-hybrid#\u003cimg src=\"https://maester.dev/img/test-result/icon-pass.png\" alt=\"Passed icon\" height=\"18\" /\u003e MT.1024: Entra Recommendation - Enable password hash sync if hybrid.":"","img-srchttpsmaesterdevimgtest-resulticon-passpng-altpassed-icon-height18--mt1024-entra-recommendation---migrate-service-principals-from-the-retiring-azure-ad-graph-apis-to-microsoft-graph#\u003cimg src=\"https://maester.dev/img/test-result/icon-pass.png\" alt=\"Passed icon\" height=\"18\" /\u003e MT.1024: Entra Recommendation - Migrate Service Principals from the retiring Azure AD Graph APIs to Microsoft Graph.":"","img-srchttpsmaesterdevimgtest-resulticon-passpng-altpassed-icon-height18--mt1024-entra-recommendation---renew-expiring-application-credentials#\u003cimg src=\"https://maester.dev/img/test-result/icon-pass.png\" alt=\"Passed icon\" height=\"18\" /\u003e MT.1024: Entra Recommendation - Renew expiring application credentials.":"","img-srchttpsmaesterdevimgtest-resulticon-passpng-altpassed-icon-height18--mt1024-entra-recommendation---renew-expiring-service-principal-credentials#\u003cimg src=\"https://maester.dev/img/test-result/icon-pass.png\" alt=\"Passed icon\" height=\"18\" /\u003e MT.1024: Entra Recommendation - Renew expiring service principal credentials.":"","img-srchttpsmaesterdevimgtest-resulticon-passpng-altpassed-icon-height18--mt1024-entra-recommendation---use-least-privileged-administrative-roles-#\u003cimg src=\"https://maester.dev/img/test-result/icon-pass.png\" alt=\"Passed icon\" height=\"18\" /\u003e MT.1024: Entra Recommendation - Use least privileged administrative roles .":"","img-srchttpsmaesterdevimgtest-resulticon-passpng-altpassed-icon-height18--mt1025-no-external-user-with-permanent-role-assignment-on-control-plane#\u003cimg src=\"https://maester.dev/img/test-result/icon-pass.png\" alt=\"Passed icon\" height=\"18\" /\u003e MT.1025: No external user with permanent role assignment on Control Plane.":"","img-srchttpsmaesterdevimgtest-resulticon-passpng-altpassed-icon-height18--mt1026-no-hybrid-user-with-permanent-role-assignment-on-control-plane#\u003cimg src=\"https://maester.dev/img/test-result/icon-pass.png\" alt=\"Passed icon\" height=\"18\" /\u003e MT.1026: No hybrid user with permanent role assignment on Control Plane.":"","img-srchttpsmaesterdevimgtest-resulticon-passpng-altpassed-icon-height18--mt1027-no-service-principal-with-client-secret-and-permanent-role-assignment-on-control-plane#\u003cimg src=\"https://maester.dev/img/test-result/icon-pass.png\" alt=\"Passed icon\" height=\"18\" /\u003e MT.1027: No Service Principal with Client Secret and permanent role assignment on Control Plane.":"","img-srchttpsmaesterdevimgtest-resulticon-passpng-altpassed-icon-height18--mt1035-all-security-groups-assigned-to-conditional-access-policies-should-be-protected-by-rmau#\u003cimg src=\"https://maester.dev/img/test-result/icon-pass.png\" alt=\"Passed icon\" height=\"18\" /\u003e MT.1035: All security groups assigned to Conditional Access Policies should be protected by RMAU.":"","img-srchttpsmaesterdevimgtest-resulticon-passpng-altpassed-icon-height18--mt1036-all-excluded-objects-should-have-a-fallback-include-in-another-policy#\u003cimg src=\"https://maester.dev/img/test-result/icon-pass.png\" alt=\"Passed icon\" height=\"18\" /\u003e MT.1036: All excluded objects should have a fallback include in another policy.":"","img-srchttpsmaesterdevimgtest-resulticon-passpng-altpassed-icon-height18--mt1038-conditional-access-policies-should-not-include-or-exclude-deleted-groups#\u003cimg src=\"https://maester.dev/img/test-result/icon-pass.png\" alt=\"Passed icon\" height=\"18\" /\u003e MT.1038: Conditional Access policies should not include or exclude deleted groups.":"","learn-more#Learn more":"","msexo043-the-dmarc-point-of-contact-for-aggregate-reports-shall-include-reportsdmarccyberdhsgov#MS.EXO.04.3: The DMARC point of contact for aggregate reports SHALL include \u003ca href=\"mailto:reports@dmarc.cyber.dhs.gov\"\u003ereports@dmarc.cyber.dhs.gov\u003c/a\u003e.":"","msexo083-the-selected-dlp-solution-should-offer-services-comparable-to-the-native-dlp-solution-offered-by-microsoft#MS.EXO.08.3: The selected DLP solution SHOULD offer services comparable to the native DLP solution offered by Microsoft.":"","msexo094-alternatively-chosen-filtering-solutions-should-offer-services-comparable-to-microsoft-defenders-common-attachment-filter#MS.EXO.09.4: Alternatively chosen filtering solutions SHOULD offer services comparable to Microsoft Defender\u0026rsquo;s Common Attachment Filter.":"","msexo144-if-a-third-party-party-filtering-solution-is-used-the-solution-should-offer-services-comparable-to-the-native-spam-filtering-offered-by-microsoft#MS.EXO.14.4: If a third-party party filtering solution is used, the solution SHOULD offer services comparable to the native spam filtering offered by Microsoft.":"","msexo162-alerts-should-be-sent-to-a-monitored-address-or-incorporated-into-a-security-information-and-event-management-siem-system#MS.EXO.16.2: Alerts SHOULD be sent to a monitored address or incorporated into a security information and event management (SIEM) system.":"","mt1002-app-management-restrictions-on-applications-and-service-principals-is-configured-and-enabled#MT.1002: App management restrictions on applications and service principals is configured and enabled.":"","mt1021-security-defaults-are-enabled#MT.1021: Security Defaults are enabled.":"","mt1037-only-users-with-presenter-role-are-allowed-to-present-in-teams-meetings#MT.1037 Only users with Presenter role are allowed to present in Teams meetings":"","mt1038-only-invited-users-should-be-automatically-admitted-to-teams-meetings#MT.1038 Only invited users should be automatically admitted to Teams meetings":"","mt1039-restrict-anonymous-users-from-joining-meetings#MT.1039 Restrict anonymous users from joining meetings":"","mt1040-restrict-anonymous-users-from-starting-teams-meetings#MT.1040 Restrict anonymous users from starting Teams meetings":"","mt1041-limit-external-participants-from-having-control-in-a-teams-meeting#MT.1041 Limit external participants from having control in a Teams meeting":"","mt1042-restrict-dial-in-users-from-bypassing-a-meeting-lobby#MT.1042 Restrict dial-in users from bypassing a meeting lobby":"Test summary Test Status CIS 1.1.1 (L1) Ensure Administrative accounts are separate and cloud-only CIS 1.1.3 (L1) Ensure that between two and four global admins are designated CIS 1.2.1 (L2) Ensure that only organizationally managed/approved public groups exist CIS 1.2.2 (L1) Ensure sign-in to shared mailboxes is blocked CIS 1.3.3 (L2) Ensure ‘External sharing’ of calendars is not available CIS 1.3.6 (L2) Ensure the customer lockbox feature is enabled CIS 2.1.1 (L2) Ensure Safe Links for Office Applications is Enabled (Only Checks Default Policy) CIS 2.1.2 (L1) Ensure the Common Attachment Types Filter is enabled (Only Checks Default Policy) CIS 2.1.3 (L1) Ensure notifications for internal users sending malware is Enabled (Only Checks Default Policy) CIS 2.1.4 (L2) Ensure Safe Attachments policy is enabled (Only Checks Default Policy) CIS 2.1.5 (L2) Ensure Safe Attachments for SharePoint, OneDrive, and Microsoft Teams is Enabled CIS 2.1.6 (L1) Ensure Exchange Online Spam Policies are set to notify administrators (Only Checks Default Policy) CIS 2.1.7 (L1) Ensure that an anti-phishing policy has been created (Only Checks Default Policy) EIDSCA.AF01: Authentication Method - FIDO2 security key - State. EIDSCA.AG01: Authentication Method - General Settings - Manage migration. EIDSCA.AG02: Authentication Method - General Settings - Report suspicious activity - State. EIDSCA.AG03: Authentication Method - General Settings - Report suspicious activity - Included users/groups. EIDSCA.AM01: Authentication Method - Microsoft Authenticator - State. EIDSCA.AP01: Default Authorization Settings - Enabled Self service password reset for administrators. EIDSCA.AP04: Default Authorization Settings - Guest invite restrictions. EIDSCA.AP05: Default Authorization Settings - Sign-up for email based subscription. EIDSCA.AP06: Default Authorization Settings - User can join the tenant by email validation. EIDSCA.AP07: Default Authorization Settings - Guest user access. EIDSCA.AP08: Default Authorization Settings - User consent policy assigned for applications. EIDSCA.AP09: Default Authorization Settings - Risk-based step-up consent. EIDSCA.AP10: Default Authorization Settings - Default User Role Permissions - Allowed to create Apps. EIDSCA.AP14: Default Authorization Settings - Default User Role Permissions - Allowed to read other users. EIDSCA.AT01: Authentication Method - Temporary Access Pass - State. EIDSCA.AV01: Authentication Method - Voice call - State. EIDSCA.CR01: Consent Framework - Admin Consent Request - Policy to enable or disable admin consent request feature. EIDSCA.PR02: Default Settings - Password Rule Settings - Password Protection - Enable password protection on Windows Server Active Directory. EIDSCA.PR05: Default Settings - Password Rule Settings - Smart Lockout - Lockout duration in seconds. EIDSCA.PR06: Default Settings - Password Rule Settings - Smart Lockout - Lockout threshold. EIDSCA.ST08: Default Settings - Classification and M365 Groups - M365 groups - Allow Guests to become Group Owner. EIDSCA.ST09: Default Settings - Classification and M365 Groups - M365 groups - Allow Guests to have access to groups content. MS.AAD.1.1: Legacy authentication SHALL be blocked. MS.AAD.2.1: Users detected as high risk SHALL be blocked. MS.AAD.2.2: A notification SHOULD be sent to the administrator when high-risk users are detected. MS.AAD.2.3: Sign-ins detected as high risk SHALL be blocked. MS.AAD.3.1: Phishing-resistant MFA SHALL be enforced for all users. MS.AAD.3.2: If phishing-resistant MFA has not been enforced, an alternative MFA method SHALL be enforced for all users. MS.AAD.3.3: If phishing-resistant MFA has not been enforced and Microsoft Authenticator is enabled, it SHALL be configured to show login context information. MS.AAD.3.4: The Authentication Methods Manage Migration feature SHALL be set to Migration Complete. MS.AAD.3.5: The authentication methods SMS, Voice Call, and Email One-Time Passcode (OTP) SHALL be disabled. MS.AAD.3.6: Phishing-resistant MFA SHALL be required for highly privileged roles. MS.AAD.3.7: Managed devices SHOULD be required for authentication. MS.AAD.3.8: Managed Devices SHOULD be required to register MFA. MS.AAD.4.1: Security logs SHALL be sent to the agency’s security operations center for monitoring. MS.AAD.5.1: Only administrators SHALL be allowed to register applications. MS.AAD.5.2: Only administrators SHALL be allowed to consent to applications. MS.AAD.5.3: An admin consent workflow SHALL be configured for applications. MS.AAD.5.4: Group owners SHALL NOT be allowed to consent to applications. MS.AAD.6.1: User passwords SHALL NOT expire. MS.AAD.7.1: A minimum of two users and a maximum of eight users SHALL be provisioned with the Global Administrator role. MS.AAD.7.2: Privileged users SHALL be provisioned with finer-grained roles instead of Global Administrator. MS.AAD.7.3: Privileged users SHALL be provisioned cloud-only accounts separate from an on-premises directory or other federated identity providers. MS.AAD.7.4: Permanent active role assignments SHALL NOT be allowed for highly privileged roles. MS.AAD.7.5: Provisioning users to highly privileged roles SHALL NOT occur outside of a PAM system. MS.AAD.7.6: Activation of the Global Administrator role SHALL require approval. MS.AAD.7.7: Eligible and Active highly privileged role assignments SHALL trigger an alert. MS.AAD.7.8: User activation of the Global Administrator role SHALL trigger an alert. MS.AAD.7.9: User activation of other highly privileged roles SHOULD trigger an alert. MS.AAD.8.1: Guest users SHOULD have limited or restricted access to Azure AD directory objects. MS.AAD.8.2: Only users with the Guest Inviter role SHOULD be able to invite guest users. MS.AAD.8.3: Guest invites SHOULD only be allowed to specific external domains that have been authorized by the agency for legitimate business purposes. MS.EXO.01.1: Automatic forwarding to external domains SHALL be disabled. MS.EXO.02.1: A list of approved IP addresses for sending mail SHALL be maintained. MS.EXO.02.2: An SPF policy SHALL be published for each domain, designating only these addresses as approved senders. MS.EXO.03.1: DKIM SHOULD be enabled for all domains. MS.EXO.04.1: A DMARC policy SHALL be published for every second-level domain. MS.EXO.04.2: The DMARC message rejection option SHALL be p=reject. MS.EXO.05.1: SMTP AUTH SHALL be disabled. MS.EXO.06.1: Contact folders SHALL NOT be shared with all domains. MS.EXO.06.2: Calendar details SHALL NOT be shared with all domains. MS.EXO.07.1: External sender warnings SHALL be implemented. MS.EXO.08.1: A DLP solution SHALL be used. MS.EXO.08.2: The DLP solution SHALL protect personally identifiable information (PII) and sensitive information, as defined by the agency. MS.EXO.08.4: At a minimum, the DLP solution SHALL restrict sharing credit card numbers, U.S. Individual Taxpayer Identification Numbers (ITIN), and U.S. Social Security numbers (SSN) via email. MS.EXO.09.1: Emails SHALL be filtered by attachment file types. MS.EXO.09.2: The attachment filter SHOULD attempt to determine the true file type and assess the file extension. MS.EXO.09.3: Disallowed file types SHALL be determined and enforced. MS.EXO.09.5: At a minimum, click-to-run files SHOULD be blocked (e.g., .exe, .cmd, and .vbe). MS.EXO.10.1: Emails SHALL be scanned for malware. MS.EXO.10.2: Emails identified as containing malware SHALL be quarantined or dropped. MS.EXO.10.3: Email scanning SHALL be capable of reviewing emails after delivery. MS.EXO.11.1: Impersonation protection checks SHOULD be used. MS.EXO.11.2: User warnings, comparable to the user safety tips included with EOP, SHOULD be displayed. MS.EXO.11.3: The phishing protection solution SHOULD include an AI-based phishing detection tool comparable to EOP Mailbox Intelligence. MS.EXO.12.1: IP allow lists SHOULD NOT be created. MS.EXO.12.2: Safe lists SHOULD NOT be enabled. MS.EXO.13.1: Mailbox auditing SHALL be enabled. MS.EXO.14.1: A spam filter SHALL be enabled. MS.EXO.14.2: Spam and high confidence spam SHALL be moved to either the junk email folder or the quarantine folder. MS.EXO.14.3: Allowed domains SHALL NOT be added to inbound anti-spam protection policies. MS.EXO.15.1: URL comparison with a block-list SHOULD be enabled. MS.EXO.15.2: Direct download links SHOULD be scanned for malware. MS.EXO.15.3: User click tracking SHOULD be enabled. MS.EXO.16.1: Alerts SHALL be enabled. MS.EXO.17.1: Microsoft Purview Audit (Standard) logging SHALL be enabled. MS.EXO.17.2: Microsoft Purview Audit (Premium) logging SHALL be enabled. MS.EXO.17.3: Audit logs SHALL be maintained for at least the minimum duration dictated by OMB M-21-31 (Appendix C). MS.SHAREPOINT.1.1: External sharing for SharePoint SHALL be limited to Existing guests or Only People in your organization. MS.SHAREPOINT.1.3: External sharing SHALL be restricted to approved external domains and/or users in approved security groups per interagency collaboration needs. MT.1001: At least one Conditional Access policy is configured with device compliance. MT.1003: At least one Conditional Access policy is configured with All Apps. MT.1004: At least one Conditional Access policy is configured with All Apps and All Users. MT.1005: All Conditional Access policies are configured to exclude at least one emergency/break glass account or group. MT.1006: At least one Conditional Access policy is configured to require MFA for admins. MT.1007: At least one Conditional Access policy is configured to require MFA for all users. MT.1008: At least one Conditional Access policy is configured to require MFA for Azure management. MT.1009: At least one Conditional Access policy is configured to block other legacy authentication. MT.1010: At least one Conditional Access policy is configured to block legacy authentication for Exchange ActiveSync. MT.1011: At least one Conditional Access policy is configured to secure security info registration only from a trusted location. MT.1012: At least one Conditional Access policy is configured to require MFA for risky sign-ins. MT.1013: At least one Conditional Access policy is configured to require new password when user risk is high. MT.1014: At least one Conditional Access policy is configured to require compliant or Entra hybrid joined devices for admins. MT.1015: At least one Conditional Access policy is configured to block access for unknown or unsupported device platforms. MT.1016: At least one Conditional Access policy is configured to require MFA for guest access. MT.1017: At least one Conditional Access policy is configured to enforce non persistent browser session for non-corporate devices. MT.1018: At least one Conditional Access policy is configured to enforce sign-in frequency for non-corporate devices. MT.1019: At least one Conditional Access policy is configured to enable application enforced restrictions. MT.1020: All Conditional Access policies are configured to exclude directory synchronization accounts or do not scope them. MT.1022: All users utilizing a P1 license should be licensed. MT.1023: All users utilizing a P2 license should be licensed. MT.1024: Entra Recommendation - Remove unused applications. MT.1024: Entra Recommendation - Remove unused credentials from applications. MT.1024: Entra Recommendation - Renew expiring application credentials. MT.1024: Entra Recommendation - Renew expiring service principal credentials. MT.1024: Entra Recommendation - Do not allow users to grant consent to unreliable applications. MT.1024: Entra Recommendation - Do not expire passwords. MT.1024: Entra Recommendation - Enable password hash sync if hybrid. MT.1024: Entra Recommendation - Migrate Service Principals from the retiring Azure AD Graph APIs to Microsoft Graph. MT.1024: Entra Recommendation - Use least privileged administrative roles . MT.1024: Entra Recommendation - Enable self-service password reset. MT.1024: Entra Recommendation - Protect your tenant with Insider Risk condition in Conditional Access policy. MT.1024: Entra Recommendation - Designate more than one global admin. MT.1025: No external user with permanent role assignment on Control Plane. MT.1026: No hybrid user with permanent role assignment on Control Plane. MT.1027: No Service Principal with Client Secret and permanent role assignment on Control Plane. MT.1028: No user with mailbox and permanent role assignment on Control Plane. MT.1029: Stale accounts are not assigned to privileged roles. MT.1030: Eligible role assignments on Control Plane are in use by administrators. MT.1031: Privileged role on Control Plane are managed by PIM only. MT.1032: Limited number of Global Admins are assigned. MT.1035: All security groups assigned to Conditional Access Policies should be protected by RMAU. MT.1036: All excluded objects should have a fallback include in another policy. MT.1038: Conditional Access policies should not include or exclude deleted groups. CIS 1.3.1 (L1) Ensure the ‘Password expiration policy’ is set to ‘Set passwords to never expire (recommended)’ EIDSCA.AF02: Authentication Method - FIDO2 security key - Allow self-service set up. EIDSCA.AF03: Authentication Method - FIDO2 security key - Enforce attestation. EIDSCA.AF04: Authentication Method - FIDO2 security key - Enforce key restrictions. EIDSCA.AF05: Authentication Method - FIDO2 security key - Restricted. EIDSCA.AF06: Authentication Method - FIDO2 security key - Restrict specific keys. EIDSCA.AM02: Authentication Method - Microsoft Authenticator - Allow use of Microsoft Authenticator OTP. EIDSCA.AM03: Authentication Method - Microsoft Authenticator - Require number matching for push notifications. EIDSCA.AM04: Authentication Method - Microsoft Authenticator - Included users/groups of number matching for push notifications. EIDSCA.AM06: Authentication Method - Microsoft Authenticator - Show application name in push and passwordless notifications. EIDSCA.AM07: Authentication Method - Microsoft Authenticator - Included users/groups to show application name in push and passwordless notifications. EIDSCA.AM09: Authentication Method - Microsoft Authenticator - Show geographic location in push and passwordless notifications. EIDSCA.AM10: Authentication Method - Microsoft Authenticator - Included users/groups to show geographic location in push and passwordless notifications. EIDSCA.AS04: Authentication Method - SMS - Use for sign-in. EIDSCA.AT02: Authentication Method - Temporary Access Pass - One-time. EIDSCA.CP01: Default Settings - Consent Policy Settings - Group owner consent for apps accessing data. EIDSCA.CP03: Default Settings - Consent Policy Settings - Block user consent for risky apps. EIDSCA.CP04: Default Settings - Consent Policy Settings - Users can request admin consent to apps they are unable to consent to. EIDSCA.CR02: Consent Framework - Admin Consent Request - Reviewers will receive email notifications for requests. EIDSCA.CR03: Consent Framework - Admin Consent Request - Reviewers will receive email notifications when admin consent requests are about to expire. EIDSCA.CR04: Consent Framework - Admin Consent Request - Consent request duration (days). EIDSCA.PR01: Default Settings - Password Rule Settings - Password Protection - Mode. EIDSCA.PR03: Default Settings - Password Rule Settings - Enforce custom list. MS.EXO.04.3: The DMARC point of contact for aggregate reports SHALL include reports@dmarc.cyber.dhs.gov. MS.EXO.08.3: The selected DLP solution SHOULD offer services comparable to the native DLP solution offered by Microsoft. MS.EXO.09.4: Alternatively chosen filtering solutions SHOULD offer services comparable to Microsoft Defender’s Common Attachment Filter. MS.EXO.14.4: If a third-party party filtering solution is used, the solution SHOULD offer services comparable to the native spam filtering offered by Microsoft. MS.EXO.16.2: Alerts SHOULD be sent to a monitored address or incorporated into a security information and event management (SIEM) system. MT.1002: App management restrictions on applications and service principals is configured and enabled. MT.1021: Security Defaults are enabled. MT.1033: User should be blocked from using legacy authentication () MT.1033: User should be blocked from using legacy authentication () MT.1033: User should be blocked from using legacy authentication () MT.1033: User should be blocked from using legacy authentication () MT.1033: User should be blocked from using legacy authentication () MT.1037 Only users with Presenter role are allowed to present in Teams meetings MT.1038 Only invited users should be automatically admitted to Teams meetings MT.1039 Restrict anonymous users from joining meetings MT.1040 Restrict anonymous users from starting Teams meetings MT.1041 Limit external participants from having control in a Teams meeting MT.1042 Restrict dial-in users from bypassing a meeting lobby Test details CIS 1.1.1 (L1) Ensure Administrative accounts are separate and cloud-only Overview 1.1.1 (L1) Ensure Administrative accounts are separate and cloud-only\nAdministrative accounts are special privileged accounts that could have varying levels of access to data, users, and settings. Regular user accounts should never be utilized for administrative tasks and care should be taken, in the case of a hybrid environment, to keep Administrative accounts separated from on-prem accounts. Administrative accounts should not have applications assigned so that they have no access to potentially vulnerable services (EX. email, Teams, SharePoint, etc.) and only access to perform tasks as needed for administrative purposes.\nRemediation action: To created licensed, separate Administrative accounts for Administrative users:\nNavigate to Microsoft 365 admin center https://admin.microsoft.com. Click to expand Users select Active users Click Add a user. Fill out the appropriate fields for Name, user, etc. When prompted to assign licenses select as needed Microsoft Entra ID P1 or Microsoft Entra ID P2, then click Next. Under the Option settings screen you may choose from several types of Administrative access roles. Choose Admin center access followed by the appropriate role then click Next. Select Finish adding. Related links Microsoft 365 Admin Center CIS Microsoft 365 Foundations Benchmark v3.1.0 - Page 16 Test Results Well done. Your tenant has no hybrid Global Administrators:\nDisplay Name Cloud Only Joi Jons ✅ Pass Tag: CIS 1.1.1 L1 CIS E3 Level 1 CIS E3 CIS Security All CIS M365 v3.1.0\nCategory: CIS\nSource: C:\\maester-tests\\cis\\Test-MtCisCloudAdmin.Tests.ps1\nCIS 1.1.3 (L1) Ensure that between two and four global admins are designated Overview 1.1.3 (L1) Ensure that between two and four global admins are designated\nMore than one global administrator should be designated so a single admin can be monitored and to provide redundancy should a single admin leave an organization. Additionally, there should be no more than four global admins set for any tenant. Ideally global administrators will have no licenses assigned to them.\nRemediation action: To correct the number of global tenant administrators:\nNavigate to Microsoft 365 admin center https://admin.microsoft.com. Select Users \u003e Active Users. In the Search field enter the name of the user to be made a Global Administrator. To create a new Global Admin: Select the user’s name. A window will appear to the right. Select Manage roles. Select Admin center access. Check Global Administrator. Click Save changes. To remove Global Admins:\nSelect User. Under Roles select Manage roles. De-Select the appropriate role. Click Save changes. Related links Microsoft 365 Admin Center CIS Microsoft 365 Foundations Benchmark v3.1.0 - Page 25 Test Results Well done. Your tenant has two or more and four or fewer Global Administrators:\nJoi Jons Tag: CIS 1.1.3 L1 CIS E3 Level 1 CIS E3 CIS Security All CIS M365 v3.1.0\nCategory: CIS\nSource: C:\\maester-tests\\cis\\Test-MtCisGlobalAdminCount.Tests.ps1\nCIS 1.2.1 (L2) Ensure that only organizationally managed/approved public groups exist Overview 1.2.1 (L2) Ensure that only organizationally managed/approved public groups exist\nMicrosoft 365 Groups is the foundational membership service that drives all teamwork across Microsoft 365. With Microsoft 365 Groups, you can give a group of people access to a collection of shared resources. While there are several different group types this recommendation concerns Microsoft 365 Groups.\nEnsure that only organizationally managed and approved public groups exist.\nRemediation action: To enable only organizationally managed/approved public groups exist:\nNavigate to Microsoft 365 admin center https://admin.microsoft.com. Click to expand Teams \u0026 groups select Active teams \u0026 groups. On the Active teams and groups page, select the group’s name that is public. On the popup groups name page, Select Settings. Under Privacy, select Private. Related links Microsoft 365 Admin Center CIS Microsoft 365 Foundations Benchmark v3.1.0 - Page 30 Test Results Your tenant has 1 or more public 365 groups:\nDisplay Name Group Public All Company ❌ Fail Retail ❌ Fail Digital Initiative Public Relations ❌ Fail Mark 8 Project Team ❌ Fail U.S. Sales ❌ Fail Sample Team Site ❌ Fail Results limited to 6 Tag: CIS 1.2.1 L2 CIS E3 Level 2 CIS E3 CIS Security All CIS M365 v3.1.0\nCategory: CIS\nSource: C:\\maester-tests\\cis\\Test-MtCis365PublicGroup.Tests.ps1\nCIS 1.2.2 (L1) Ensure sign-in to shared mailboxes is blocked Overview 1.2.2 (L1) Ensure sign-in to shared mailboxes is blocked\nThe intent of the shared mailbox is the only allow delegated access from other mailboxes. An admin could reset the password, or an attacker could potentially gain access to the shared mailbox allowing the direct sign-in to the shared mailbox and subsequently the sending of email from a sender that does not have a unique identity. To prevent this, block sign-in for the account that is associated with the shared mailbox.\nRemediation action: Block sign-in to shared mailboxes in the UI:\nNavigate to Microsoft 365 admin center https://admin.microsoft.com. Click to expand Teams \u0026 groups and select Shared mailboxes. Take note of all shared mailboxes. Click to expand Users and select Active users. Select a shared mailbox account to open it’s properties pane and then select Block sign-in. Check the box for Block this user from signing in. Repeat for any additional shared mailboxes. Related links Microsoft 365 Admin Center CIS Microsoft 365 Foundations Benchmark v3.1.0 - Page 33 Test Results Well done. Your tenant has no shared mailboxes with sign-in enabled:\nDisplay Name Shared Mailbox Tag: CIS 1.2.2 L1 CIS E3 Level 1 CIS E3 CIS Security All CIS M365 v3.1.0\nCategory: CIS\nSource: C:\\maester-tests\\cis\\Test-MtCisSharedMailboxSignIn.Tests.ps1\nCIS 1.3.3 (L2) Ensure ‘External sharing’ of calendars is not available Overview 1.3.3 (L2) Ensure ‘External sharing’ of calendars is not available\nAttackers often spend time learning about organizations before launching an attack. Publicly available calendars can help attackers understand organizational relationships and determine when specific users may be more vulnerable to an attack, such as when they are traveling.\nRemediation action: To remediate using the UI:\nNavigate to Microsoft 365 admin center https://admin.microsoft.com. Click to expand Settings select Org settings. In the Services section click Calendar. Uncheck Let your users share their calendars with people outside of your organization who have Office 365 or Exchange. Click Save. Related links Microsoft 365 Admin Center CIS Microsoft 365 Foundations Benchmark v3.1.0 - Page 44 Test Results Your tenant allows uncontrolled calendar sharing.\nPolicy Name Test Result Default Sharing Policy ❌ Fail Tag: CIS 1.3.3 L2 CIS E3 Level 2 CIS E3 CIS Security All CIS M365 v3.1.0\nCategory: CIS\nSource: C:\\maester-tests\\cis\\Test-MtCisCalendarSharing.Tests.ps1\nCIS 1.3.6 (L2) Ensure the customer lockbox feature is enabled Overview 1.3.6 (L2) Ensure the customer lockbox feature is enabled\nCustomer Lockbox is a security feature that provides an additional layer of control and transparency to customer data in Microsoft 365. Enabling this feature protects organizational data against data spillage and exfiltration.\nTest implementation checks Exchange Online service only.\nRemediation action: To enable the Customer Lockbox feature:\nNavigate to Microsoft 365 admin center https://admin.microsoft.com. Click to expand Settings then select Org settings. Select Security \u0026 privacy tab. Click Customer lockbox. Check the box Require approval for all data access requests. Click Save. Related links Microsoft 365 Admin Center CIS Microsoft 365 Foundations Benchmark v3.1.0 - Page 52 Test Results Your tenant does not have the customer lockbox enabled:\nCustomer Lockbox ❌ Fail Tag: CIS 1.3.6 L2 CIS E5 Level 2 CIS E5 CIS Security All CIS M365 v3.1.0\nCategory: CIS\nSource: C:\\maester-tests\\cis\\Test-MtCisCustomerLockBox.Tests.ps1\nCIS 2.1.1 (L2) Ensure Safe Links for Office Applications is Enabled (Only Checks Default Policy) Overview 2.1.1 (L2) Ensure Safe Links for Office Applications is Enabled\nSafe Links for Office applications extends phishing protection to documents and emails that contain hyperlinks, even after they have been delivered to a user.\nRemediation action: To create a Safe Links policy:\nNavigate to Microsoft 365 admin center https://admin.microsoft.com. Under Email \u0026 collaboration select Policies \u0026 rules Select Threat policies then Safe Links Click on +Create Name the policy then click Next In Domains select all valid domains for the organization and Next Ensure the following URL \u0026 click protection settings are defined: Email\nChecked On: Safe Links checks a list of known, malicious links when users click links in email. URLs are rewritten by default Checked Apply Safe Links to email messages sent within the organization Checked Apply real-time URL scanning for suspicious links and links that point to files Checked Wait for URL scanning to complete before delivering the message Unchecked Do not rewrite URLs, do checks via Safe Links API only. Teams\nChecked On: Safe Links checks a list of known, malicious links when users click links in Microsoft Teams. URLs are not rewritten. Office 365 Apps\nChecked On: Safe Links checks a list of known, malicious links when users click links in Microsoft Office apps. URLs are not rewritten Click protection settings\nChecked: Track user clicks Unchecked: Let users click through the original URL There is no recommendation for organization branding Click Next twice and finally Submit. Related links Microsoft 365 Admin Center CIS Microsoft 365 Foundations Benchmark v3.1.0 - Page 61 Test Results Your tenants default safe link policy does not match CIS recommendations (https://security.microsoft.com/presetSecurityPolicies).\nCheck Name Result EnableSafeLinksForEmail ✅ Pass EnableSafeLinksForTeams ✅ Pass EnableSafeLinksForOffice ✅ Pass TrackClicks ✅ Pass AllowClickThrough ❌ Fail ScanUrls ✅ Pass EnableForInternalSenders ❌ Fail DeliverMessageAfterScan ✅ Pass DisableUrlRewrite ✅ Pass Tag: CIS 2.1.1 L2 CIS E5 Level 2 CIS E5 CIS Security All CIS M365 v3.1.0\nCategory: CIS\nSource: C:\\maester-tests\\cis\\Test-MtCisSafeLink.Tests.ps1\nCIS 2.1.2 (L1) Ensure the Common Attachment Types Filter is enabled (Only Checks Default Policy) Overview 2.1.2 (L1) Ensure the Common Attachment Types Filter is enabled\nRationale: Blocking known malicious file types can help prevent malware-infested files from infecting a host.\nRemediation action: To enable the Common Attachment Types Filter:\nNavigate to Microsoft 365 Defender https://security.microsoft.com. Click to expand Email \u0026 collaboration select Policies \u0026 rules. On the Policies \u0026 rules page select Threat policies. Under polices select Anti-malware and click on the Default (Default) policy. On the Policy page that appears on the right hand pane scroll to the bottom and click on Edit protection settings, check the Enable the common attachments filter. Click Save. Related links Microsoft 365 Defender CIS Microsoft 365 Foundations Benchmark v3.1.0 - Page 65 Test Results Well done. Your tenants default malware filter policy has the common attachment file filter enabled (https://security.microsoft.com/presetSecurityPolicies).\nPolicy Result EnableFileFilter ✅ Pass Tag: CIS 2.1.2 L1 CIS E3 Level 1 CIS E3 CIS Security All CIS M365 v3.1.0\nCategory: CIS\nSource: C:\\maester-tests\\cis\\Test-MtCisAttachmentFilter.Tests.ps1\nCIS 2.1.3 (L1) Ensure notifications for internal users sending malware is Enabled (Only Checks Default Policy) Overview 2.1.3 (L1) Ensure notifications for internal users sending malware is Enabled\nRationale: This setting alerts administrators that an internal user sent a message that contained malware. This may indicate an account or machine compromise that would need to be investigated.\nRemediation action: To enable notifications for internal users sending malware:\nNavigate to Microsoft 365 Defender https://security.microsoft.com. Click to expand E-mail \u0026 Collaboration select Policies \u0026 rules. On the Policies \u0026 rules page select Threat policies. Under Policies select Anti-malware. Click on the Default (Default) policy. Click on Edit protection settings and change the settings for Notify an admin about undelivered messages from internal senders to On and enter the email address of the administrator who should be notified under Administrator email address. Click Save. Related links Microsoft 365 Defender CIS Microsoft 365 Foundations Benchmark v3.1.0 - Page 68 Test Results Your tenants default anti malware policy does not have the recommended internal malware notifications configured (https://security.microsoft.com/antimalwarev2).\nPolicy Result EnableInternalSenderAdminNotification ❌ Fail InternalSenderAdminAddress ✅ Pass Tag: CIS 2.1.3 L1 CIS E3 Level 1 CIS E3 CIS Security All CIS M365 v3.1.0\nCategory: CIS\nSource: C:\\maester-tests\\cis\\Test-MtCisInternalMalwareNotification.Tests.ps1\nCIS 2.1.4 (L2) Ensure Safe Attachments policy is enabled (Only Checks Default Policy) Overview 2.1.4 (L2) Ensure Safe Attachments policy is enabled\nRationale: Enabling Safe Attachments policy helps protect against malware threats in email attachments by analyzing suspicious attachments in a secure, cloud-based environment before they are delivered to the user’s inbox. This provides an additional layer of security and can prevent new or unseen types of malware from infiltrating the organization’s network.\nRemediation action: To enable the Safe Attachments policy:\nNavigate to Microsoft 365 Defender https://security.microsoft.com. Click to expand E-mail \u0026 Collaboration select Policies \u0026 rules. On the Policies \u0026 rules page select Threat policies. Under Policies select Safe Attachments. Click + Create. Create a Policy Name and Description, and then click Next. Select all valid domains and click Next. Select Block. Quarantine policy is AdminOnlyAccessPolicy. Leave Enable redirect unchecked. Click Next and finally Submit. Related links Microsoft 365 Defender CIS Microsoft 365 Foundations Benchmark v3.1.0 - Page 71 Test Results Well done. Your tenants default safe attachments policy matches CIS recommendations (https://security.microsoft.com/safeattachmentv2).\nCheck Name Result Enable ✅ Pass Action ✅ Pass QuarantineTag ✅ Pass Tag: CIS 2.1.4 L2 CIS E5 Level 2 CIS E5 CIS Security All CIS M365 v3.1.0\nCategory: CIS\nSource: C:\\maester-tests\\cis\\Test-MtCisSafeAttachment.Tests.ps1\nCIS 2.1.5 (L2) Ensure Safe Attachments for SharePoint, OneDrive, and Microsoft Teams is Enabled Overview 2.1.5 (L2) Ensure Safe Attachments for SharePoint, OneDrive, and Microsoft Teams is Enabled\nDescription: Safe Attachments for SharePoint, OneDrive, and Microsoft Teams scans these services for malicious files.\nRemediation action: To enable Safe Attachments for SharePoint, OneDrive, and Microsoft Teams:\nNavigate to Microsoft 365 Defender https://security.microsoft.com Under Email \u0026 collaboration select Policies \u0026 rules Select Threat policies then Safe Attachments Click on Global settings Click to Enable Turn on Defender for Office 365 for SharePoint, OneDrive, and Microsoft Teams Click to Enable Turn on Safe Documents for Office clients Click to Disable Allow people to click through Protected View even if Safe Documents identified the file as malicious Click Save. Related links Microsoft 365 Defender CIS Microsoft 365 Foundations Benchmark v3.1.0 - Page 73 Test Results Your tenant does not have Safe Attachments for SharePoint, OneDrive, and Microsoft Teams enabled (https://security.microsoft.com/safeattachmentv2).\nCheck Name Result EnableATPForSPOTeamsODB ❌ Fail EnableSafeDocs ❌ Fail AllowSafeDocsOpen ✅ Pass Tag: CIS 2.1.5 L2 CIS E5 Level 2 CIS E5 CIS Security All CIS M365 v3.1.0\nCategory: CIS\nSource: C:\\maester-tests\\cis\\Test-MtCisSafeAttachmentsAtpPolicy.Tests.ps1\nCIS 2.1.6 (L1) Ensure Exchange Online Spam Policies are set to notify administrators (Only Checks Default Policy) Overview 2.1.6 (L1) Ensure Exchange Online Spam Policies are set to notify administrators\nDescription: Configure Exchange Online Spam Policies to copy emails and notify someone when a sender in the organization has been blocked for sending spam emails.\nRemediation action: To set the Exchange Online Spam Policies:\nNavigate to Microsoft 365 Defender https://security.microsoft.com Under Email \u0026 collaboration select Policies \u0026 rules Select Threat policies then Anti-spam Click on the Anti-spam outbound policy (default) Select Edit protection settings then under Notifications Check Send a copy of outbound messages that exceed these limits to these users and groups then enter the desired email addresses Check Notify these users and groups if a sender is blocked due to sending outbound spam then enter the desired email addresses. Click Save. Related links Microsoft 365 Defender CIS Microsoft 365 Foundations Benchmark v3.1.0 - Page 76 Test Results Your tenants default Exchange Online Spam policy is not set to notify administrators (https://security.microsoft.com/antispam).\nCheck Name Result BccSuspiciousOutboundMail ❌ Fail NotifyOutboundSpam ❌ Fail Tag: CIS 2.1.6 L1 CIS E3 Level 1 CIS E3 CIS Security All CIS M365 v3.1.0\nCategory: CIS\nSource: C:\\maester-tests\\cis\\Test-MtCisOutboundSpamFilterPolicy.Tests.ps1\nCIS 2.1.7 (L1) Ensure that an anti-phishing policy has been created (Only Checks Default Policy) Overview 2.1.7 (L1) Ensure that an anti-phishing policy has been created\nDescription: Set up anti-phishing polices to increase this protection, for example by refining settings to better detect and prevent impersonation and spoofing attacks.\nRemediation action: To enable Safe Attachments for SharePoint, OneDrive, and Microsoft Teams:\nNavigate to Microsoft 365 Defender https://security.microsoft.com Under Email \u0026 collaboration select Policies \u0026 rules Select Threat policies then Anti-Phishing Select the Office365 AntiPhish Default (Default) policy and click Edit protection settings Set the Phishing email threshold to at least 2 - Aggressive. Related links Microsoft 365 Defender CIS Microsoft 365 Foundations Benchmark v3.1.0 - Page 80 Test Results Your tenants default anti-phishing policy does not match CIS recommendations (https://security.microsoft.com/antiphishing).\nCheck Name Result Enabled ✅ Pass EnableMailboxIntelligenceProtection ❌ Fail EnableMailboxIntelligence ✅ Pass EnableSpoofIntelligence ✅ Pass PhishThresholdLevel ❌ Fail Tag: CIS 2.1.7 L1 CIS E5 Level 1 CIS E5 CIS Security All CIS M365 v3.1.0\nCategory: CIS\nSource: C:\\maester-tests\\cis\\Test-MtCisSafeAntiPhishingPolicy.Tests.ps1\nEIDSCA.AF01: Authentication Method - FIDO2 security key - State. Overview Whether the FIDO2 security keys is enabled in the tenant.\nenabled\nTest script https://graph.microsoft.com/beta/policies/authenticationMethodsPolicy/authenticationMethodConfigurations('Fido2')\r.state -eq 'enabled' Related links Open in Graph Explorer fido2AuthenticationMethodConfiguration resource type - Microsoft Graph v1.0 | Microsoft Learn Test Results Your tenant is configured as disabled.\nThe recommended value is ’enabled’ for policies/authenticationMethodsPolicy/authenticationMethodConfigurations(‘Fido2’)\nLearn more: https://maester.dev/docs/tests/EIDSCA.AF01\nTag: EIDSCA Security All EIDSCA.AF01\nCategory: Authentication Method - FIDO2 security key\nSource: C:\\maester-tests\\EIDSCA\\Test-EIDSCA.Generated.Tests.ps1\nEIDSCA.AG01: Authentication Method - General Settings - Manage migration. Overview The state of migration of the authentication methods policy from the legacy multifactor authentication and self-service password reset (SSPR) policies. In January 2024, the legacy multifactor authentication and self-service password reset policies will be deprecated and you’ll manage all authentication methods here in the authentication methods policy. Use this control to manage your migration from the legacy policies to the new unified policy.\nOn September 30th, 2025, the legacy multifactor authentication and self-service password reset policies will be deprecated and you’ll manage all authentication methods here in the authentication methods policy. Use this control to manage your migration from the legacy policies to the new unified policy.\nTest script https://graph.microsoft.com/beta/policies/authenticationMethodsPolicy\r.policyMigrationState -eq 'migrationComplete' Related links Open in Graph Explorer Get authenticationMethodsPolicy - Microsoft Graph v1.0 | Microsoft Learn View in Microsoft Entra admin center Test Results Your tenant is configured as migrationInProgress.\nThe recommended value is ‘migrationComplete’ for policies/authenticationMethodsPolicy\nLearn more: https://maester.dev/docs/tests/EIDSCA.AG01\nTag: EIDSCA Security All EIDSCA.AG01\nCategory: Authentication Method - General Settings\nSource: C:\\maester-tests\\EIDSCA\\Test-EIDSCA.Generated.Tests.ps1\nEIDSCA.AG02: Authentication Method - General Settings - Report suspicious activity - State. Overview Allows users to report suspicious activities if they receive an authentication request that they did not initiate. This control is available when using the Microsoft Authenticator app and voice calls. Reporting suspicious activity will set the user’s risk to high. If the user is subject to risk-based Conditional Access policies, they may be blocked.\nAllows to integrate report of fraud attempt by users to identity protection: Users who report an MFA prompt as suspicious are set to High User Risk. Administrators can use risk-based policies to limit access for these users, or enable self-service password reset (SSPR) for users to remediate problems on their own.\nTest script https://graph.microsoft.com/beta/policies/authenticationMethodsPolicy\r.reportSuspiciousActivitySettings.state -eq 'enabled' Related links Open in Graph Explorer Get authenticationMethodsPolicy - Microsoft Graph v1.0 | Microsoft Learn View in Microsoft Entra admin center Test Results Your tenant is configured as default.\nThe recommended value is ’enabled’ for policies/authenticationMethodsPolicy\nLearn more: https://maester.dev/docs/tests/EIDSCA.AG02\nTag: EIDSCA Security All EIDSCA.AG02\nCategory: Authentication Method - General Settings\nSource: C:\\maester-tests\\EIDSCA\\Test-EIDSCA.Generated.Tests.ps1\nEIDSCA.AG03: Authentication Method - General Settings - Report suspicious activity - Included users/groups. Overview Object Id or scope of users which will be included to report suspicious activities if they receive an authentication request that they did not initiate.\nApply this feature to all users.\nTest script https://graph.microsoft.com/beta/policies/authenticationMethodsPolicy\r.reportSuspiciousActivitySettings.includeTarget.id -eq 'all_users' Related links Open in Graph Explorer Get authenticationMethodsPolicy - Microsoft Graph v1.0 | Microsoft Learn View in Microsoft Entra admin center Test Results Well done. The configuration in your tenant and recommended value is ‘all_users’ for policies/authenticationMethodsPolicy\nLearn more: https://maester.dev/docs/tests/EIDSCA.AG03\nTag: EIDSCA Security All EIDSCA.AG03\nCategory: Authentication Method - General Settings\nSource: C:\\maester-tests\\EIDSCA\\Test-EIDSCA.Generated.Tests.ps1\nEIDSCA.AM01: Authentication Method - Microsoft Authenticator - State. Overview Whether the Authenticator App is enabled in the tenant.\nenabled\nTest script https://graph.microsoft.com/beta/policies/authenticationMethodsPolicy/authenticationMethodConfigurations('MicrosoftAuthenticator')\r.state -eq 'enabled' Related links Open in Graph Explorer microsoftAuthenticatorAuthenticationMethodConfiguration resource type - Microsoft Graph v1.0 | Microsoft Learn View in Microsoft Entra admin center Test Results Your tenant is configured as disabled.\nThe recommended value is ’enabled’ for policies/authenticationMethodsPolicy/authenticationMethodConfigurations(‘MicrosoftAuthenticator’)\nLearn more: https://maester.dev/docs/tests/EIDSCA.AM01\nTag: EIDSCA Security All EIDSCA.AM01\nCategory: Authentication Method - Microsoft Authenticator\nSource: C:\\maester-tests\\EIDSCA\\Test-EIDSCA.Generated.Tests.ps1\nEIDSCA.AP01: Default Authorization Settings - Enabled Self service password reset for administrators. Overview Indicates whether administrators of the tenant can use the Self-Service Password Reset (SSPR). The policy applies to some critical critical roles in Microsoft Entra ID.\nAdministrators with sensitive roles should use phishing-resistant authentication methods only and therefore not able to reset their password using SSPR.\nTest script https://graph.microsoft.com/beta/policies/authorizationPolicy\r.allowedToUseSSPR -eq 'false' Related links Open in Graph Explorer authorizationPolicy resource type - Microsoft Graph v1.0 | Microsoft Learn Test Results Your tenant is configured as True.\nThe recommended value is ‘false’ for policies/authorizationPolicy\nLearn more: https://maester.dev/docs/tests/EIDSCA.AP01\nTag: EIDSCA Security All EIDSCA.AP01\nCategory: Default Authorization Settings\nSource: C:\\maester-tests\\EIDSCA\\Test-EIDSCA.Generated.Tests.ps1\nEIDSCA.AP04: Default Authorization Settings - Guest invite restrictions. Overview Manages controls who can invite guests to your directory to collaborate on resources secured by your Azure AD, such as SharePoint sites or Azure resources.\nCISA SCuBA 2.18: Only users with the Guest Inviter role SHOULD be able to invite guest users\nTest script https://graph.microsoft.com/beta/policies/authorizationPolicy\r.allowInvitesFrom -in @('adminsAndGuestInviters','none') Related links Open in Graph Explorer authorizationPolicy resource type - Microsoft Graph v1.0 | Microsoft Learn View in Microsoft Entra admin center Test Results Your tenant is configured as everyone.\nThe recommended value is one of the following values @(‘adminsAndGuestInviters’,’none’) for policies/authorizationPolicy\nLearn more: https://maester.dev/docs/tests/EIDSCA.AP04\nTag: EIDSCA Security All EIDSCA.AP04\nCategory: Default Authorization Settings\nSource: C:\\maester-tests\\EIDSCA\\Test-EIDSCA.Generated.Tests.ps1\nEIDSCA.AP05: Default Authorization Settings - Sign-up for email based subscription. Overview Indicates whether users can sign up for email based subscriptions.\nTest script https://graph.microsoft.com/beta/policies/authorizationPolicy\r.allowedToSignUpEmailBasedSubscriptions -eq 'false' Related links Open in Graph Explorer authorizationPolicy resource type - Microsoft Graph v1.0 | Microsoft Learn Test Results Your tenant is configured as True.\nThe recommended value is ‘false’ for policies/authorizationPolicy\nLearn more: https://maester.dev/docs/tests/EIDSCA.AP05\nTag: EIDSCA Security All EIDSCA.AP05\nCategory: Default Authorization Settings\nSource: C:\\maester-tests\\EIDSCA\\Test-EIDSCA.Generated.Tests.ps1\nEIDSCA.AP06: Default Authorization Settings - User can join the tenant by email validation. Overview Controls whether users can join the tenant by email validation. To join, the user must have an email address in a domain which matches one of the verified domains in the tenant.\nSelf-service sign up for email-verified users - Microsoft Entra ID - Microsoft Learn\nTest script https://graph.microsoft.com/beta/policies/authorizationPolicy\r.allowEmailVerifiedUsersToJoinOrganization -eq 'false' Related links Open in Graph Explorer authorizationPolicy resource type - Microsoft Graph v1.0 | Microsoft Learn Test Results Well done. The configuration in your tenant and recommended value is ‘false’ for policies/authorizationPolicy\nLearn more: https://maester.dev/docs/tests/EIDSCA.AP06\nTag: EIDSCA Security All EIDSCA.AP06\nCategory: Default Authorization Settings\nSource: C:\\maester-tests\\EIDSCA\\Test-EIDSCA.Generated.Tests.ps1\nEIDSCA.AP07: Default Authorization Settings - Guest user access. Overview Represents role templateId for the role that should be granted to guest user.\nCISA SCuBA 2.18: Guest users SHOULD have limited access to Azure AD directory objects.\nTest script https://graph.microsoft.com/beta/policies/authorizationPolicy\r.guestUserRoleId -eq '2af84b1e-32c8-42b7-82bc-daa82404023b' Related links Open in Graph Explorer authorizationPolicy resource type - Microsoft Graph v1.0 | Microsoft Learn View in Microsoft Entra admin center Test Results Your tenant is configured as 10dae51f-b6af-4016-8d66-8c2a99b929b3.\nThe recommended value is ‘2af84b1e-32c8-42b7-82bc-daa82404023b’ for policies/authorizationPolicy\nLearn more: https://maester.dev/docs/tests/EIDSCA.AP07\nTag: EIDSCA Security All EIDSCA.AP07\nCategory: Default Authorization Settings\nSource: C:\\maester-tests\\EIDSCA\\Test-EIDSCA.Generated.Tests.ps1\nEIDSCA.AP08: Default Authorization Settings - User consent policy assigned for applications. Overview Defines if user consent to apps is allowed, and if it is, which app consent policy (permissionGrantPolicy) governs the permissions.\nMicrosoft recommends to allow to user consent for apps from verified publisher for selected permissions. CISA SCuBA 2.7 defines that all Non-Admin Users SHALL Be Prevented From Providing Consent To Third-Party Applications.\nTest script https://graph.microsoft.com/beta/policies/authorizationPolicy\r.permissionGrantPolicyIdsAssignedToDefaultUserRole | Sort-Object -Descending | select-object -first 1 -eq 'ManagePermissionGrantsForSelf.microsoft-user-default-low' Related links Open in Graph Explorer authorizationPolicy resource type - Microsoft Graph v1.0 | Microsoft Learn View in Microsoft Entra admin center Test Results Your tenant is configured as ManagePermissionGrantsForSelf.microsoft-user-default-legacy.\nThe recommended value is ‘ManagePermissionGrantsForSelf.microsoft-user-default-low’ for policies/authorizationPolicy\nLearn more: https://maester.dev/docs/tests/EIDSCA.AP08\nTag: EIDSCA Security All EIDSCA.AP08\nCategory: Default Authorization Settings\nSource: C:\\maester-tests\\EIDSCA\\Test-EIDSCA.Generated.Tests.ps1\nEIDSCA.AP09: Default Authorization Settings - Risk-based step-up consent. Overview Indicates whether user consent for risky apps is allowed. For example, consent requests for newly registered multi-tenant apps that are not publisher verified and require non-basic permissions are considered risky.\nConfigure risk-based step-up consent - Microsoft Entra ID - Microsoft Learn\nTest script https://graph.microsoft.com/beta/policies/authorizationPolicy\r.allowUserConsentForRiskyApps -eq 'false' Related links Open in Graph Explorer authorizationPolicy resource type - Microsoft Graph v1.0 | Microsoft Learn Test Results Your tenant is configured as ****.\nThe recommended value is ‘false’ for policies/authorizationPolicy\nLearn more: https://maester.dev/docs/tests/EIDSCA.AP09\nTag: EIDSCA Security All EIDSCA.AP09\nCategory: Default Authorization Settings\nSource: C:\\maester-tests\\EIDSCA\\Test-EIDSCA.Generated.Tests.ps1\nEIDSCA.AP10: Default Authorization Settings - Default User Role Permissions - Allowed to create Apps. Overview Controls if non-admin users may register custom-developed applications for use within this directory.\nCISA SCuBA 2.6: Only Administrators SHALL Be Allowed To Register Third-Party Applications\nTest script https://graph.microsoft.com/beta/policies/authorizationPolicy\r.defaultUserRolePermissions.allowedToCreateApps -eq 'false' Related links Open in Graph Explorer authorizationPolicy resource type - Microsoft Graph v1.0 | Microsoft Learn View in Microsoft Entra admin center Test Results Your tenant is configured as True.\nThe recommended value is ‘false’ for policies/authorizationPolicy\nLearn more: https://maester.dev/docs/tests/EIDSCA.AP10\nTag: EIDSCA Security All EIDSCA.AP10\nCategory: Default Authorization Settings\nSource: C:\\maester-tests\\EIDSCA\\Test-EIDSCA.Generated.Tests.ps1\nEIDSCA.AP14: Default Authorization Settings - Default User Role Permissions - Allowed to read other users. Overview Prevents all non-admins from reading user information from the directory. This flag doesn’t prevent reading user information in other Microsoft services like Exchange Online.\nRestrict this default permissions for members have huge impact on collaboration features and user lookup.\nTest script https://graph.microsoft.com/beta/policies/authorizationPolicy\r.defaultUserRolePermissions.allowedToReadOtherUsers -eq 'true' Related links Open in Graph Explorer authorizationPolicy resource type - Microsoft Graph v1.0 | Microsoft Learn Test Results Well done. The configuration in your tenant and recommended value is ’true’ for policies/authorizationPolicy\nLearn more: https://maester.dev/docs/tests/EIDSCA.AP14\nTag: EIDSCA Security All EIDSCA.AP14\nCategory: Default Authorization Settings\nSource: C:\\maester-tests\\EIDSCA\\Test-EIDSCA.Generated.Tests.ps1\nEIDSCA.AT01: Authentication Method - Temporary Access Pass - State. Overview Whether the Temporary Access Pass is enabled in the tenant.\nUse Temporary Access Pass for secure onboarding users (initial password replacement) and enforce MFA for registering security information in Conditional Access Policy.\nTest script https://graph.microsoft.com/beta/policies/authenticationMethodsPolicy/authenticationMethodConfigurations('TemporaryAccessPass')\r.state -eq 'enabled' Related links Open in Graph Explorer temporaryAccessPassAuthenticationMethodConfiguration resource type - Microsoft Graph v1.0 | Microsoft Learn Test Results Your tenant is configured as disabled.\nThe recommended value is ’enabled’ for policies/authenticationMethodsPolicy/authenticationMethodConfigurations(‘TemporaryAccessPass’)\nLearn more: https://maester.dev/docs/tests/EIDSCA.AT01\nTag: EIDSCA Security All EIDSCA.AT01\nCategory: Authentication Method - Temporary Access Pass\nSource: C:\\maester-tests\\EIDSCA\\Test-EIDSCA.Generated.Tests.ps1\nEIDSCA.AV01: Authentication Method - Voice call - State. Overview Whether the Voice call is enabled in the tenant.\nChoose authentication methods with number matching (Authenticator)\nTest script https://graph.microsoft.com/beta/policies/authenticationMethodsPolicy/authenticationMethodConfigurations('Voice')\r.state -eq 'disabled' Related links Open in Graph Explorer Test Results Well done. The configuration in your tenant and recommended value is ‘disabled’ for policies/authenticationMethodsPolicy/authenticationMethodConfigurations(‘Voice’)\nLearn more: https://maester.dev/docs/tests/EIDSCA.AV01\nTag: EIDSCA Security All EIDSCA.AV01\nCategory: Authentication Method - Voice call\nSource: C:\\maester-tests\\EIDSCA\\Test-EIDSCA.Generated.Tests.ps1\nEIDSCA.CR01: Consent Framework - Admin Consent Request - Policy to enable or disable admin consent request feature. Overview Defines if admin consent request feature is enabled or disabled\nTest script https://graph.microsoft.com/beta/policies/adminConsentRequestPolicy\r.isEnabled -eq 'true' Related links Open in Graph Explorer adminConsentRequestPolicy resource type - Microsoft Graph v1.0 | Microsoft Learn View in Microsoft Entra admin center Test Results Your tenant is configured as False.\nThe recommended value is ’true’ for policies/adminConsentRequestPolicy\nLearn more: https://maester.dev/docs/tests/EIDSCA.CR01\nTag: EIDSCA Security All EIDSCA.CR01\nCategory: Consent Framework - Admin Consent Request\nSource: C:\\maester-tests\\EIDSCA\\Test-EIDSCA.Generated.Tests.ps1\nEIDSCA.PR02: Default Settings - Password Rule Settings - Password Protection - Enable password protection on Windows Server Active Directory. Overview If set to Yes, password protection is turned on for Active Directory domain controllers when the appropriate agent is installed.\nAzure identity \u0026 access security best practices - Microsoft Learn\nTest script https://graph.microsoft.com/beta/settings\r.values | where-object name -eq 'EnableBannedPasswordCheckOnPremises' | select-object -expand value -eq 'True' Related links Open in Graph Explorer directorySetting resource type - Microsoft Graph beta | Microsoft Learn View in Microsoft Entra admin center Test Results Your tenant is not configured explicitly.\nThe recommended value is ‘True’ for settings. It seems that you are using a default value by Microsoft. We recommend to set the setting value explicitly since non set values could change depending on what Microsoft decides the current default should be.\nLearn more: https://maester.dev/docs/tests/EIDSCA.PR02\nTag: EIDSCA Security All EIDSCA.PR02\nCategory: Default Settings - Password Rule Settings\nSource: C:\\maester-tests\\EIDSCA\\Test-EIDSCA.Generated.Tests.ps1\nEIDSCA.PR05: Default Settings - Password Rule Settings - Smart Lockout - Lockout duration in seconds. Overview The minimum length in seconds of each lockout. If an account locks repeatedly, this duration increases.\nPrevent attacks using smart lockout - Microsoft Entra ID - Microsoft Learn\nTest script https://graph.microsoft.com/beta/settings\r.values | where-object name -eq 'LockoutDurationInSeconds' | select-object -expand value -ge '60' Related links Open in Graph Explorer directorySetting resource type - Microsoft Graph beta | Microsoft Learn View in Microsoft Entra admin center Test Results Your tenant is configured as 0.\nThe recommended value is greater than or equal to ‘60’ for settings\nLearn more: https://maester.dev/docs/tests/EIDSCA.PR05\nTag: EIDSCA Security All EIDSCA.PR05\nCategory: Default Settings - Password Rule Settings\nSource: C:\\maester-tests\\EIDSCA\\Test-EIDSCA.Generated.Tests.ps1\nEIDSCA.PR06: Default Settings - Password Rule Settings - Smart Lockout - Lockout threshold. Overview How many failed sign-ins are allowed on an account before its first lockout. If the first sign-in after a lockout also fails, the account locks out again.\nPrevent attacks using smart lockout - Microsoft Entra ID - Microsoft Learn\nTest script https://graph.microsoft.com/beta/settings\r.values | where-object name -eq 'LockoutThreshold' | select-object -expand value -eq '10' Related links Open in Graph Explorer directorySetting resource type - Microsoft Graph beta | Microsoft Learn View in Microsoft Entra admin center Test Results Your tenant is configured as 0.\nThe recommended value is ‘10’ for settings\nLearn more: https://maester.dev/docs/tests/EIDSCA.PR06\nTag: EIDSCA Security All EIDSCA.PR06\nCategory: Default Settings - Password Rule Settings\nSource: C:\\maester-tests\\EIDSCA\\Test-EIDSCA.Generated.Tests.ps1\nEIDSCA.ST08: Default Settings - Classification and M365 Groups - M365 groups - Allow Guests to become Group Owner. Overview Indicating whether or not a guest user can be an owner of groups, manage\nCISA SCuBA 2.18: Guest users SHOULD have limited access to Azure AD directory objects\nTest script https://graph.microsoft.com/beta/settings\r.values | where-object name -eq 'AllowGuestsToBeGroupOwner' | select-object -expand value -eq 'false' Related links Open in Graph Explorer directorySetting resource type - Microsoft Graph beta | Microsoft Learn Test Results Your tenant is not configured explicitly.\nThe recommended value is ‘false’ for settings. It seems that you are using a default value by Microsoft. We recommend to set the setting value explicitly since non set values could change depending on what Microsoft decides the current default should be.\nLearn more: https://maester.dev/docs/tests/EIDSCA.ST08\nTag: EIDSCA Security All EIDSCA.ST08\nCategory: Default Settings - Classification and M365 Groups\nSource: C:\\maester-tests\\EIDSCA\\Test-EIDSCA.Generated.Tests.ps1\nEIDSCA.ST09: Default Settings - Classification and M365 Groups - M365 groups - Allow Guests to have access to groups content. Overview Indicating whether or not a guest user can have access to Microsoft 365 groups content. This setting does not require an Azure Active Directory Premium P1 license.\nManages if guest accounts can access resources through Microsoft 365 Group membership and could break collaboration if you disable it.\nTest script https://graph.microsoft.com/beta/settings\r.values | where-object name -eq 'AllowGuestsToAccessGroups' | select-object -expand value -eq 'True' Related links Open in Graph Explorer directorySetting resource type - Microsoft Graph beta | Microsoft Learn Test Results Your tenant is not configured explicitly.\nThe recommended value is ‘True’ for settings. It seems that you are using a default value by Microsoft. We recommend to set the setting value explicitly since non set values could change depending on what Microsoft decides the current default should be.\nLearn more: https://maester.dev/docs/tests/EIDSCA.ST09\nTag: EIDSCA Security All EIDSCA.ST09\nCategory: Default Settings - Classification and M365 Groups\nSource: C:\\maester-tests\\EIDSCA\\Test-EIDSCA.Generated.Tests.ps1\nMS.AAD.1.1: Legacy authentication SHALL be blocked. Overview Legacy authentication SHALL be blocked.\nRationale: The security risk of allowing legacy authentication protocols is they do not support MFA. Blocking legacy protocols reduces the impact of user credential theft.\nRemediation action: Follow the guide below to create a conditional access policy that blocks legacy authentication.\nBlock legacy authentication - Microsoft Learn Related links CISA Legacy Authentication - MS.AAD.1.1v1 CISA ScubaGear Rego Reference Test Results Your tenant does not have any conditional access policies that block legacy authentication.\nTag: MS.AAD MS.AAD.1.1 CISA Security All Entra ID P1\nCategory: CISA SCuBA\nSource: C:\\maester-tests\\cisa\\entra\\Test-MtCisaBlockLegacyAuth.Tests.ps1\nMS.AAD.2.1: Users detected as high risk SHALL be blocked. Overview Users detected as high risk SHALL be blocked.\nRationale: Blocking high-risk users may prevent compromised accounts from accessing the tenant. This prevents compromised accounts from accessing the tenant.\nRemediation action: Create a conditional access policy blocking users categorized as high risk by the Identity Protection service. Configure the following policy settings in the new conditional access policy as per the values below:\nUsers \u003e Include \u003e All users Target resources \u003e Cloud apps \u003e All cloud apps Conditions \u003e User risk \u003e High Access controls \u003e Grant \u003e Block Access Note: While CISA recommends blocking, the Microsoft recommendation is to require multi-factor authentication for high-risk users.\nRelated links CISA Risk Based Policies - MS.AAD.2.1 CISA ScubaGear Rego Reference Test Results Your tenant does not have any conditional access policies that block high risk users.\nTag: MS.AAD MS.AAD.2.1 CISA Security All Entra ID P2\nCategory: CISA SCuBA\nSource: C:\\maester-tests\\cisa\\entra\\Test-MtCisaBlockHighRiskUsers.Tests.ps1\nMS.AAD.2.2: A notification SHOULD be sent to the administrator when high-risk users are detected. Overview A notification SHOULD be sent to the administrator when high-risk users are detected.\nRationale: Notification enables the admin to monitor the event and remediate the risk. This helps the organization proactively respond to cyber intrusions as they occur.\nRemediation action: Follow the guide below to configure Entra ID Protection to send a regularly monitored security mailbox email notification when user accounts are determined to be high risk.\nConfigure Entra Identity Protection Notifications - Microsoft Learn Related links CISA Risk Based Policies - MS.AAD.2.2v1 CISA ScubaGear Rego Reference Test Results Well done. Your tenant has one or more recipients for notifications of risky user logins:\nJoi Jons Tag: MS.AAD MS.AAD.2.2 CISA Security All Entra ID P2\nCategory: CISA SCuBA\nSource: C:\\maester-tests\\cisa\\entra\\Test-MtCisaNotifyHighRiskUsers.Tests.ps1\nMS.AAD.2.3: Sign-ins detected as high risk SHALL be blocked. Overview Sign-ins detected as high risk SHALL be blocked.\nRationale: Blocking high-risk sign ins may prevent compromised sign-ins from accessing the tenant. This prevents compromised sign-ins from accessing the tenant.\nRemediation action: Create a Conditional Access policy blocking sign-ins determined high risk by the Identity Protection service. Configure the following policy settings in the new Conditional Access policy as per the values below:\nUsers \u003e Include \u003e All users Target resources \u003e Cloud apps \u003e All cloud apps Conditions \u003e Sign-in risk \u003e High Access controls \u003e Grant \u003e Block Access Note: While CISA recommends blocking, the Microsoft recommendation is to require multi-factor authentication for high-risk sign-ins.\nRelated links CISA Risk Based Policies - MS.AAD.2.3 CISA ScubaGear Rego Reference Test Results Your tenant does not have any conditional access policies that block high risk sign-ins.\nTag: MS.AAD MS.AAD.2.3 CISA Security All Entra ID P2\nCategory: CISA SCuBA\nSource: C:\\maester-tests\\cisa\\entra\\Test-MtCisaBlockHighRiskSignIns.Tests.ps1\nMS.AAD.3.1: Phishing-resistant MFA SHALL be enforced for all users. Overview Phishing-resistant MFA SHALL be enforced for all users.\nRationale: Weaker forms of MFA do not protect against sophisticated phishing attacks. By enforcing methods resistant to phishing, those risks are minimized.\nRemediation action: Create a conditional access policy enforcing phishing-resistant MFA for all users. Configure the following policy settings in the new conditional access policy, per the values below:\nUsers \u003e Include \u003e All users Target resources \u003e Cloud apps \u003e All cloud apps Access controls \u003e Grant \u003e Grant Access \u003e Require authentication strength \u003e Phishing-resistant MFA Related links CISA Strong Authentication \u0026 Secure Registration - MS.AAD.3.1v1 CISA ScubaGear Rego Reference Test Results Your tenant does not have any conditional access policies that require Phishing Resistant Authentication Strengths.\nTag: MS.AAD MS.AAD.3.1 CISA Security All Entra ID P1\nCategory: CISA SCuBA\nSource: C:\\maester-tests\\cisa\\entra\\Test-MtCisaPhishResistant.Tests.ps1\nMS.AAD.3.2: If phishing-resistant MFA has not been enforced, an alternative MFA method SHALL be enforced for all users. Overview If phishing-resistant MFA has not been enforced, an alternative MFA method SHALL be enforced for all users.\nRationale: This is a stopgap security policy to help protect the tenant if phishing-resistant MFA has not been enforced. This policy requires MFA enforcement, thus reducing single-form authentication risk.\nRemediation action: If phishing-resistant MFA has not been enforced for all users yet, create a conditional access policy that enforces MFA but does not dictate MFA method. Configure the following policy settings in the new conditional access policy, per the values below:\nUsers \u003e Include \u003e All users Target resources \u003e Cloud apps \u003e All cloud apps Access controls \u003e Grant \u003e Grant Access \u003e Require multifactor authentication Related links CISA Strong Authentication \u0026 Secure Registration - MS.AAD.3.2v1 CISA ScubaGear Rego Reference Test Results Your tenant does not have any conditional access policies that require MFA.\nTag: MS.AAD MS.AAD.3.2 CISA Security All Entra ID P1\nCategory: CISA SCuBA\nSource: C:\\maester-tests\\cisa\\entra\\Test-MtCisaMfa.Tests.ps1\nMS.AAD.3.3: If phishing-resistant MFA has not been enforced and Microsoft Authenticator is enabled, it SHALL be configured to show login context information. Overview If phishing-resistant MFA has not been enforced and Microsoft Authenticator is enabled, it SHALL be configured to show login context information.\nRationale: This stopgap security policy helps protect the tenant when phishing-resistant MFA has not been enforced and Microsoft Authenticator is used. This policy helps improve the security of Microsoft Authenticator by showing user context information, which helps reduce MFA phishing compromises.\nRemediation action: If phishing-resistant MFA has not been deployed yet and Microsoft Authenticator is in use, configure Authenticator to display context information to users when they log in.\nIn Azure Active Directory, click Security \u003e Authentication methods \u003e Microsoft Authenticator. Click the Configure tab. For Allow use of Microsoft Authenticator OTP select No. Under Show application name in push and passwordless notifications select Status \u003e Enabled and Target \u003e Include \u003e All users. Under Show geographic location in push and passwordless notifications select Status \u003e Enabled and Target \u003e Include \u003e All users. Select Save. Related links CISA Strong Authentication \u0026 Secure Registration - MS.AAD.3.3v1 CISA ScubaGear Rego Reference Test Results Your tenant does not have the Authentication Methods policy for Microsoft Authenticator set appropriately or migration to Authentication Methods is not complete.\nAuthentication Methods Migration Complete: ❌ Fail\nTag: MS.AAD MS.AAD.3.3 CISA Security All Entra ID P1\nCategory: CISA SCuBA\nSource: C:\\maester-tests\\cisa\\entra\\Test-MtCisaAuthenticatorContext.Tests.ps1\nMS.AAD.3.4: The Authentication Methods Manage Migration feature SHALL be set to Migration Complete. Overview The Authentication Methods Manage Migration feature SHALL be set to Migration Complete.\nRationale: To disable the legacy authentication methods screen for the tenant, configure the Manage Migration feature to Migration Complete. The MFA and Self-Service Password Reset (SSPR) authentication methods are both managed from a central admin page, thereby reducing administrative complexity and potential security misconfigurations.\nRemediation action: If phishing-resistant MFA has not been enforced for all users yet, create a conditional access policy that enforces MFA but does not dictate MFA method. Configure the following policy settings in the new conditional access policy, per the values below:\nGo through the process of migrating from the legacy Azure AD MFA and Self-Service Password Reset (SSPR) administration pages to the new unified Authentication Methods policy page. Once ready to finish the migration, set the Manage Migration option to Migration Complete. Related links CISA Strong Authentication \u0026 Secure Registration - MS.AAD.3.4v1 CISA ScubaGear Rego Reference Test Results Your tenant has not completed the migration to Authentication Methods.\nTag: MS.AAD MS.AAD.3.4 CISA Security All Entra ID P1\nCategory: CISA SCuBA\nSource: C:\\maester-tests\\cisa\\entra\\Test-MtCisaMethodsMigration.Tests.ps1\nMS.AAD.3.5: The authentication methods SMS, Voice Call, and Email One-Time Passcode (OTP) SHALL be disabled. Overview The authentication methods SMS, Voice Call, and Email One-Time Passcode (OTP) SHALL be disabled.\nRationale: SMS, voice call, and email OTP are the weakest authenticators. This policy forces users to use stronger MFA methods.\nRemediation action: If phishing-resistant MFA has not been deployed yet and Microsoft Authenticator is in use, configure Authenticator to display context information to users when they log in.\nIn Azure Active Directory, click Security \u003e Authentication methods Click on the SMS, Voice Call, and Email OTP authentication methods and disable each of them. Their statuses should be Enabled \u003e No on the Authentication methods \u003e Policies page. Related links Entra admin portal - Authentication methods CISA Strong Authentication \u0026 Secure Registration - MS.AAD.3.5v1 CISA ScubaGear Rego Reference Test Results One or more weak methods are enabled in your tenant, or migration to Authentication Methods is incomplete.\nAuthentication Methods Migration Complete: ❌ Fail\nAuthentication Method State Test Result Sms disabled ✅ Pass Voice disabled ✅ Pass Email enabled ❌ Fail Tag: MS.AAD MS.AAD.3.5 CISA Security All Entra ID P1\nCategory: CISA SCuBA\nSource: C:\\maester-tests\\cisa\\entra\\Test-MtCisaWeakFactor.Tests.ps1\nMS.AAD.3.6: Phishing-resistant MFA SHALL be required for highly privileged roles. Overview Phishing-resistant MFA SHALL be required for highly privileged roles.\nRationale: This is a backup security policy to help protect privileged access to the tenant if the conditional access policy, which requires MFA for all users, is disabled or misconfigured.\nRemediation action: Create a conditional access policy enforcing phishing-resistant MFA for highly privileged roles. Configure the following policy settings in the new conditional access policy, per the values below:\nIn Entra under Protection and Conditional Access, select Policies. Click on New policy Under New Conditional Access policy, configure the following policy settings in the new conditional access policy, per the values below: Users \u003e Include \u003e Select users and groups \u003e Directory roles \u003e select each of the roles listed in the Highly Privileged Roles listed. Target resources \u003e Cloud apps \u003e All cloud apps Access controls \u003e Grant \u003e Grant Access \u003e Require authentication strength \u003e Phishing-resistant MFA Click Save. Related links Entra admin center - Conditional Access | Policies CISA Strong Authentication \u0026 Secure Registration - MS.AAD.3.6v1 CISA ScubaGear Rego Reference CISA ScubaGear Highly Privileged Roles Test Results Your tenant does not have any conditional access policies that require phishing resistant MFA for highly privileged users.\nTag: MS.AAD MS.AAD.3.6 CISA Security All Entra ID P1\nCategory: CISA SCuBA\nSource: C:\\maester-tests\\cisa\\entra\\Test-MtCisaPrivilegedPhishResistant.Tests.ps1\nMS.AAD.3.7: Managed devices SHOULD be required for authentication. Overview Managed devices SHOULD be required for authentication.\nRationale: The security risk of an adversary authenticating to the tenant from their own device is reduced by requiring a managed device to authenticate. Managed devices are under the provisioning and control of the agency. OMB-22-09 states, “When authorizing users to access resources, agencies must consider at least one device-level signal alongside identity information about the authenticated user.”\nRemediation action: Create a conditional access policy requiring a user’s device to be either Microsoft Entra hybrid joined or compliant during authentication. Configure the following policy settings in the new conditional access policy, per the values below:\nIn Entra under Protection and Conditional Access, select Policies. Click on New policy Under New Conditional Access policy, configure the following policy settings in the new conditional access policy, per the values below: Users \u003e Include \u003e All users Target resources \u003e Cloud apps \u003e All cloud apps Access controls \u003e Grant \u003e Grant Access \u003e Require device to be marked as compliant and Require Microsoft Entra hybrid joined device \u003e For multiple controls \u003e Require one of the selected controls Click Save. Related links Entra admin center - Conditional Access | Policies CISA Strong Authentication \u0026 Secure Registration - MS.AAD.3.7v1 CISA ScubaGear Rego Reference Test Results Your tenant does not have any conditional access policies that require managed devices.\nTag: MS.AAD MS.AAD.3.7 CISA Security All Entra ID P1\nCategory: CISA SCuBA\nSource: C:\\maester-tests\\cisa\\entra\\Test-MtCisaManagedDevice.Tests.ps1\nMS.AAD.3.8: Managed Devices SHOULD be required to register MFA. Overview Managed Devices SHOULD be required to register MFA.\nRationale: Reduce risk of an adversary using stolen user credentials and then registering their own MFA device to access the tenant by requiring a managed device provisioned and controlled by the agency to perform registration actions. This prevents the adversary from using their own unmanaged device to perform the registration.\nRemediation action: Create a conditional access policy requiring a user to be on a managed device when registering for MFA.\nIn Entra under Protection and Conditional Access, select Policies. Click on New policy Under New Conditional Access policy, configure the following policy settings in the new conditional access policy, per the values below: Users \u003e Include \u003e All users Target resources \u003e User actions \u003e Register security information Access controls \u003e Grant \u003e Grant Access \u003e Require device to be marked as compliant and Require Microsoft Entra hybrid joined device \u003e For multiple controls \u003e Require one of the selected controls Click Save. Related links Entra admin center - Conditional Access | Policies CISA Strong Authentication \u0026 Secure Registration - MS.AAD.3.8v1 CISA ScubaGear Rego Reference Test Results Your tenant does not have any conditional access policies that require managed devices for registration.\nTag: MS.AAD MS.AAD.3.8 CISA Security All Entra ID P1\nCategory: CISA SCuBA\nSource: C:\\maester-tests\\cisa\\entra\\Test-MtCisaManagedDeviceRegistration.Tests.ps1\nMS.AAD.4.1: Security logs SHALL be sent to the agency’s security operations center for monitoring. Overview Security logs SHALL be sent to the agency’s security operations center for monitoring.\nRationale: The security risk of not having visibility into cyber attacks is reduced by collecting logs in the agency’s centralized security detection infrastructure. This makes security events available for auditing, query, and incident response.\nNote: The following logs (configured in Entra diagnostic settings), are required: AuditLogs, SignInLogs, RiskyUsers, UserRiskEvents, NonInteractiveUserSignInLogs, ServicePrincipalSignInLogs, ADFSSignInLogs, RiskyServicePrincipals, ServicePrincipalRiskEvents, EnrichedOffice365AuditLogs, MicrosoftGraphActivityLogs. If managed identities are used for Azure resources, also send the ManagedIdentitySignInLogs log type. If the Entra ID Provisioning Service is used to provision users to software-as-a-service (SaaS) apps or other systems, also send the ProvisioningLogs log type.\nNote: Agencies can benefit from security detection capabilities offered by the CISA Cloud Log Aggregation Warehouse (CLAW) system. Agencies are urged to send the logs to CLAW. Contact CISA at cyberliason@cisa.dhs.gov to request integration instructions.\nRemediation action: Follow the configuration instructions unique to the products and integration patterns at your organization to send the security logs to the security operations center for monitoring.\nRelated links CISA 4. Centralized Log Collection - MS.AAD.4.1v1 CISA ScubaGear Rego Reference Test Results Your tenant does not have diagnostic settings configured for all logs:\nLog Name Result ADFSSignInLogs ❌ Fail AuditLogs ❌ Fail B2CRequestLogs ❔ Optional EnrichedOffice365AuditLogs ❌ Fail ManagedIdentitySignInLogs ❌ Fail MicrosoftGraphActivityLogs ❌ Fail NetworkAccessAlerts ❔ Optional NetworkAccessTrafficLogs ❔ Optional NonInteractiveUserSignInLogs ❌ Fail ProvisioningLogs ❔ Optional RemoteNetworkHealthLogs ❔ Optional RiskyServicePrincipals ❌ Fail RiskyUsers ❌ Fail ServicePrincipalRiskEvents ❌ Fail ServicePrincipalSignInLogs ❌ Fail SignInLogs ❌ Fail UserRiskEvents ❌ Fail Tag: MS.AAD MS.AAD.4.1 CISA Security All Entra ID P1\nCategory: CISA SCuBA\nSource: C:\\maester-tests\\cisa\\entra\\Test-MtCisaDiagnosticSettings.Tests.ps1\nMS.AAD.5.1: Only administrators SHALL be allowed to register applications. Overview Only administrators SHALL be allowed to register applications.\nRationale: Application access for the tenant presents a heightened security risk compared to interactive user access because applications are typically not subject to critical security protections, such as MFA policies. Reduce risk of unauthorized users installing malicious applications into the tenant by ensuring that only specific privileged users can register applications.\nRemediation action: In Entra, under Identity and Users, select User settings. For Users can register applications, select No. Click Save. Related links Entra admin center - User settings CISA Application Registration \u0026 Consent - MS.AAD.5.1v1 CISA ScubaGear Rego Reference Test Results Your tenant is configured with Users can register applications set to Yes. The recommended setting is No.\nTag: MS.AAD MS.AAD.5.1 CISA Security All Entra ID Free\nCategory: CISA SCuBA\nSource: C:\\maester-tests\\cisa\\entra\\Test-MtCisaAppRegistration.Tests.ps1\nMS.AAD.5.2: Only administrators SHALL be allowed to consent to applications. Overview Only administrators SHALL be allowed to consent to applications.\nRationale: Limiting applications consent to only specific privileged users reduces risk of users giving insecure applications access to their data via consent grant attacks.\nRemediation action: In Entra under Identity and Applications, select Enterprise applications. Under Security, select Consent and permissions. Under Manage, select User consent settings. Under User consent for applications, select Do not allow user consent. Click Save. Related links Entra admin center - Consent and permissions | User consent settings CISA Application Registration \u0026 Consent - MS.AAD.5.2v1 CISA ScubaGear Rego Reference Test Results Your tenant allows users to consent for applications. The recommended setting is Do not allow user consent.\nTag: MS.AAD MS.AAD.5.2 CISA Security All Entra ID Free\nCategory: CISA SCuBA\nSource: C:\\maester-tests\\cisa\\entra\\Test-MtCisaAppUserConsent.Tests.ps1\nMS.AAD.5.3: An admin consent workflow SHALL be configured for applications. Overview An admin consent workflow SHALL be configured for applications.\nRationale: Configuring an admin consent workflow reduces the risk of the previous policy by setting up a process for users to securely request access to applications necessary for business purposes. Administrators have the opportunity to review the permissions requested by new applications and approve or deny access based on a risk assessment.\nRemediation action: In Entra create a new Group that contains admin users responsible for reviewing and adjudicating application consent requests. Group members will be notified when users request consent for new applications. Then in Entra under Identity and Applications, select Enterprise applications. Under Security, select Consent and permissions. Under Manage, select Admin consent settings. Under Admin consent requests and Users can request admin consent to apps they are unable to consent to select Yes. Under Who can review admin consent requests, select + Add groups and select the group responsible for reviewing and adjudicating app requests (created in step one above). Click Save. Related links Entra admin center - Consent and permissions | Admin consent settings CISA Application Registration \u0026 Consent - MS.AAD.5.3v1 CISA ScubaGear Rego Reference Test Results Your tenant admin consent request policy is not configured.\nTag: MS.AAD MS.AAD.5.3 CISA Security All Entra ID Free\nCategory: CISA SCuBA\nSource: C:\\maester-tests\\cisa\\entra\\Test-MtCisaAppAdminConsent.Tests.ps1\nMS.AAD.5.4: Group owners SHALL NOT be allowed to consent to applications. Overview Group owners SHALL NOT be allowed to consent to applications.\nRationale: In M365, group owners and team owners can consent to applications accessing data in the tenant. By requiring consent requests to go through an approval workflow, risk of exposure to malicious applications is reduced.\nRemediation action: In Entra under Identity and Applications, select Enterprise applications. Under Security, select Consent and permissions. Under Manage, select User consent settings. Under Group owner consent for apps accessing data, select Do not allow group owner consent. Click Save. Related links Entra admin center - Consent and permissions | User consent settings CISA Application Registration \u0026 Consent - MS.AAD.5.4v1 CISA ScubaGear Rego Reference Test Results Your tenant allows group owners to consent to applications.\nTag: MS.AAD MS.AAD.5.4 CISA Security All Entra ID Free\nCategory: CISA SCuBA\nSource: C:\\maester-tests\\cisa\\entra\\Test-MtCisaAppGroupOwnerConsent.Tests.ps1\nMS.AAD.6.1: User passwords SHALL NOT expire. Overview User passwords SHALL NOT expire.\nThe National Institute of Standards and Technology (NIST), OMB, and Microsoft have published guidance indicating mandated periodic password changes make user accounts less secure. For example, OMB-22-09 states, “Password policies must not require use of special characters or regular rotation.”\nRemediation action: Configure password policies to set passwords to never expire.\nIn Microsoft 365 admin center under Settings and Org settings, select the tab Security \u0026 privacy. Under Password expiration policy, set Set passwords to never expire. Click Save. Related links Microsoft 365 admin center - Org settings | Password expiration policy Configure the Password expiration policy CISA Passwords - MS.AAD.6.1v1 CISA ScubaGear Rego Reference Test Results Well done. Your tenant password expiration policy is set to never expire.\nTag: MS.AAD MS.AAD.6.1 CISA Security All Entra ID Free\nCategory: CISA SCuBA\nSource: C:\\maester-tests\\cisa\\entra\\Test-MtCisaPasswordExpiration.Tests.ps1\nMS.AAD.7.1: A minimum of two users and a maximum of eight users SHALL be provisioned with the Global Administrator role. Overview A minimum of two users and a maximum of eight users SHALL be provisioned with the Global Administrator role.\nRationale: The Global Administrator role provides unfettered access to the tenant (Azure and Microsoft 365). Limiting the number of users with this level of access makes tenant compromise more challenging. Microsoft recommends fewer than five users in the Global Administrator role. However, additional user accounts, up to eight, may be necessary to support emergency access and some operational scenarios.\nRemediation action: When counting the number of users assigned to the Global Administrator role, count each user only once.\nIn Entra under Roles \u0026 adminis and All roles, search for Global Administrator and click on it to go to the role and see who is assiged. Count users that are assigned directly to the role and users assigned via group membership.\nIf you have Entra ID PIM, count both the Eligible assignments and Active assignments.\nIf any of the groups assigned to Global Administrator are enrolled in PIM for Groups, also count the number of group members from the PIM for Groups portal Eligible assignments.\nValidate that there are a total of two to eight users assigned to the Global Administrator role.\nRelated links Entra admin center - Roles and administrators | All roles CISA 7.1 Highly Privileged User Access - MS.AAD.7.1v1 CISA ScubaGear Rego Reference Test Results Well done. Your tenant has two or more and eight or fewer Global Administrators:\nJoi Jons Tag: MS.AAD MS.AAD.7.1 CISA Security All Entra ID Free\nCategory: CISA SCuBA\nSource: C:\\maester-tests\\cisa\\entra\\Test-MtCisaGlobalAdminCount.Tests.ps1\nMS.AAD.7.2: Privileged users SHALL be provisioned with finer-grained roles instead of Global Administrator. Overview Privileged users SHALL be provisioned with finer-grained roles instead of Global Administrator.\nRationale: Many privileged administrative users do not need unfettered access to the tenant to perform their duties. By assigning them to roles based on least privilege, the risks associated with having their accounts compromised are reduced.\nRemediation action: This policy is based on the ratio below:\nX = (Number of users assigned to the Global Administrator role) / (Number of users assigned to other highly privileged roles)\nFollow the instructions for policy MS.AAD.7.1v1 above to get a count of users assigned to the Global Administrator role. Follow the instructions for policy MS.AAD.7.1v1 above but get a count of users assigned to the other highly privileged roles (not Global Administrator). If a user is assigned to both Global Administrator and other roles, only count that user for the Global Administrator assignment. Divide the value from step 2 from the value from step 1 to calculate X. If X is less than or equal to 1 then the tenant is compliant with the policy. Related links CISA 7.2 Highly Privileged User Access - MS.AAD.7.2v1 CISA ScubaGear Rego Reference Test Results Your tenant does not have enough granular role assignments.\nCurrent Ratio: 0 = 2 / 0\nRatio \u003e= 1 - False\nTag: MS.AAD MS.AAD.7.2 CISA Security All Entra ID Free\nCategory: CISA SCuBA\nSource: C:\\maester-tests\\cisa\\entra\\Test-MtCisaGlobalAdminRatio.Tests.ps1\nMS.AAD.7.3: Privileged users SHALL be provisioned cloud-only accounts separate from an on-premises directory or other federated identity providers. Overview Privileged users SHALL be provisioned cloud-only accounts separate from an on-premises directory or other federated identity providers.\nRationale: Many privileged administrative users do not need unfettered access to the tenant to perform their duties. By assigning them to roles based on least privilege, the risks associated with having their accounts compromised are reduced.\nRemediation action: Perform the steps below for each highly privileged role. Review the users listed that have an OnPremisesImmutableId and have OnPremisesSyncEnabled set. Create a cloud only user account for that individual and remove their hybrid identity from privileged roles. Related links Entra admin center - Roles and administrators | All roles CISA 7.3 Highly Privileged User Access - MS.AAD.7.3v1 CISA ScubaGear Rego Reference Test Results Well done. Your tenant has no hybrid Global Administrators.\nTag: MS.AAD MS.AAD.7.3 CISA Security All Entra ID Free\nCategory: CISA SCuBA\nSource: C:\\maester-tests\\cisa\\entra\\Test-MtCisaCloudGlobalAdmin.Tests.ps1\nMS.AAD.7.4: Permanent active role assignments SHALL NOT be allowed for highly privileged roles. Overview Permanent active role assignments SHALL NOT be allowed for highly privileged roles.\nRationale: Instead of giving users permanent assignments to privileged roles, provisioning access just in time lessens exposure if those accounts become compromised. In Azure AD PIM or an alternative PAM system, just in time access can be provisioned by assigning users to roles as eligible instead of perpetually active.\nNote: Exceptions to this policy are:\nEmergency access accounts that need perpetual access to the tenant in the rare event of system degradation or other scenarios. Some types of service accounts that require a user account with privileged roles; since these accounts are used by software programs, they cannot perform role activation. Remediation action: In Entra admin center select Show more and Roles \u0026 adminis and then All roles.\nPerform the steps below for each highly privileged role. We reference the Global Administrator role as an example.\nSelect the Global administrator role.\nUnder Manage, select Assignments and click the Active assignments tab.\nVerify there are no users or groups with a value of Permanent in the End time column. If there are any, recreate those assignments to have an expiration date using Entra ID PIM or an alternative PAM system. If a group is identified and it is enrolled in PIM for Groups, see the exception cases below for details.\nRelated links Entra admin center - Roles and administrators | All roles CISA 7.4 Highly Privileged User Access - MS.AAD.7.4v1 CISA ScubaGear Rego Reference Test Results Your tenant has active assignments without expiration to privileged roles.\nTag: MS.AAD MS.AAD.7.4 CISA Security All Entra ID P2\nCategory: CISA SCuBA\nSource: C:\\maester-tests\\cisa\\entra\\Test-MtCisaPermanentRoleAssignment.Tests.ps1\nMS.AAD.7.5: Provisioning users to highly privileged roles SHALL NOT occur outside of a PAM system. Overview Provisioning users to highly privileged roles SHALL NOT occur outside of a PAM system.\nRationale: Provisioning users to privileged roles within a PAM system enables enforcement of numerous privileged access policies and monitoring. If privileged users are assigned directly to roles in the M365 admin center or via PowerShell outside of the context of a PAM system, a significant set of critical security capabilities are bypassed.\nRemediation action: In Entra admin center select Show more \u003e Roles \u0026 admins and then select All roles.\nPerform the steps below for each highly privileged role. We reference the Global Administrator role as an example.\nSelect the Global administrator role.\nUnder Manage, select Assignments and click the Active assignments tab.\nFor each user or group listed, examine the value in the Start time column. If it contains a value of -, this indicates the respective user/group was assigned to that role outside of Entra ID PIM. If the role was assigned outside of Entra ID PIM, delete the assignment and recreate it using Entra ID PIM.\nRelated links Entra admin center - Roles and administrators | All roles CISA 7.5 Highly Privileged User Access - MS.AAD.7.5v1 CISA ScubaGear Rego Reference Test Results Well done. Your tenant has no unmanaged active role assignments.\nTag: MS.AAD MS.AAD.7.5 CISA Security All Entra ID P2\nCategory: CISA SCuBA\nSource: C:\\maester-tests\\cisa\\entra\\Test-MtCisaUnmanagedRoleAssignments.Tests.ps1\nMS.AAD.7.6: Activation of the Global Administrator role SHALL require approval. Overview Activation of the Global Administrator role SHALL require approval.\nRationale: Requiring approval for a user to activate Global Administrator, which provides unfettered access, makes it more challenging for an attacker to compromise the tenant with stolen credentials and it provides visibility of activities indicating a compromise is taking place.\nRemediation action: In Entra admin center select Identity governance and Privileged Identity Management. Under Manage, select Microsoft Entra roles. Under Manage, select Roles. Select the Global Administrator role in the list. Click Settings. Click Edit. Select the Require approval to activate option. Click Update. Review the list of groups that are actively assigned to the Global Administrator role. If any of the groups are enrolled in PIM for Groups, then also apply the same configurations under step 2 above to each PIM group’s Member settings. Related links Entra admin center - Privileged Identity Management | Microsoft Entra roles CISA 7.6 Highly Privileged User Access - MS.AAD.7.6v1 CISA ScubaGear Rego Reference Test Results Your tenant has active assignments without a start date.\nTag: MS.AAD MS.AAD.7.6 CISA Security All Entra ID P2\nCategory: CISA SCuBA\nSource: C:\\maester-tests\\cisa\\entra\\Test-MtCisaRequireActivationApproval.Tests.ps1\nMS.AAD.7.7: Eligible and Active highly privileged role assignments SHALL trigger an alert. Overview Eligible and Active highly privileged role assignments SHALL trigger an alert.\nRationale: Closely monitor assignment of the highest privileged roles for signs of compromise. Send assignment alerts to enable the security monitoring team to detect compromise attempts.\nRemediation action: In Entra admin center select Identity governance and Privileged Identity Management.\nUnder Manage, select Microsoft Entra roles.\nUnder Manage, select Roles.\nPerform the steps below for each highly privileged role. We reference the Global Administrator role as an example.\nClick the Global Administrator role.\nClick Settings and then click Edit.\nClick the Notifications tab.\nUnder Send notifications when members are assigned as eligible to this role, in the Role assignment alert \u003e Additional recipients textbox, enter the email address of the security monitoring mailbox configured to receive privileged role assignment alerts.\nUnder Send notifications when members are assigned as active to this role, in the Role assignment alert \u003e Additional recipients textbox, enter the email address of the security monitoring mailbox configured to receive privileged role assignment alerts.\nClick Update.\nFor each of the highly privileged roles, if they have any PIM groups actively assigned to them, then also apply the same configurations per the steps above to each PIM group’s Member settings.\nRelated links Entra admin center - Privileged Identity Management | Microsoft Entra roles CISA 7.7 Highly Privileged User Access - MS.AAD.7.7v1 CISA ScubaGear Rego Reference Test Results Your tenant has highly privileged roles without notifications.\nTag: MS.AAD MS.AAD.7.7 CISA Security All Entra ID P2\nCategory: CISA SCuBA\nSource: C:\\maester-tests\\cisa\\entra\\Test-MtCisaAssignmentNotification.Tests.ps1\nMS.AAD.7.8: User activation of the Global Administrator role SHALL trigger an alert. Overview User activation of the Global Administrator role SHALL trigger an alert.\nRationale: Closely monitor activation of the Global Administrator role for signs of compromise. Send activation alerts to enable the security monitoring team to detect compromise attempts.\nUser activation of other highly privileged roles SHOULD trigger an alert.\nRationale: Closely monitor activation of high-risk roles for signs of compromise. Send activation alerts to enable the security monitoring team to detect compromise attempts. In some environments, activating privileged roles can generate a significant number of alerts.\nRemediation action: In Entra admin center select Identity governance and Privileged Identity Management.\nUnder Manage, select Microsoft Entra roles.\nUnder Manage, select Roles.\nSearch and click the Global Administrator role.\nFor each of the highly privileged roles (other than Global Administrator), follow the same steps but enter a security monitoring mailbox different from the one used to monitor Global Administrator activations.\nClick Settings and then click Edit.\nClick the Notifications tab.\nUnder Send notifications when eligible members activate this role, in the Role activation alert \u003e Additional recipients textbox, enter the email address of the security monitoring mailbox configured to receive role activation alerts.\nClick Update.\nIf the role has any PIM groups actively assigned to it, then also apply the same configurations per the steps above to each PIM group’s Member settings.\nRelated links Entra admin center - Privileged Identity Management | Microsoft Entra roles CISA 7.8 Highly Privileged User Access - MS.AAD.7.8v1 CISA ScubaGear Rego Reference CISA 7.9 Highly Privileged User Access - MS.AAD.7.9v1 CISA ScubaGear Rego Reference Test Results Your tenant does not have notifications on role activations.\nRole Name Result Global Administrator ❌ Fail Tag: MS.AAD MS.AAD.7.8 CISA Security All Entra ID P2\nCategory: CISA SCuBA\nSource: C:\\maester-tests\\cisa\\entra\\Test-MtCisaActivationNotificationGlobalAdmin.Tests.ps1\nMS.AAD.7.9: User activation of other highly privileged roles SHOULD trigger an alert. Overview User activation of the Global Administrator role SHALL trigger an alert.\nRationale: Closely monitor activation of the Global Administrator role for signs of compromise. Send activation alerts to enable the security monitoring team to detect compromise attempts.\nUser activation of other highly privileged roles SHOULD trigger an alert.\nRationale: Closely monitor activation of high-risk roles for signs of compromise. Send activation alerts to enable the security monitoring team to detect compromise attempts. In some environments, activating privileged roles can generate a significant number of alerts.\nRemediation action: In Entra admin center select Identity governance and Privileged Identity Management.\nUnder Manage, select Microsoft Entra roles.\nUnder Manage, select Roles.\nSearch and click the Global Administrator role.\nFor each of the highly privileged roles (other than Global Administrator), follow the same steps but enter a security monitoring mailbox different from the one used to monitor Global Administrator activations.\nClick Settings and then click Edit.\nClick the Notifications tab.\nUnder Send notifications when eligible members activate this role, in the Role activation alert \u003e Additional recipients textbox, enter the email address of the security monitoring mailbox configured to receive role activation alerts.\nClick Update.\nIf the role has any PIM groups actively assigned to it, then also apply the same configurations per the steps above to each PIM group’s Member settings.\nRelated links Entra admin center - Privileged Identity Management | Microsoft Entra roles CISA 7.8 Highly Privileged User Access - MS.AAD.7.8v1 CISA ScubaGear Rego Reference CISA 7.9 Highly Privileged User Access - MS.AAD.7.9v1 CISA ScubaGear Rego Reference Test Results Your tenant does not have notifications on role activations.\nRole Name Result User Administrator ❌ Fail Exchange Administrator ❌ Fail SharePoint Administrator ❌ Fail Application Administrator ❌ Fail Privileged Role Administrator ❌ Fail Cloud Application Administrator ❌ Fail Hybrid Identity Administrator ❌ Fail Tag: MS.AAD MS.AAD.7.9 CISA Security All Entra ID P2\nCategory: CISA SCuBA\nSource: C:\\maester-tests\\cisa\\entra\\Test-MtCisaActivationNotificationOther.Tests.ps1\nMS.AAD.8.1: Guest users SHOULD have limited or restricted access to Azure AD directory objects. Overview Guest users SHOULD have limited or restricted access to Azure AD directory objects.\nRationale: Limiting the amount of object information available to guest users in the tenant, reduces malicious reconnaissance exposure, should a guest account become compromised or be created by an adversary.\nRemediation action In Entra ID and External Identities, select External collaboration settings. Under Guest user access, select either Guest users have limited access to properties and memberships of directory objects or Guest user access is restricted to properties and memberships of their own directory objects (most restrictive). Click Save. Related links Entra admin center - External Identities | External collaboration settings CISA Guest User Access - MS.AAD.8.1v1 CISA ScubaGear Rego Reference Test Results Well done. Guest users have limited access to properties and memberships of directory objects\nTag: MS.AAD MS.AAD.8.1 CISA Security All Entra ID Free\nCategory: CISA SCuBA\nSource: C:\\maester-tests\\cisa\\entra\\Test-MtCisaGuestUserAccess.Tests.ps1\nMS.AAD.8.2: Only users with the Guest Inviter role SHOULD be able to invite guest users. Overview Only users with the Guest Inviter role SHOULD be able to invite guest users.\nRationale: By only allowing an authorized group of individuals to invite external users to create accounts in the tenant, an agency can enforce a guest user account approval process, reducing the risk of unauthorized account creation.\nRemediation action: In Entra ID and External Identities, select External collaboration settings.\nUnder Guest invite settings, select Only users assigned to specific admin roles can invite guest users or No one in the organization can invite guest users including admins (most restrictive).\nClick Save.\nRelated links Entra admin center - External Identities | External collaboration settings CISA Guest User Access - MS.AAD.8.2v1 CISA ScubaGear Rego Reference Test Results Your tenant allows anyone to invite guests.\nallowInvitesFrom : everyone\nTag: MS.AAD MS.AAD.8.2 CISA Security All Entra ID Free\nCategory: CISA SCuBA\nSource: C:\\maester-tests\\cisa\\entra\\Test-MtCisaGuestInvitation.Tests.ps1\nMS.AAD.8.3: Guest invites SHOULD only be allowed to specific external domains that have been authorized by the agency for legitimate business purposes. Overview Guest invites SHOULD only be allowed to specific external domains that have been authorized by the agency for legitimate business purposes.\nRationale: Limiting which domains can be invited to create guest accounts in the tenant helps reduce the risk of users from unauthorized external organizations getting access.\n⚠️ WARNING: This test utilizes a technical mechanism that differs from CISA’s, though the outcome is the same.\nRemediation action: In Entra admin center select External Identities and Cross-tenant access settings. Under Default settings, select Edit inbound defaults. Under B2B collaboration, and External users and groups, ensure Access status is set to Block access. Under B2B collaboration, and Applications, ensure Access status is set to Block access. This configuration will only allow B2B collaboration with other Entra tenants.\nRelated links Entra admin center - External Identities | Cross-tenant access settings CISA 8 Guest User Access - MS.AAD.8.3v1 CISA ScubaGear Rego Reference Test Results Your tenant’s default cross-tenant inbound access policy is not set to block:\nExternal Users \u0026 Groups Applications ❌ Fail ❌ Fail Tag: MS.AAD MS.AAD.8.3 CISA Security All Entra ID Free\nCategory: CISA SCuBA\nSource: C:\\maester-tests\\cisa\\entra\\Test-MtCisaCrossTenantInboundDefault.Tests.ps1\nMS.EXO.01.1: Automatic forwarding to external domains SHALL be disabled. Overview Automatic forwarding to external domains SHALL be disabled.\nRationale: Adversaries can use automatic forwarding to gain persistent access to a victim’s email. Disabling forwarding to external domains prevents this technique when the adversary is external to the organization but does not impede legitimate internal forwarding.\nRemediation action: To disable automatic forwarding to external domains:\nSign in to the Exchange admin center. Select Mail flow, then Remote domains. Select Default. Under Email reply types, select Edit reply types. Clear the checkbox next to Allow automatic forwarding, then click Save. Return to Remote domains and repeat steps 4 and 5 for each additional remote domain in the list. Related links Exchange admin center - Remote domains CISA 1 Automatic Forwarding to External Domains - MS.EXO.1.1v1 CISA ScubaGear Rego Reference Test Results Your tenant does not have automatic forwarding disabled for all domains.\nName Domain Automatic forwarding Test Result Default * Allow automatic forwarding ❌ Fail Tag: MS.EXO MS.EXO.1.1 CISA Security All\nCategory: CISA SCuBA\nSource: C:\\maester-tests\\cisa\\exchange\\Test-MtCisaAutoExternalForwarding.Tests.ps1\nMS.EXO.02.1: A list of approved IP addresses for sending mail SHALL be maintained. Overview A list of approved IP addresses for sending mail SHALL be maintained.\nRationale: Failing to maintain an accurate list of authorized IP addresses may result in spoofed email messages or failure to deliver legitimate messages when SPF is enabled. Maintaining such a list helps ensure that unauthorized servers sending spoofed messages can be detected, and permits message delivery from legitimate senders.\nRemediation action: Identify any approved senders specific to your agency. Perform regular review of SPF record and update as necessary. Additionally, see External DNS records required for SPF for inclusions required for Microsoft to send email on behalf of your domain. Related links Exchange admin center - Accepted domains CISA 2 Sender Policy Framework - MS.EXO.2.1v1 CISA ScubaGear Rego Reference Test Results Well done. Your tenant’s domains have a restricted SPF, review authorized senders for accuracy.\nDomain Result Reason Addresses alit.is ✅ Pass Last directive is ‘-all’ 40.92.0.0/15, 40.107.0.0/16, \u0026 …9 addresses vxcnx.mail.onmicrosoft.com ✅ Pass Last directive is ‘-all’ 157.56.232.0/21, 157.56.240.0/20, \u0026 …65 addresses vxcnx.onmicrosoft.com ✅ Pass Last directive is ‘-all’ 40.92.0.0/15, 40.107.0.0/16, \u0026 …9 addresses Tag: MS.EXO MS.EXO.2.1 CISA Security All\nCategory: CISA SCuBA\nSource: C:\\maester-tests\\cisa\\exchange\\Test-MtCisaSpfRestriction.Tests.ps1\nMS.EXO.02.2: An SPF policy SHALL be published for each domain, designating only these addresses as approved senders. Overview An SPF policy SHALL be published for each domain, designating only these addresses as approved senders.\nRationale: An adversary may modify the FROM field of an email such that it appears to be a legitimate email sent by an agency, facilitating phishing attacks. Publishing an SPF policy for each agency domain mitigates forged FROM fields by providing a means for recipients to detect emails spoofed in this way. SPF is required for FCEB departments and agencies by Binding Operational Directive (BOD) 18-01, “Enhance Email and Web Security”.\nRemediation action: SPF is not configured through the Exchange admin center, but rather via DNS records hosted by the agency’s domain. Thus, the exact steps needed to set up SPF varies from agency to agency. See Add or edit an SPF TXT record to help prevent email spam (Outlook, Exchange Online) | Microsoft Learn for more details.\nTo test your SPF configuration, consider using a web-based tool, such as those listed under How can I validate SPF records for my domain? | Microsoft Learn. Additionally, SPF records can be requested using the PowerShell tool Resolve-DnsName. For example:\nResolve-DnsName example.onmicrosoft.com txt\nIf SPF is configured, you will see a response resembling v=spf1 include:spf.protection.outlook.com -all returned; though by necessity, the contents of the SPF policy may vary by agency. In this example, the SPF policy indicates the IP addresses listed by the policy for “spf.protection.outlook.com” are the only approved senders for “example.onmicrosoft.com.” These IPs can be determined via an additional SPF lookup, this time for “spf.protection.outlook.com.” Ensure the IP addresses listed as approved senders for your domain are those identified for MS.EXO.2.1v1. See SPF TXT record syntax for Microsoft 365 | Microsoft Learn for a more in-depth discussion of SPF record syntax.\nRelated links Exchange admin center - Accepted domains CISA 2 Sender Policy Framework - MS.EXO.2.2v1 CISA ScubaGear Rego Reference Test Results Your tenant’s domains do not restrict authorized senders with SPF fully. Ensure authorized senders are specified.\nDomain Result Reason Directives alit.is ✅ Pass 1+ mechanism targets include:spf.protection.outlook.com vxcnx.mail.onmicrosoft.com ❌ Fail No EXO directive include:outlook.com vxcnx.onmicrosoft.com ✅ Pass 1+ mechanism targets include:spf.protection.outlook.com Tag: MS.EXO MS.EXO.2.2 CISA Security All\nCategory: CISA SCuBA\nSource: C:\\maester-tests\\cisa\\exchange\\Test-MtCisaSpfDirective.Tests.ps1\nMS.EXO.03.1: DKIM SHOULD be enabled for all domains. Overview DKIM SHOULD be enabled for all domains.\nRationale: An adversary may modify the FROM field of an email such that it appears to be a legitimate email sent by an agency, facilitating phishing attacks. Enabling DKIM is another means for recipients to detect spoofed emails and verify the integrity of email content.\nRemediation action: To enable DKIM, follow the instructions listed on Steps to Create, enable and disable DKIM from Microsoft 365 Defender portal | Microsoft Learn.\nRelated links Defender admin center - Email authentication settings CISA 3 Sender Policy Framework - MS.EXO.3.1v1 CISA ScubaGear Rego Reference Test Results Your tenant’s domains do not have DKIM fully deployed. Review EXO configuration and DNS records.\nDomain Result Reason alit.is ❌ Fail Failure to obtain record vxcnx.mail.onmicrosoft.com ❌ Fail Failure to obtain record vxcnx.onmicrosoft.com ❌ Fail Failure to obtain record Tag: MS.EXO MS.EXO.3.1 CISA Security All\nCategory: CISA SCuBA\nSource: C:\\maester-tests\\cisa\\exchange\\Test-MtCisaDkim.Tests.ps1\nMS.EXO.04.1: A DMARC policy SHALL be published for every second-level domain. Overview $cisaDmarcRecordExist = Test-MtCisaDmarcRecordExist\nif ($null -ne $cisaDmarcRecordExist) {\r$cisaDmarcRecordExist | Should -Be $true -Because \"DMARC record should exist.\"\r}\rTag: MS.EXO MS.EXO.4.1 CISA Security All\nCategory: CISA SCuBA\nSource: C:\\maester-tests\\cisa\\exchange\\Test-MtCisaDmarcRecordExist.Tests.ps1\nMS.EXO.04.2: The DMARC message rejection option SHALL be p=reject. Overview $cisaDmarcRecordReject = Test-MtCisaDmarcRecordReject\nif ($null -ne $cisaDmarcRecordReject) {\r$cisaDmarcRecordReject | Should -Be $true -Because \"DMARC record policy should be reject.\"\r}\rTag: MS.EXO MS.EXO.4.2 CISA Security All\nCategory: CISA SCuBA\nSource: C:\\maester-tests\\cisa\\exchange\\Test-MtCisaDmarcRecordReject.Tests.ps1\nMS.EXO.05.1: SMTP AUTH SHALL be disabled. Overview SMTP AUTH SHALL be disabled.\nRationale: SMTP AUTH is not used or needed by modern email clients. Therefore, disabling it as the global default conforms to the principle of least functionality.\nRemediation action: To disable SMTP AUTH for the organization: Sign in to the Exchange admin center. On the left hand pane, select Settings; then from the settings list, select Mail Flow. Make sure the setting Turn off SMTP AUTH protocol for your organization is checked. Related links Exchange admin center - Settings CISA 5 Simple Mail Transfer Protocol Authentication - MS.EXO.5.1v1 CISA ScubaGear Rego Reference Test Results Well done. Your tenant has SMTP Authentication disabled.\nTag: MS.EXO MS.EXO.5.1 CISA Security All\nCategory: CISA SCuBA\nSource: C:\\maester-tests\\cisa\\exchange\\Test-MtCisaSmtpAuthentication.Tests.ps1\nMS.EXO.06.1: Contact folders SHALL NOT be shared with all domains. Overview Contact folders SHALL NOT be shared with all domains.\nRationale: Contact folders may contain information that should not be shared by default with all domains. Disabling sharing with all domains closes an avenue for data exfiltration while still allowing for specific legitimate use as needed.\nRemediation action: To restrict sharing with all domains:\nSign in to the Exchange admin center. On the left-hand pane under Organization, select Sharing. Select Individual Sharing. For all existing policies, select the policy, then select Manage domains. For all sharing rules under all existing policies, ensure Sharing with everyone and Anonymous do not include ContactsSharing. Related links Exchange admin center - Individual Sharing CISA 6 Calendar and Contact Sharing - MS.EXO.6.1v1 CISA ScubaGear Rego Reference Test Results Well done. Your tenant does not allow uncontrolled contact sharing.\nPolicy Name Test Result Default Sharing Policy ✅ Pass Tag: MS.EXO MS.EXO.6.1 CISA Security All\nCategory: CISA SCuBA\nSource: C:\\maester-tests\\cisa\\exchange\\Test-MtCisaContactSharing.Tests.ps1\nMS.EXO.06.2: Calendar details SHALL NOT be shared with all domains. Overview Calendar details SHALL NOT be shared with all domains.\nRationale: Calendar details may contain information that should not be shared by default with all domains. Disabling sharing with all domains closes an avenue for data exfiltration while still allowing for legitimate use as needed.\nRemediation action: To restrict sharing with all domains:\nSign in to the Exchange admin center. On the left-hand pane under Organization, select Sharing. Select Individual Sharing. For all existing policies, select the policy, then select Manage domains. For all sharing rules under all existing policies, ensure Sharing with everyone and Anonymous do not include CalendarSharing. Related links Exchange admin center - Individual Sharing CISA 6 Calendar and Contact Sharing - MS.EXO.6.2v1 CISA ScubaGear Rego Reference Test Results Your tenant allows uncontrolled calendar sharing.\nPolicy Name Test Result Default Sharing Policy ❌ Fail Tag: MS.EXO MS.EXO.6.2 CISA Security All\nCategory: CISA SCuBA\nSource: C:\\maester-tests\\cisa\\exchange\\Test-MtCisaCalendarSharing.Tests.ps1\nMS.EXO.07.1: External sender warnings SHALL be implemented. Overview External sender warnings SHALL be implemented.\nRationale: Phishing is an ever-present threat. Alerting users when email originates from outside their organization can encourage them to exercise increased caution, especially if an email is one they expected from an internal sender.\n⚠️ WARNING: This test allows the use of a technical mechanism that differs from CISA’s, though the outcome is the same.\nRemediation action: Option 1: Use external sender identification This feature is only available for Outlook, Outlook for Mac, Outlook on the web, and Outlook for iOS and Android.\nConnect to Exchange Online using PowerShell module ExchangeOnlineManagement Enable the feature with the cmdlet Set-ExternalInOutlook Connect-ExchangeOnline Set-ExternalInOutlook -Enabled $true Option 2: Prepend subject with “[External]” To create a mail flow rule to produce external sender warnings:\nSign in to the Exchange admin center. Under Mail flow, select Rules. Click the plus (+) button to create a new rule. Select Modify messages…. Give the rule an appropriate name. Under Apply this rule if…, select The sender is external/internal. Under select sender location, select Outside the organization, then click OK. Under Do the following…, select Prepend the subject of the message with…. Under specify subject prefix, enter a message such as “[External]” (without the quotation marks), then click OK. Click Next. Under Choose a mode for this rule, select Enforce. Leave the Severity as Not Specified. Leave the Match sender address in message as Header and click Next. Click Finish and then Done. The new rule will be disabled. Re-select the new rule to show its settings and slide the Enable or disable rule slider to the right until it shows as Enabled. Related links Exchange admin center - Mail Flow Rules CISA 7 External Sender Warnings - MS.EXO.7.1v1 CISA ScubaGear Rego Reference Test Results Your tenant does not have an external sender warning.\nTag: MS.EXO MS.EXO.7.1 CISA Security All\nCategory: CISA SCuBA\nSource: C:\\maester-tests\\cisa\\exchange\\Test-MtCisaExternalSenderWarning.Tests.ps1\nMS.EXO.08.1: A DLP solution SHALL be used. Overview A DLP solution SHALL be used.\nRationale: Users may inadvertently disclose sensitive information to unauthorized individuals. A DLP solution may detect the presence of sensitive information in Exchange Online and block access to unauthorized entities.\nRemediation action: Sign in to the Microsoft Purview compliance portal.\nUnder the Solutions section, select Data loss prevention.\nSelect Policies from the left menu.\nSelect Create policy.\nFrom the Categories list, select Custom.\nFrom the Templates list, select Custom policy and then click Next.\nEdit the name and description of the policy if desired, then click Next.\nUnder Choose locations to apply the policy, set Status to On for at least the Exchange email, OneDrive accounts, SharePoint sites, Teams chat and channel messages, and Devices locations, then click Next.\nUnder Define policy settings, select Create or customize advanced DLP rules, and then click Next.\nClick Create rule. Assign the rule an appropriate name and description.\nClick Add condition, then Content contains.\nClick Add, then Sensitive info types.\nAdd information types that protect information sensitive to the agency.\nAt a minimum, the agency should protect:\nCredit card numbers U.S. Individual Taxpayer Identification Numbers (ITIN) U.S. Social Security Numbers (SSN) All agency-defined PII and sensitive information Click Add.\nUnder Actions, click Add an action.\nCheck Restrict Access or encrypt the content in Microsoft 365 locations.\nUnder this action, select Block Everyone.\nUnder User notifications, turn on Use notifications to inform your users and help educate them on the proper use of sensitive info.\nUnder Microsoft 365 services, a section that appears after user notifications are turned on, check the box next to Notify users in Office 365 service with a policy tip.\nClick Save, then Next.\nSelect Turn it on right away, then click Next.\nClick Submit.\nRelated links Purview admin center - Data loss prevention policies CISA 8 Data Loss Prevention Solutions - MS.EXO.8.1 CISA ScubaGear Rego Reference Test Results Your tenant does not have Purview Data Loss Prevention Policies enabled.\nName Status Description Tag: MS.EXO MS.EXO.8.1 CISA Security All\nCategory: CISA SCuBA\nSource: C:\\maester-tests\\cisa\\exchange\\Test-MtCisaDlp.Tests.ps1\nMS.EXO.08.2: The DLP solution SHALL protect personally identifiable information (PII) and sensitive information, as defined by the agency. Overview The DLP solution SHALL protect personally identifiable information (PII) and sensitive information, as defined by the agency.\nReference your organization’s policy defining PII.\nRationale: Users may inadvertently share sensitive information with others who should not have access to it. Data loss prevention policies provide a way for agencies to detect and prevent unauthorized disclosures.\nRemediation action: Sign in to the Microsoft Purview compliance portal.\nUnder the Solutions section, select Data loss prevention.\nSelect Policies from the left menu.\nSelect Create policy.\nFrom the Categories list, select Custom.\nFrom the Templates list, select Custom policy and then click Next.\nEdit the name and description of the policy if desired, then click Next.\nUnder Choose locations to apply the policy, set Status to On for at least the Exchange email, OneDrive accounts, SharePoint sites, Teams chat and channel messages, and Devices locations, then click Next.\nUnder Define policy settings, select Create or customize advanced DLP rules, and then click Next.\nClick Create rule. Assign the rule an appropriate name and description.\nClick Add condition, then Content contains.\nClick Add, then Sensitive info types.\nAdd information types that protect information sensitive to the agency.\nAt a minimum, the agency should protect:\nCredit card numbers U.S. Individual Taxpayer Identification Numbers (ITIN) U.S. Social Security Numbers (SSN) All agency-defined PII and sensitive information Click Add.\nUnder Actions, click Add an action.\nCheck Restrict Access or encrypt the content in Microsoft 365 locations.\nUnder this action, select Block Everyone.\nUnder User notifications, turn on Use notifications to inform your users and help educate them on the proper use of sensitive info.\nUnder Microsoft 365 services, a section that appears after user notifications are turned on, check the box next to Notify users in Office 365 service with a policy tip.\nClick Save, then Next.\nSelect Turn it on right away, then click Next.\nClick Submit.\nRelated links Purview admin center - Data loss prevention policies CISA 8 Data Loss Prevention Solutions - MS.EXO.8.2 CISA ScubaGear Rego Reference Test Results Your tenant does not have Purview Data Loss Prevention Policies enabled with the Sensitive Info Type of All Full Names.\nStatus Policy Rule Tag: MS.EXO MS.EXO.8.2 CISA Security All\nCategory: CISA SCuBA\nSource: C:\\maester-tests\\cisa\\exchange\\Test-MtCisaDlpPii.Tests.ps1\nMS.EXO.08.4: At a minimum, the DLP solution SHALL restrict sharing credit card numbers, U.S. Individual Taxpayer Identification Numbers (ITIN), and U.S. Social Security numbers (SSN) via email. Overview At a minimum, the DLP solution SHALL restrict sharing credit card numbers, U.S. Individual Taxpayer Identification Numbers (ITIN), and U.S. Social Security numbers (SSN) via email.\nReference your organization’s policy defining restricted information.\nRationale: Users may inadvertently share sensitive information with others who should not have access to it. Data loss prevention policies provide a way for agencies to detect and prevent unauthorized disclosures.\nRemediation action: Sign in to the Microsoft Purview compliance portal.\nUnder the Solutions section, select Data loss prevention.\nSelect Policies from the left menu.\nSelect Create policy.\nFrom the Categories list, select Custom.\nFrom the Templates list, select Custom policy and then click Next.\nEdit the name and description of the policy if desired, then click Next.\nUnder Choose locations to apply the policy, set Status to On for at least the Exchange email, OneDrive accounts, SharePoint sites, Teams chat and channel messages, and Devices locations, then click Next.\nUnder Define policy settings, select Create or customize advanced DLP rules, and then click Next.\nClick Create rule. Assign the rule an appropriate name and description.\nClick Add condition, then Content contains.\nClick Add, then Sensitive info types.\nAdd information types that protect information sensitive to the agency.\nAt a minimum, the agency should protect:\nCredit card numbers U.S. Individual Taxpayer Identification Numbers (ITIN) U.S. Social Security Numbers (SSN) All agency-defined PII and sensitive information Click Add.\nUnder Actions, click Add an action.\nCheck Restrict Access or encrypt the content in Microsoft 365 locations.\nUnder this action, select Block Everyone.\nUnder User notifications, turn on Use notifications to inform your users and help educate them on the proper use of sensitive info.\nUnder Microsoft 365 services, a section that appears after user notifications are turned on, check the box next to Notify users in Office 365 service with a policy tip.\nClick Save, then Next.\nSelect Turn it on right away, then click Next.\nClick Submit.\nRelated links Purview admin center - Data loss prevention policies CISA 8 Data Loss Prevention Solutions - MS.EXO.8.4 CISA ScubaGear Rego Reference Test Results Your tenant does not have Purview Data Loss Prevention Policies enabled with the Sensitive Info Type of credit card numbers, U.S. Individual Taxpayer Identification Numbers (ITIN), and U.S. Social Security numbers (SSN).\nRequired Rules:\nCredit Card Number U.S. Social Security Number U.S. Individual Taxpayer Identification Number ❌ Fail ❌ Fail ❌ Fail Rule Relationships:\nStatus Policy Rule Tag: MS.EXO MS.EXO.8.4 CISA Security All\nCategory: CISA SCuBA\nSource: C:\\maester-tests\\cisa\\exchange\\Test-MtCisaDlpBaselineRule.Tests.ps1\nMS.EXO.09.1: Emails SHALL be filtered by attachment file types. Overview Emails SHALL be filtered by attachment file types.\nRationale: Malicious attachments often take the form of click-to-run files. Sharing high risk file types, when necessary, is better left to a means other than email; the dangers of allowing them to be sent over email outweigh any potential benefits. Filtering email attachments based on file types can prevent spread of malware distributed via click-to-run email attachments.\nRemediation action: Sign in to Microsoft 365 Defender. In the left-hand menu, go to Email \u0026 Collaboration \u003e Policies \u0026 Rules. Select Threat Policies. From the Templated policies section, select Preset Security Policies. Under Standard protection, slide the toggle switch to the right so the text next to the toggle reads Standard protection is on. Under Strict protection, slide the toggle switch to the right so the text next to the toggle reads Strict protection is on. Note: If the toggle slider in step 5 is grayed out, click on Manage protection settings instead and configure the policy settings according to Use the Microsoft 365 Defender portal to assign Standard and Strict preset security policies to users | Microsoft Learn.\nRelated links Defender admin center - Preset security policies CISA 9 Attachment File Type - MS.EXO.9.1v2 CISA ScubaGear Rego Reference Microsoft Learn - Common attachments filter in anti-malware policies Test Results Your tenant does not have standard and strict preset security policies enabled.\nPolicy Status Standard ❌ Fail Strict ❌ Fail Policy Name File Filter Enabled Extensions Default ✅ Pass ace, apk, app, appx, ani, \u0026 48 others Tag: MS.EXO MS.EXO.9.1 CISA Security All\nCategory: CISA SCuBA\nSource: C:\\maester-tests\\cisa\\exchange\\Test-MtCisaAttachmentFilter.Tests.ps1\nMS.EXO.09.2: The attachment filter SHOULD attempt to determine the true file type and assess the file extension. Overview The attachment filter SHOULD attempt to determine the true file type and assess the file extension.\nRationale: Users can change a file extension at the end of a file name (e.g., notepad.exe to notepad.txt) to obscure the actual file type. Verifying the file type and checking that this matches the designated file extension can help detect instances where the file extension was changed.\nRemediation action: Sign in to Microsoft 365 Defender. In the left-hand menu, go to Email \u0026 Collaboration \u003e Policies \u0026 Rules. Select Threat Policies. From the Templated policies section, select Preset Security Policies. Under Standard protection, slide the toggle switch to the right so the text next to the toggle reads Standard protection is on. Under Strict protection, slide the toggle switch to the right so the text next to the toggle reads Strict protection is on. Note: If the toggle slider in step 5 is grayed out, click on Manage protection settings instead and configure the policy settings according to Use the Microsoft 365 Defender portal to assign Standard and Strict preset security policies to users | Microsoft Learn.\nRelated links Defender admin center - Preset security policies CISA 9 Attachment File Type - MS.EXO.9.2v1 CISA ScubaGear Rego Reference Microsoft Learn - True type matching in the common attachments filter Test Results Your tenant does not have standard and strict preset security policies enabled.\nPolicy Status Standard ❌ Fail Strict ❌ Fail Policy Name File Filter Enabled Default ✅ Pass Tag: MS.EXO MS.EXO.9.2 CISA Security All\nCategory: CISA SCuBA\nSource: C:\\maester-tests\\cisa\\exchange\\Test-MtCisaAttachmentFileType.Tests.ps1\nMS.EXO.09.3: Disallowed file types SHALL be determined and enforced. Overview The attachment filter SHOULD attempt to determine the true file type and assess the file extension.\nRationale: Users can change a file extension at the end of a file name (e.g., notepad.exe to notepad.txt) to obscure the actual file type. Verifying the file type and checking that this matches the designated file extension can help detect instances where the file extension was changed.\nRemediation action: Sign in to Microsoft 365 Defender. In the left-hand menu, go to Email \u0026 Collaboration \u003e Policies \u0026 Rules. Select Threat Policies. From the Templated policies section, select Preset Security Policies. Under Standard protection, slide the toggle switch to the right so the text next to the toggle reads Standard protection is on. Under Strict protection, slide the toggle switch to the right so the text next to the toggle reads Strict protection is on. Note: If the toggle slider in step 5 is grayed out, click on Manage protection settings instead and configure the policy settings according to Use the Microsoft 365 Defender portal to assign Standard and Strict preset security policies to users | Microsoft Learn.\nRelated links Defender admin center - Preset security policies CISA 9 Attachment File Type - MS.EXO.9.2v1 CISA ScubaGear Rego Reference Microsoft Learn - True type matching in the common attachments filter Test Results Your tenant does not have standard and strict preset security policies enabled.\nPolicy Status Standard ❌ Fail Strict ❌ Fail Policy Name File Filter Enabled Default ✅ Pass Tag: MS.EXO MS.EXO.9.3 CISA Security All\nCategory: CISA SCuBA\nSource: C:\\maester-tests\\cisa\\exchange\\Test-MtCisaBlockFileType.Tests.ps1\nMS.EXO.09.5: At a minimum, click-to-run files SHOULD be blocked (e.g., .exe, .cmd, and .vbe). Overview At a minimum, click-to-run files SHOULD be blocked (e.g., .exe, .cmd, and .vbe).\nRationale: Malicious attachments often take the form of click-to-run files. Blocking a list of common executable files helps mitigate the risk of adversarial exploitation.\nRemediation action: Sign in to Microsoft 365 Defender. In the left-hand menu, go to Email \u0026 Collaboration \u003e Policies \u0026 Rules. Select Threat Policies. From the Templated policies section, select Preset Security Policies. Under Standard protection, slide the toggle switch to the right so the text next to the toggle reads Standard protection is on. Under Strict protection, slide the toggle switch to the right so the text next to the toggle reads Strict protection is on. Note: If the toggle slider in step 5 is grayed out, click on Manage protection settings instead and configure the policy settings according to Use the Microsoft 365 Defender portal to assign Standard and Strict preset security policies to users | Microsoft Learn.\nRelated links Defender admin center - Preset security policies CISA 9 Attachment File Type - MS.EXO.9.5v1 CISA ScubaGear Rego Reference Test Results Your tenant does not have standard and strict preset security policies enabled.\nPolicy Status Standard ❌ Fail Strict ❌ Fail Policy Name File Filter Enabled Extensions Default ✅ Pass cmd, exe, vbe Tag: MS.EXO MS.EXO.9.5 CISA Security All\nCategory: CISA SCuBA\nSource: C:\\maester-tests\\cisa\\exchange\\Test-MtCisaBlockExecutable.Tests.ps1\nMS.EXO.10.1: Emails SHALL be scanned for malware. Overview Emails SHALL be filtered by attachment file types.\nRationale: Malicious attachments often take the form of click-to-run files. Sharing high risk file types, when necessary, is better left to a means other than email; the dangers of allowing them to be sent over email outweigh any potential benefits. Filtering email attachments based on file types can prevent spread of malware distributed via click-to-run email attachments.\nRemediation action: Sign in to Microsoft 365 Defender. In the left-hand menu, go to Email \u0026 Collaboration \u003e Policies \u0026 Rules. Select Threat Policies. From the Templated policies section, select Preset Security Policies. Under Standard protection, slide the toggle switch to the right so the text next to the toggle reads Standard protection is on. Under Strict protection, slide the toggle switch to the right so the text next to the toggle reads Strict protection is on. Note: If the toggle slider in step 5 is grayed out, click on Manage protection settings instead and configure the policy settings according to Use the Microsoft 365 Defender portal to assign Standard and Strict preset security policies to users | Microsoft Learn.\nRelated links Defender admin center - Preset security policies CISA 9 Attachment File Type - MS.EXO.9.1v2 CISA ScubaGear Rego Reference Microsoft Learn - Common attachments filter in anti-malware policies Test Results Your tenant does not have standard and strict preset security policies enabled.\nPolicy Status Standard ❌ Fail Strict ❌ Fail Policy Name File Filter Enabled Extensions Default ✅ Pass ace, apk, app, appx, ani, \u0026 48 others Tag: MS.EXO MS.EXO.10.1 CISA Security All\nCategory: CISA SCuBA\nSource: C:\\maester-tests\\cisa\\exchange\\Test-MtCisaMalwareScan.Tests.ps1\nMS.EXO.10.2: Emails identified as containing malware SHALL be quarantined or dropped. Overview Emails identified as containing malware SHALL be quarantined or dropped.\nRationale: Email can be used as a mechanism for delivering malware. Preventing emails with known malware from reaching user mailboxes helps ensure users cannot interact with those emails.\nRemediation action: Sign in to Microsoft 365 Defender. In the left-hand menu, go to Email \u0026 Collaboration \u003e Policies \u0026 Rules. Select Threat Policies. From the Templated policies section, select Preset Security Policies. Under Standard protection, slide the toggle switch to the right so the text next to the toggle reads Standard protection is on. Under Strict protection, slide the toggle switch to the right so the text next to the toggle reads Strict protection is on. Note: If the toggle slider in step 5 is grayed out, click on Manage protection settings instead and configure the policy settings according to Use the Microsoft 365 Defender portal to assign Standard and Strict preset security policies to users | Microsoft Learn.\nRelated links Defender admin center - Preset security policies CISA 10 Malware Scanning - MS.EXO.10.2v1 CISA ScubaGear Rego Reference Microsoft Learn - Anatomy of a quarantine policy Test Results Your tenant does not have standard and strict preset security policies enabled.\nPolicy Status Standard ❌ Fail Strict ❌ Fail Policy Name Quarantine Tag Result Default AdminOnlyAccessPolicy ✅ Pass Tag: MS.EXO MS.EXO.10.2 CISA Security All\nCategory: CISA SCuBA\nSource: C:\\maester-tests\\cisa\\exchange\\Test-MtCisaMalwareAction.Tests.ps1\nMS.EXO.10.3: Email scanning SHALL be capable of reviewing emails after delivery. Overview Email scanning SHALL be capable of reviewing emails after delivery.\nRationale: As known malware signatures are updated, it is possible for an email to be retroactively identified as containing malware after delivery. By scanning emails, the number of malware-infected in users’ mailboxes can be reduced.\nRemediation action: Sign in to Microsoft 365 Defender. In the left-hand menu, go to Email \u0026 Collaboration \u003e Policies \u0026 Rules. Select Threat Policies. From the Templated policies section, select Preset Security Policies. Under Standard protection, slide the toggle switch to the right so the text next to the toggle reads Standard protection is on. Under Strict protection, slide the toggle switch to the right so the text next to the toggle reads Strict protection is on. Note: If the toggle slider in step 5 is grayed out, click on Manage protection settings instead and configure the policy settings according to Use the Microsoft 365 Defender portal to assign Standard and Strict preset security policies to users | Microsoft Learn.\nRelated links Defender admin center - Preset security policies CISA 10 Malware Scanning - MS.EXO.10.3v1 CISA ScubaGear Rego Reference Microsoft Learn - Zero-hour auto purge (ZAP) for malware Test Results Your tenant does not have standard and strict preset security policies enabled.\nPolicy Status Standard ❌ Fail Strict ❌ Fail Policy Name Result Default ✅ Pass Tag: MS.EXO MS.EXO.10.3 CISA Security All\nCategory: CISA SCuBA\nSource: C:\\maester-tests\\cisa\\exchange\\Test-MtCisaMalwareZap.Tests.ps1\nMS.EXO.11.1: Impersonation protection checks SHOULD be used. Overview Impersonation protection checks SHOULD be used.\nRationale: Users might not be able to reliably identify phishing emails, especially if the FROM address is nearly indistinguishable from that of a known entity. By automatically identifying senders who appear to be impersonating known senders, the risk of a successful phishing attempt can be reduced.\nRemediation action: Sign in to Microsoft 365 Defender. In the left-hand menu, go to Email \u0026 Collaboration \u003e Policies \u0026 Rules. Select Threat Policies. From the Templated policies section, select Preset Security Policies. Under Standard protection, slide the toggle switch to the right so the text next to the toggle reads Standard protection is on. Under Strict protection, slide the toggle switch to the right so the text next to the toggle reads Strict protection is on. Note: If the toggle slider in step 5 is grayed out, click on Manage protection settings instead and configure the policy settings according to Use the Microsoft 365 Defender portal to assign Standard and Strict preset security policies to users | Microsoft Learn.\nRelated links Defender admin center - Preset security policies CISA 11 Phishing Protections - MS.EXO.11.1v1 CISA ScubaGear Rego Reference Microsoft Learn - Impersonation settings in anti-phishing policies in Microsoft Defender for Office 365 Test Results Your tenant does not have standard and strict preset security policies enabled.\nPolicy Status Standard ❌ Fail Strict ❌ Fail Policy Name Result Office365 AntiPhish Default ❌ Fail Tag: MS.EXO MS.EXO.11.1 CISA Security All\nCategory: CISA SCuBA\nSource: C:\\maester-tests\\cisa\\exchange\\Test-MtCisaImpersonation.Tests.ps1\nMS.EXO.11.2: User warnings, comparable to the user safety tips included with EOP, SHOULD be displayed. Overview User warnings, comparable to the user safety tips included with EOP, SHOULD be displayed.\nRationale: Many tasks are better suited for automated processes, such as identifying unusual characters in the FROM address or identifying a first-time sender. User warnings can handle these tasks, reducing the burden on end users and the risk of successful phishing attempts.\nRemediation action: Sign in to Microsoft 365 Defender. In the left-hand menu, go to Email \u0026 Collaboration \u003e Policies \u0026 Rules. Select Threat Policies. From the Templated policies section, select Preset Security Policies. Under Standard protection, slide the toggle switch to the right so the text next to the toggle reads Standard protection is on. Under Strict protection, slide the toggle switch to the right so the text next to the toggle reads Strict protection is on. Note: If the toggle slider in step 5 is grayed out, click on Manage protection settings instead and configure the policy settings according to Use the Microsoft 365 Defender portal to assign Standard and Strict preset security policies to users | Microsoft Learn.\nRelated links Defender admin center - Preset security policies CISA 11 Phishing Protections - MS.EXO.11.2v1 CISA ScubaGear Rego Reference Microsoft Learn - Impersonation settings in anti-phishing policies in Microsoft Defender for Office 365 Test Results Your tenant does not have standard and strict preset security policies enabled.\nPolicy Status Standard ❌ Fail Strict ❌ Fail Policy Name Result Office365 AntiPhish Default ❌ Fail Tag: MS.EXO MS.EXO.11.2 CISA Security All\nCategory: CISA SCuBA\nSource: C:\\maester-tests\\cisa\\exchange\\Test-MtCisaImpersonationTip.Tests.ps1\nMS.EXO.11.3: The phishing protection solution SHOULD include an AI-based phishing detection tool comparable to EOP Mailbox Intelligence. Overview The phishing protection solution SHOULD include an AI-based phishing detection tool comparable to EOP Mailbox Intelligence.\nRationale: Phishing attacks can result in unauthorized data disclosure and unauthorized access. Using AI-based phishing detection tools to improve the detection rate of phishing attempts helps reduce the risk of successful phishing attacks.\nRemediation action: Sign in to Microsoft 365 Defender. In the left-hand menu, go to Email \u0026 Collaboration \u003e Policies \u0026 Rules. Select Threat Policies. From the Templated policies section, select Preset Security Policies. Under Standard protection, slide the toggle switch to the right so the text next to the toggle reads Standard protection is on. Under Strict protection, slide the toggle switch to the right so the text next to the toggle reads Strict protection is on. Note: If the toggle slider in step 5 is grayed out, click on Manage protection settings instead and configure the policy settings according to Use the Microsoft 365 Defender portal to assign Standard and Strict preset security policies to users | Microsoft Learn.\nRelated links Defender admin center - Preset security policies CISA 11 Phishing Protections - MS.EXO.11.3v1 CISA ScubaGear Rego Reference Microsoft Learn - Mailbox intelligence impersonation protection Test Results Your tenant does not have standard and strict preset security policies enabled.\nPolicy Status Standard ❌ Fail Strict ❌ Fail Policy Name Result Office365 AntiPhish Default ❌ Fail Tag: MS.EXO MS.EXO.11.3 CISA Security All\nCategory: CISA SCuBA\nSource: C:\\maester-tests\\cisa\\exchange\\Test-MtCisaMailboxIntelligence.Tests.ps1\nMS.EXO.12.1: IP allow lists SHOULD NOT be created. Overview IP allow lists SHOULD NOT be created.\nRationale: Messages sent from IP addresses on an allow list bypass important security mechanisms, including spam filtering and sender authentication checks. Avoiding use of IP allow lists prevents potential threats from circumventing security mechanisms.\nRemediation action: To modify the connection filters, follow the instructions found in Use the Microsoft 365 Defender portal to modify the default connection filter policy.\nSign in to Microsoft 365 Defender portal. From the left-hand menu, find Email \u0026 collaboration and select Policies and Rules. Select Threat Policies from the list of policy names. Under Policies, select Anti-spam. Select Connection filter policy (Default). Click Edit connection filter policy. Ensure no addresses are specified under Always allow messages from the following IP addresses or address range. Related links Defender admin center - Anti-spam policies CISA 12 IP Allow Lists - MS.EXO.12.1v1 CISA ScubaGear Rego Reference Test Results Well done. Your tenant does not have any Anti-spam IP allow lists.\nTag: MS.EXO MS.EXO.12.1 CISA Security All\nCategory: CISA SCuBA\nSource: C:\\maester-tests\\cisa\\exchange\\Test-MtCisaAntiSpamAllowList.Tests.ps1\nMS.EXO.12.2: Safe lists SHOULD NOT be enabled. Overview Safe lists SHOULD NOT be enabled.\nRationale: Messages sent from allowed safe list addresses bypass important security mechanisms, including spam filtering and sender authentication checks. Avoiding use of safe lists prevents potential threats from circumventing security mechanisms. While blocking all malicious senders is not feasible, blocking specific known, malicious IP addresses may reduce the threat from specific senders.\nRemediation action: To modify the connection filters, follow the instructions found in Use the Microsoft 365 Defender portal to modify the default connection filter policy.\nSign in to Microsoft 365 Defender portal. From the left-hand menu, find Email \u0026 collaboration and select Policies and Rules. Select Threat Policies from the list of policy names. Under Policies, select Anti-spam. Select Connection filter policy (Default). Click Edit connection filter policy. Ensure Turn on safe list is not selected. Related links Defender admin center - Anti-spam policies CISA 12 IP Allow Lists - MS.EXO.12.2v1 CISA ScubaGear Rego Reference Test Results Well done. Safe List is disabled in your tenant.\nTag: MS.EXO MS.EXO.12.2 CISA Security All\nCategory: CISA SCuBA\nSource: C:\\maester-tests\\cisa\\exchange\\Test-MtCisaAntiSpamSafeList.Tests.ps1\nMS.EXO.13.1: Mailbox auditing SHALL be enabled. Overview Mailbox auditing SHALL be enabled.\nRationale: Exchange Online user accounts can be compromised or misused. Enabling mailbox auditing provides a valuable source of information to detect and respond to mailbox misuse.\nRemediation action: Mailbox auditing can be managed from the Exchange Online PowerShell module. Follow the instructions listed on Manage mailbox auditing in Office 365.\nTo enable mailbox auditing by default for your organization via PowerShell: Connect to the Exchange Online PowerShell. Run the following command: Set-OrganizationConfig –AuditDisabled $false Related links Microsoft Learn - Mailbox Auditing CISA 13 Mailbox Auditing - MS.EXO.13.1v1 CISA ScubaGear Rego Reference Test Results Well done. Your tenant has mailbox auditing enabled.\n✅ Pass\nTag: MS.EXO MS.EXO.13.1 CISA Security All\nCategory: CISA SCuBA\nSource: C:\\maester-tests\\cisa\\exchange\\Test-MtCisaMailboxAuditing.Tests.ps1\nMS.EXO.14.1: A spam filter SHALL be enabled. Overview A spam filter SHALL be enabled.\nRationale: Spam is a constant threat as junk mail can reduce user productivity, fill up mailboxes unnecessarily, and in some cases include malicious links or attachments. Filtering out spam reduces user workload burden, prevents junk mail congestion, and reduces potentially malicious content exposure.\nRemediation action: Sign in to Microsoft 365 Defender. In the left-hand menu, go to Email \u0026 Collaboration \u003e Policies \u0026 Rules. Select Threat Policies. From the Templated policies section, select Preset Security Policies. Under Standard protection, slide the toggle switch to the right so the text next to the toggle reads Standard protection is on. Under Strict protection, slide the toggle switch to the right so the text next to the toggle reads Strict protection is on. Note: If the toggle slider in step 5 is grayed out, click on Manage protection settings instead and configure the policy settings according to Use the Microsoft 365 Defender portal to assign Standard and Strict preset security policies to users | Microsoft Learn.\nRelated links Defender admin center - Preset security policies CISA 14 Inbound Anti-Spam Protections - MS.EXO.14.1 CISA ScubaGear Rego Reference Test Results Your tenant does not have standard and strict preset security policies.\nPolicy Status Standard ❌ Fail Strict ❌ Fail Policy Name Spam Action High Confidence Spam Action Bulk Spam Action Phish Spam Action Default MoveToJmf MoveToJmf MoveToJmf MoveToJmf Tag: MS.EXO MS.EXO.14.1 CISA Security All\nCategory: CISA SCuBA\nSource: C:\\maester-tests\\cisa\\exchange\\Test-MtCisaSpamFilter.Tests.ps1\nMS.EXO.14.2: Spam and high confidence spam SHALL be moved to either the junk email folder or the quarantine folder. Overview Spam and high confidence spam SHALL be moved to either the junk email folder or the quarantine folder.\nRationale: Spam is a constant threat as junk mail can reduce user productivity, fill up mailboxes unnecessarily, and in some cases include malicious links or attachments. Moving spam messages to a separate junk or quarantine folder helps users filter out spam while still giving them the ability to review messages, as needed, in case a message is filtered incorrectly.\nRemediation action: Sign in to Microsoft 365 Defender. In the left-hand menu, go to Email \u0026 Collaboration \u003e Policies \u0026 Rules. Select Threat Policies. From the Templated policies section, select Preset Security Policies. Under Standard protection, slide the toggle switch to the right so the text next to the toggle reads Standard protection is on. Under Strict protection, slide the toggle switch to the right so the text next to the toggle reads Strict protection is on. Note: If the toggle slider in step 5 is grayed out, click on Manage protection settings instead and configure the policy settings according to Use the Microsoft 365 Defender portal to assign Standard and Strict preset security policies to users | Microsoft Learn.\nRelated links Defender admin center - Preset security policies CISA 14 Inbound Anti-Spam Protections - MS.EXO.14.2 CISA ScubaGear Rego Reference Test Results Your tenant does not have standard and strict preset security policies.\nPolicy Status Standard ❌ Fail Strict ❌ Fail Policy Name Spam Action High Confidence Spam Action Default ✅ Pass ✅ Pass Tag: MS.EXO MS.EXO.14.2 CISA Security All\nCategory: CISA SCuBA\nSource: C:\\maester-tests\\cisa\\exchange\\Test-MtCisaSpamAction.Tests.ps1\nMS.EXO.14.3: Allowed domains SHALL NOT be added to inbound anti-spam protection policies. Overview Allowed domains SHALL NOT be added to inbound anti-spam protection policies.\nRationale: Legitimate emails may be incorrectly filtered by spam protections. Adding allowed senders is an acceptable method of combating these false positives. Allowing an entire domain, especially a common domain like office.com, however, provides for a large number of potentially unknown users to bypass spam protections.\nRemediation action: Sign in to Microsoft 365 Defender. In the left-hand menu, go to Email \u0026 Collaboration \u003e Policies \u0026 Rules. Select Threat Policies. From the Templated policies section, select Preset Security Policies. Under Standard protection, slide the toggle switch to the right so the text next to the toggle reads Standard protection is on. Under Strict protection, slide the toggle switch to the right so the text next to the toggle reads Strict protection is on. Note: If the toggle slider in step 5 is grayed out, click on Manage protection settings instead and configure the policy settings according to Use the Microsoft 365 Defender portal to assign Standard and Strict preset security policies to users | Microsoft Learn.\nRelated links Defender admin center - Preset security policies CISA 14 Inbound Anti-Spam Protections - MS.EXO.14.3 CISA ScubaGear Rego Reference Test Results Your tenant does not have standard and strict preset security policies.\nPolicy Status Standard ❌ Fail Strict ❌ Fail Policy Name Policy Result Allowed Domains Default ✅ Pass Tag: MS.EXO MS.EXO.14.3 CISA Security All\nCategory: CISA SCuBA\nSource: C:\\maester-tests\\cisa\\exchange\\Test-MtCisaSpamBypass.Tests.ps1\nMS.EXO.15.1: URL comparison with a block-list SHOULD be enabled. Overview URL comparison with a block-list SHOULD be enabled.\nRationale: Users may be directed to malicious websites via links in email. Blocking access to known, malicious URLs can prevent users from accessing known malicious websites.\nRemediation action: Sign in to Microsoft 365 Defender. In the left-hand menu, go to Email \u0026 Collaboration \u003e Policies \u0026 Rules. Select Threat Policies. From the Templated policies section, select Preset Security Policies. Under either Standard protection or Strict protection, select Manage protection settings. Select Next until you reach the Apply Defender for Office 365 protection page. On the Apply Defender for Office 365 protection page, select All recipients. (Optional) Under Exclude these recipients, add Users and Groups to be exempted from the preset policies. Select Next on each page until the Review and confirm your changes page. On the Review and confirm your changes page, select Confirm. Related links Defender admin center - Preset security policies CISA 15 Link Protection - MS.EXO.15.1 CISA ScubaGear Rego Reference Test Results Your tenant does not have standard and strict preset security policies.\nPolicy Status Standard ❌ Fail Strict ❌ Fail Policy Name Policy Result Built-In Protection Policy ✅ Pass Tag: MS.EXO MS.EXO.15.1 CISA Security All\nCategory: CISA SCuBA\nSource: C:\\maester-tests\\cisa\\exchange\\Test-MtCisaSafeLink.Tests.ps1\nMS.EXO.15.2: Direct download links SHOULD be scanned for malware. Overview Direct download links SHOULD be scanned for malware.\nRationale: URLs in emails may direct users to download and run malware. Scanning direct download links in real-time for known malware and blocking access can prevent users from infecting their devices.\nRemediation action: Sign in to Microsoft 365 Defender. In the left-hand menu, go to Email \u0026 Collaboration \u003e Policies \u0026 Rules. Select Threat Policies. From the Templated policies section, select Preset Security Policies. Under either Standard protection or Strict protection, select Manage protection settings. Select Next until you reach the Apply Defender for Office 365 protection page. On the Apply Defender for Office 365 protection page, select All recipients. (Optional) Under Exclude these recipients, add Users and Groups to be exempted from the preset policies. Select Next on each page until the Review and confirm your changes page. On the Review and confirm your changes page, select Confirm. Related links Defender admin center - Preset security policies CISA 15 Link Protection - MS.EXO.15.2 CISA ScubaGear Rego Reference Test Results Your tenant does not have standard and strict preset security policies.\nPolicy Status Standard ❌ Fail Strict ❌ Fail Policy Name Policy Result Built-In Protection Policy ✅ Pass Tag: MS.EXO MS.EXO.15.2 CISA Security All\nCategory: CISA SCuBA\nSource: C:\\maester-tests\\cisa\\exchange\\Test-MtCisaSafeLinkDownloadScan.Tests.ps1\nMS.EXO.15.3: User click tracking SHOULD be enabled. Overview User click tracking SHOULD be enabled.\nRationale: Users may click on malicious links in emails, leading to compromise or unauthorized data disclosure. Enabling user click tracking lets agencies know if a malicious link may have been visited after the fact to help tailor a response to a potential incident.\nRemediation action: Sign in to Microsoft 365 Defender. In the left-hand menu, go to Email \u0026 Collaboration \u003e Policies \u0026 Rules. Select Threat Policies. From the Templated policies section, select Preset Security Policies. Under either Standard protection or Strict protection, select Manage protection settings. Select Next until you reach the Apply Defender for Office 365 protection page. On the Apply Defender for Office 365 protection page, select All recipients. (Optional) Under Exclude these recipients, add Users and Groups to be exempted from the preset policies. Select Next on each page until the Review and confirm your changes page. On the Review and confirm your changes page, select Confirm. Related links Defender admin center - Preset security policies CISA 15 Link Protection - MS.EXO.15.3 CISA ScubaGear Rego Reference Test Results Your tenant does not have standard and strict preset security policies.\nPolicy Status Standard ❌ Fail Strict ❌ Fail Policy Name Policy Result Built-In Protection Policy ✅ Pass Tag: MS.EXO MS.EXO.15.3 CISA Security All\nCategory: CISA SCuBA\nSource: C:\\maester-tests\\cisa\\exchange\\Test-MtCisaSafeLinkClickTracking.Tests.ps1\nMS.EXO.16.1: Alerts SHALL be enabled. Overview At a minimum, the following alerts SHALL be enabled: a. Suspicious email sending patterns detected. b. Suspicious Connector Activity. c. Suspicious Email Forwarding Activity. d. Messages have been delayed. e. Tenant restricted from sending unprovisioned email. f. Tenant restricted from sending email. g. A potentially malicious URL click was detected.\nRationale: Potentially malicious or service impacting events may go undetected without a means of detecting these events. Setting up a mechanism to alert administrators to events listed above draws attention to them to help minimize impact to users and the agency.\nRemediation action: Sign in to Microsoft 365 Defender. Under Email \u0026 collaboration, select Policies \u0026 rules. Select (Alert Policy)[https://security.microsoft.com/alertpoliciesv2]. Select the checkbox next to each alert to enable as determined by the agency and at a minimum those referenced in the CISA M365 Security Configuration Baseline for Exchange Online which are: a. Suspicious email sending patterns detected. b. Suspicious connector activity. c. Suspicious Email Forwarding Activity. d. Messages have been delayed. e. Tenant restricted from sending unprovisioned email. f. Tenant restricted from sending email. g. A potentially malicious URL click was detected. Click the pencil icon from the top menu. Select the Enable selected policies action from the Bulk actions menu. Related links Defender admin center - Alert policy CISA 16 Alerts - MS.EXO.16.1 CISA ScubaGear Rego Reference Test Results Well done. Your tenant has alerts configured.\nAlert Name Alert Result FFO.extest.microsoft.com/Microsoft Exchange Hosted Organizations/f00ed340-8f84-4eb4-83f3-0075a22b262e/Configuration/A potentially malicious URL click was detected ✅ Pass FFO.extest.microsoft.com/Microsoft Exchange Hosted Organizations/f00ed340-8f84-4eb4-83f3-0075a22b262e/Configuration/Messages have been delayed ✅ Pass FFO.extest.microsoft.com/Microsoft Exchange Hosted Organizations/f00ed340-8f84-4eb4-83f3-0075a22b262e/Configuration/Suspicious connector activity ✅ Pass FFO.extest.microsoft.com/Microsoft Exchange Hosted Organizations/f00ed340-8f84-4eb4-83f3-0075a22b262e/Configuration/Suspicious Email Forwarding Activity ✅ Pass FFO.extest.microsoft.com/Microsoft Exchange Hosted Organizations/f00ed340-8f84-4eb4-83f3-0075a22b262e/Configuration/Suspicious email sending patterns detected ✅ Pass FFO.extest.microsoft.com/Microsoft Exchange Hosted Organizations/f00ed340-8f84-4eb4-83f3-0075a22b262e/Configuration/Tenant restricted from sending email ✅ Pass FFO.extest.microsoft.com/Microsoft Exchange Hosted Organizations/f00ed340-8f84-4eb4-83f3-0075a22b262e/Configuration/Tenant restricted from sending unprovisioned email ✅ Pass Tag: MS.EXO MS.EXO.16.1 CISA Security All\nCategory: CISA SCuBA\nSource: C:\\maester-tests\\cisa\\exchange\\Test-MtCisaExoAlert.Tests.ps1\nMS.EXO.17.1: Microsoft Purview Audit (Standard) logging SHALL be enabled. Overview Microsoft Purview Audit (Standard) logging SHALL be enabled.\nRationale: Responding to incidents without detailed information about activities that took place slows response actions. Enabling Microsoft Purview Audit (Standard) helps ensure agencies have visibility into user actions. Furthermore, Microsoft Purview Audit (Standard) is required for government agencies by OMB M-21-31 (referred to therein by its former name, Unified Audit Logs).\nRemediation action: To enable auditing via the Microsoft Purview compliance portal:\nSign in to the Microsoft Purview compliance portal. Under Solutions, select Audit. If auditing is not enabled, a banner is displayed to notify the administrator to start recording user and admin activity. Click the Start recording user and admin activity. Related links Purview portal - Audit search CISA 17 Audit Logging - MS.EXO.17.1 CISA ScubaGear Rego Reference Test Results Your tenant does not have unified audit log enabled.\n%TestResult%\nTag: MS.EXO MS.EXO.17.1 CISA Security All\nCategory: CISA SCuBA\nSource: C:\\maester-tests\\cisa\\exchange\\Test-MtCisaAuditLog.Tests.ps1\nMS.EXO.17.2: Microsoft Purview Audit (Premium) logging SHALL be enabled. Overview Microsoft Purview Audit (Premium) logging SHALL be enabled.\nRationale: Standard logging may not include relevant details necessary for visibility into user actions during an incident. Enabling Microsoft Purview Audit (Premium) captures additional event types not included with Standard. Furthermore, it is required for government agencies by OMB M-21-13 (referred to therein by its former name, Unified Audit Logs w/Advanced Features).\nRemediation action: To set up Microsoft Purview Audit (Premium), see Set up Microsoft Purview Audit (Premium) | Microsoft Learn.\nRelated links Purview portal - Audit search CISA 17 Audit Logging - MS.EXO.17.2 CISA ScubaGear Rego Reference Test Results Well done. Your tenant has SearchQueryInitiated audit log enabled.\nMailbox SearchQueryInitiated AdeleV@vxcnx.onmicrosoft.com ❌ Fail admin-alitis01@vxcnx.onmicrosoft.com ❌ Fail AlexW@vxcnx.onmicrosoft.com ❌ Fail alIT@alit.is ❌ Fail bensi@alit.is ❌ Fail DiegoS@vxcnx.onmicrosoft.com ❌ Fail DiscoverySearchMailbox{D919BA05-46A6-415f-80AD-7E09334BB852}@vxcnx.onmicrosoft.com ❌ Fail GradyA@vxcnx.onmicrosoft.com ❌ Fail hbh@alit.is ❌ Fail HenriettaM@vxcnx.onmicrosoft.com ❌ Fail IsaiahL@vxcnx.onmicrosoft.com ❌ Fail JohannaL@vxcnx.onmicrosoft.com ❌ Fail JoniS@vxcnx.onmicrosoft.com ❌ Fail LeeG@vxcnx.onmicrosoft.com ❌ Fail LidiaH@vxcnx.onmicrosoft.com ❌ Fail LynneR@vxcnx.onmicrosoft.com ❌ Fail MeganB@vxcnx.onmicrosoft.com ❌ Fail MiriamG@vxcnx.onmicrosoft.com ❌ Fail NestorW@vxcnx.onmicrosoft.com ❌ Fail PattiF@vxcnx.onmicrosoft.com ❌ Fail PradeepG@vxcnx.onmicrosoft.com ❌ Fail Tag: MS.EXO MS.EXO.17.2 CISA Security All\nCategory: CISA SCuBA\nSource: C:\\maester-tests\\cisa\\exchange\\Test-MtCisaAuditLogPremium.Tests.ps1\nMS.EXO.17.3: Audit logs SHALL be maintained for at least the minimum duration dictated by OMB M-21-31 (Appendix C). Overview Audit logs SHALL be maintained for at least the minimum duration dictated by OMB M-21-31 (Appendix C).\nRationale: Audit logs may no longer be available when needed if they are not retained for a sufficient time. Increased log retention time gives an agency the necessary visibility to investigate incidents that occurred some time ago. OMB M-21-13, Appendix C, Table 5 specifically calls out Unified Audit Logs in the Cloud Azure log category.\nRemediation action: To create one or more custom audit retention policies, if the default retention policy is not sufficient for agency needs, follow Create an audit log retention policy instructions. Ensure the duration selected in the retention policies is at least one year, in accordance with OMB M-21-31.\nRelated links Purview portal - Audit policies CISA 17 Audit Logging - MS.EXO.17.3 CISA ScubaGear Rego Reference Test Results Your tenant does not have Exchange Online audit retention enabled.\nPolicy Result Policy Name Record Types Retention Duration Tag: MS.EXO MS.EXO.17.3 CISA Security All\nCategory: CISA SCuBA\nSource: C:\\maester-tests\\cisa\\exchange\\Test-MtCisaAuditLogRetention.Tests.ps1\nMS.SHAREPOINT.1.1: External sharing for SharePoint SHALL be limited to Existing guests or Only People in your organization. Overview External sharing for SharePoint SHALL be limited to Existing guests or Only People in your organization.\nRationale: Sharing information outside the organization via SharePoint increases the risk of unauthorized access. By limiting external sharing, administrators decrease the risk of access to information.\nRemediation action: Sign in to the SharePoint admin center. Select Policies \u003e Sharing. Adjust external sharing slider for SharePoint to Existing guests or Only people in your organization. ⚠️ WARNING: This will break existing sharing.\nSelect Save. Related links CISA 1 External Sharing - MS.SHAREPOINT.1.1v1 CISA ScubaGear Rego Reference Test Results Your tenant does not restrict SharePoint Online sharing.\nexternalUserAndGuestSharing Tag: MS.SHAREPOINT MS.SHAREPOINT.1.1 CISA Security All\nCategory: CISA SCuBA\nSource: C:\\maester-tests\\cisa\\spo\\Test-MtCisaSpoSharing.Tests.ps1\nMS.SHAREPOINT.1.3: External sharing SHALL be restricted to approved external domains and/or users in approved security groups per interagency collaboration needs. Overview External sharing SHALL be restricted to approved external domains and/or users in approved security groups per interagency collaboration needs.\nRationale: By limiting sharing to domains or approved security groups used for interagency collaboration purposes, administrators help prevent sharing with unknown organizations and individuals.\nRemediation action: This policy is only applicable if the external sharing slider on the admin page is set to any value other than Only People in your organization.\nSign in to the SharePoint admin center. Select Policies \u003e Sharing. Expand More external sharing settings. Select Limit external sharing by domain. Select Add domains. Add each approved external domain users are allowed to share files with. Select Manage security groups Add each approved security group. Members of these groups will be allowed to share files externally. Select Save. Related links CISA 1 External Sharing - MS.SHAREPOINT.1.3v1 CISA ScubaGear Rego Reference Test Results Your tenant does not restrict SharePoint Online sharing to specific domains.\nTag: MS.SHAREPOINT MS.SHAREPOINT.1.3 CISA Security All\nCategory: CISA SCuBA\nSource: C:\\maester-tests\\cisa\\spo\\Test-MtCisaSpoSharingAllowedDomain.Tests.ps1\nMT.1001: At least one Conditional Access policy is configured with device compliance. Overview It is recommended to have at least one conditional access policy that enforces the use of a compliant device.\nSee Require a compliant device, Microsoft Entra hybrid joined device, or MFA - Microsoft Learn\nTest Results There was no conditional access policy requiring device compliance.\nLearn more: https://maester.dev/docs/tests/MT.1001\nTag: Maester CA Security All MT.1001\nCategory: Conditional Access Baseline Policies\nSource: C:\\maester-tests\\Maester\\Entra\\Test-ConditionalAccessBaseline.Tests.ps1\nMT.1003: At least one Conditional Access policy is configured with All Apps. Overview Microsoft recommends creating at least one conditional access policy targetting all cloud apps and ideally all users.\nSee Plan a Conditional Access deployment - Microsoft Learn\nTest Results There was no conditional access policy targeting all cloud apps.\nLearn more: https://maester.dev/docs/tests/MT.1003\nTag: Maester CA Security All MT.1003\nCategory: Conditional Access Baseline Policies\nSource: C:\\maester-tests\\Maester\\Entra\\Test-ConditionalAccessBaseline.Tests.ps1\nMT.1004: At least one Conditional Access policy is configured with All Apps and All Users. Overview Microsoft recommends creating at least one conditional access policy targetting all cloud apps and ideally all users.\nSee Plan a Conditional Access deployment - Microsoft Learn\nTest Results There was no conditional access policy targeting all cloud apps and all users.\nLearn more: https://maester.dev/docs/tests/MT.1004\nTag: Maester CA Security All MT.1004\nCategory: Conditional Access Baseline Policies\nSource: C:\\maester-tests\\Maester\\Entra\\Test-ConditionalAccessBaseline.Tests.ps1\nMT.1005: All Conditional Access policies are configured to exclude at least one emergency/break glass account or group. Overview It is recommended to have at least one emergency/break glass account or account group excluded from all conditional access policies. This allows for emergency access to the tenant in case of a misconfiguration or other issues.\nSee Manage emergency access accounts in Microsoft Entra ID - Microsoft Learn\nTest Results These conditional access policies don’t have the emergency access excluded:\n%TestResult%\nLearn more: https://maester.dev/docs/tests/MT.1005\nTag: Maester CA Security All MT.1005\nCategory: Conditional Access Baseline Policies\nSource: C:\\maester-tests\\Maester\\Entra\\Test-ConditionalAccessBaseline.Tests.ps1\nMT.1006: At least one Conditional Access policy is configured to require MFA for admins. Overview This test checks if the tenant has at least one conditional access policy requiring MFA for admins. The following roles are considered as admin roles:\nGlobal Administrator Application Administrator Authentication Administrator Billing Administrator Cloud Application Administrator Conditional Access Administrator Exchange Administrator Helpdesk Administrator Password Administrator Privileged Authentication Administrator Privileged Role Administrator Security Administrator SharePoint Administrator User Administrator See Require MFA for administrators - Microsoft Learn\"\nTest Results No conditional access policy requires multi-factor authentication for all admin roles.\nLearn more: https://maester.dev/docs/tests/MT.1006\nTag: Maester CA Security All MT.1006\nCategory: Conditional Access Baseline Policies\nSource: C:\\maester-tests\\Maester\\Entra\\Test-ConditionalAccessBaseline.Tests.ps1\nMT.1007: At least one Conditional Access policy is configured to require MFA for all users. Overview This test checks if the tenant has at least one conditional access policy requiring MFA for all users.\nSee Require MFA for all users - Microsoft Learn\nTest Results No conditional access policy requires multi-factor authentication for all users.\nLearn more: https://maester.dev/docs/tests/MT.1007\nTag: Maester CA Security All MT.1007\nCategory: Conditional Access Baseline Policies\nSource: C:\\maester-tests\\Maester\\Entra\\Test-ConditionalAccessBaseline.Tests.ps1\nMT.1008: At least one Conditional Access policy is configured to require MFA for Azure management. Overview Test-MtCaMfaForAdminManagement | Should -Be $true -Because “there is no policy that requires MFA for Azure management”\nReason for failure Expected $true, because there is no policy that requires MFA for Azure management, but got $false.\nLearn more: https://maester.dev/docs/tests/MT.1008\nTag: Maester CA Security All MT.1008\nCategory: Conditional Access Baseline Policies\nSource: C:\\maester-tests\\Maester\\Entra\\Test-ConditionalAccessBaseline.Tests.ps1\nMT.1009: At least one Conditional Access policy is configured to block other legacy authentication. Overview Legacy authentication is an unsecure method to authenticate. This function checks if the tenant has at least one conditional access policy that blocks legacy authentication.\nSee Block legacy authentication - Microsoft Learn\nTest Results There was no conditional access policy blocking legacy authentication for other clients.\nLearn more: https://maester.dev/docs/tests/MT.1009\nTag: Maester CA Security All MT.1009\nCategory: Conditional Access Baseline Policies\nSource: C:\\maester-tests\\Maester\\Entra\\Test-ConditionalAccessBaseline.Tests.ps1\nMT.1010: At least one Conditional Access policy is configured to block legacy authentication for Exchange ActiveSync. Overview Legacy authentication is an unsecure method to authenticate. This function checks if the tenant has at least one conditional access policy that blocks legacy authentication.\nSee Block legacy authentication - Microsoft Learn\nTest Results There was no conditional access policy blocking legacy authentication for Exchange Active Sync.\nLearn more: https://maester.dev/docs/tests/MT.1010\nTag: Maester CA Security All MT.1010\nCategory: Conditional Access Baseline Policies\nSource: C:\\maester-tests\\Maester\\Entra\\Test-ConditionalAccessBaseline.Tests.ps1\nMT.1011: At least one Conditional Access policy is configured to secure security info registration only from a trusted location. Overview Checks if the tenant has at least one conditional access policy securing security info registration.\nSee Securing security info registration - Microsoft Learn\nTest Results No conditional access policy securing security info registration.\nLearn more: https://maester.dev/docs/tests/MT.1011\nTag: Maester CA Security All MT.1011\nCategory: Conditional Access Baseline Policies\nSource: C:\\maester-tests\\Maester\\Entra\\Test-ConditionalAccessBaseline.Tests.ps1\nMT.1012: At least one Conditional Access policy is configured to require MFA for risky sign-ins. Overview Checks if the tenant has at least one conditional access policy requiring multifactor authentication for risky sign-ins.\nSee Sign-in risk-based multifactor authentication - Microsoft Learn\nTest Results No conditional access policy requires multi-factor authentication for risky sign-ins.\nLearn more: https://maester.dev/docs/tests/MT.1012\nTag: Maester CA Security All MT.1012\nCategory: Conditional Access Baseline Policies\nSource: C:\\maester-tests\\Maester\\Entra\\Test-ConditionalAccessBaseline.Tests.ps1\nMT.1013: At least one Conditional Access policy is configured to require new password when user risk is high. Overview Checks if the tenant has at least one conditional access policy requiring password change for high user risk.\nSee User risk-based password change - Microsoft Learn\nTest Results No conditional access policy requires a password change for risky users.\nLearn more: https://maester.dev/docs/tests/MT.1013\nTag: Maester CA Security All MT.1013\nCategory: Conditional Access Baseline Policies\nSource: C:\\maester-tests\\Maester\\Entra\\Test-ConditionalAccessBaseline.Tests.ps1\nMT.1014: At least one Conditional Access policy is configured to require compliant or Entra hybrid joined devices for admins. Overview Microsoft recommends requiring device compliance for administrators that are members of the following roles:\nGlobal administrator Application administrator Authentication Administrator Billing administrator Cloud application administrator Conditional Access administrator Exchange administrator Helpdesk administrator Password administrator Privileged authentication administrator Privileged Role Administrator Security administrator SharePoint administrator User administrator See Require compliant or Microsoft Entra hybrid joined device for administrators - Microsoft Learn\nTest Results There was no conditional access policy requiring compliant or Microsoft Entra hybrid joined device for administrators.\nLearn more: https://maester.dev/docs/tests/MT.1014\nTag: Maester CA Security All MT.1014\nCategory: Conditional Access Baseline Policies\nSource: C:\\maester-tests\\Maester\\Entra\\Test-ConditionalAccessBaseline.Tests.ps1\nMT.1015: At least one Conditional Access policy is configured to block access for unknown or unsupported device platforms. Overview Microsoft recommends blocking access for unknown or unsupported device platforms.\nSee Block access for unknown or unsupported device platform - Microsoft Learn\nTest Results There was no conditional access policy blocking access for unknown or unsupported device platforms.\nLearn more: https://maester.dev/docs/tests/MT.1015\nTag: Maester CA Security All MT.1015\nCategory: Conditional Access Baseline Policies\nSource: C:\\maester-tests\\Maester\\Entra\\Test-ConditionalAccessBaseline.Tests.ps1\nMT.1016: At least one Conditional Access policy is configured to require MFA for guest access. Overview This check verifies if there is at least one conditional access policy that requires multifactor authentication for all guest accounts.\nSee Require multifactor authentication for guest access - Microsoft Learn\nTest Results No conditional access policy requires multi-factor authentication for guest accounts.\nLearn more: https://maester.dev/docs/tests/MT.1016\nTag: Maester CA Security All MT.1016\nCategory: Conditional Access Baseline Policies\nSource: C:\\maester-tests\\Maester\\Entra\\Test-ConditionalAccessBaseline.Tests.ps1\nMT.1017: At least one Conditional Access policy is configured to enforce non persistent browser session for non-corporate devices. Overview Microsoft recommends disabling browser persistence for users accessing the tenant from a unmanaged device.\nSee Require reauthentication and disable browser persistence - Microsoft Learn\nTest Results There was no conditional access policy enforcing non persistent browser session for non-corporate devices.\nLearn more: https://maester.dev/docs/tests/MT.1017\nTag: Maester CA Security All MT.1017\nCategory: Conditional Access Baseline Policies\nSource: C:\\maester-tests\\Maester\\Entra\\Test-ConditionalAccessBaseline.Tests.ps1\nMT.1018: At least one Conditional Access policy is configured to enforce sign-in frequency for non-corporate devices. Overview Microsoft recommends disabling browser persistence for users accessing the tenant from a unmanaged device.\nSee Require reauthentication and disable browser persistence - Microsoft Learn\nTest Results There was no conditional access policy enforcing sign-in frequency for non-corporate devices.\nLearn more: https://maester.dev/docs/tests/MT.1018\nTag: Maester CA Security All MT.1018\nCategory: Conditional Access Baseline Policies\nSource: C:\\maester-tests\\Maester\\Entra\\Test-ConditionalAccessBaseline.Tests.ps1\nMT.1019: At least one Conditional Access policy is configured to enable application enforced restrictions. Overview Test-MtCaApplicationEnforcedRestriction | Should -Be $true -Because “there is no policy that enables application enforced restrictions”\nReason for failure Expected $true, because there is no policy that enables application enforced restrictions, but got $false.\nLearn more: https://maester.dev/docs/tests/MT.1019\nTag: Maester CA Security All MT.1019\nCategory: Conditional Access Baseline Policies\nSource: C:\\maester-tests\\Maester\\Entra\\Test-ConditionalAccessBaseline.Tests.ps1\nMT.1020: All Conditional Access policies are configured to exclude directory synchronization accounts or do not scope them. Overview It is recommended to exclude directory synchronization accounts from all conditional access policies scoped to all cloud apps.\nTest Results All conditional access policies scoped to all cloud apps exclude the directory synchronization accounts.\nLearn more: https://maester.dev/docs/tests/MT.1020\nTag: Maester CA Security All MT.1020\nCategory: Conditional Access Baseline Policies\nSource: C:\\maester-tests\\Maester\\Entra\\Test-ConditionalAccessBaseline.Tests.ps1\nMT.1022: All users utilizing a P1 license should be licensed. Overview This test checks the utilization of Entra ID P1 licenses in the tenant.\nTest Results Total users entitled for Entra ID P1: 23\nTotal P1 licenses utilized: 0\nLearn more: https://maester.dev/docs/tests/MT.1022\nTag: LicenseUtilization MT.1022\nCategory: License utilization\nSource: C:\\maester-tests\\Maester\\Entra\\Test-ConditionalAccessBaseline.Tests.ps1\nMT.1023: All users utilizing a P2 license should be licensed. Overview This test checks the utilization of Entra ID P2 licenses in the tenant.\nTest Results Total users entitled for Entra ID P2: 23\nTotal P2 licenses utilized: 0\nLearn more: https://maester.dev/docs/tests/MT.1023\nTag: LicenseUtilization MT.1023\nCategory: License utilization\nSource: C:\\maester-tests\\Maester\\Entra\\Test-ConditionalAccessBaseline.Tests.ps1\nMT.1024: Entra Recommendation - Remove unused applications. Overview Removing unused applications helps reduce the attack surface area and helps declutter the app portfolio of a tenant.\nTest Results This recommendation will surface if your tenant has applications that have not been used for over 90 days. Applications that were created but never used, client applications which have not been issued a token or resource apps that have not been a target of a token request, will show under this recommendation.\nIf the recommendation is not applicable for your tenant, it can be marked as Dismissed for Maester to skip it in the future.\n➡️ Open Recommendation - Remove unused applications in the Entra admin portal.\nImpacted resources Status Name First detected ❌ Fail AdminDroid Service Application 09/14/2024 10:00:41 ❌ Fail Maester DevOps Account 12/01/2024 10:03:11 ❌ Fail Onboarding 01/06/2025 10:03:15 ❌ Fail demo-vpn 02/02/2025 10:00:55 ❌ Fail smtp-mail 02/04/2025 10:00:59 ❌ Fail SPSitesSelected 08/30/2024 10:01:26 ❌ Fail azure-cli-2024-03-12-12-48-34 08/30/2024 10:01:26 ❌ Fail bensi0279-alit.is-9015be5c-193f-4aea-8a9f-abee625826df 08/30/2024 10:01:26 ❌ Fail statictest 08/30/2024 10:01:26 ❌ Fail Portals-alit 08/30/2024 10:01:26 ❌ Fail WindowsAdminCenter-https://wac01.bge.internal 08/30/2024 10:01:26 ❌ Fail spn-azure-bicep-github 08/30/2024 10:01:26 ❌ Fail Alit-GraphAPI 08/30/2024 10:01:26 ❌ Fail WindowsAdminCenter-https://git-worker-01 08/30/2024 10:01:26 Remediation actions: From the Impacted resources table, select More details to identify the impacted resources..\nSelect the Resource link to go directly to the associated App registration page..\nDetermine if the identified application is needed based on the application usage scenario. For example, an application could have usage gaps due to being deprecated or intentional long intermittent use through the year. .\nIf the application is no longer needed, remove it from your tenant by first soft deleting it, wait 15 days, and then remove it permanently. Find more details on how to soft or permanently delete applications, see How to: Restore or remove a recently deleted application with the Microsoft identity platform.\nIf the application is needed, you have the option to update the status of the recommendation for that application as Dismissed or Postponed. For more information, see How to update a recommendation..\nFor more information, see Recommendation to remove unused apps..\nLearn more: https://maester.dev/docs/tests/MT.1024\nTag: Maester Entra Security All Recommendation MT.1024 staleApps\nCategory: Entra Recommendations\nSource: C:\\maester-tests\\Maester\\Entra\\Test-EntraRecommendations.Tests.ps1\nMT.1024: Entra Recommendation - Remove unused credentials from applications. Overview Removing unused application credentials helps reduce the attack surface area and helps declutter the app portfolio of a tenant.\nTest Results Your tenant has applications with credentials which have not been used in more than 30 days.\nIf the recommendation is not applicable for your tenant, it can be marked as Dismissed for Maester to skip it in the future.\n➡️ Open Recommendation - Remove unused credentials from applications in the Entra admin portal.\nImpacted resources Status Name First detected ❌ Fail P2P Server 10/28/2024 10:01:43 Remediation actions: From the ‘Impacted resources’ table, select ‘More details’ to identify the Credential ID and the Origin of the credential..\nSelect ‘Update credential’ to go directly to the Application or Service principal area..\nIf the Origin of the credential is an application, select ‘Certificates \u0026 secrets’ then locate the unused credential and remove it..\nIf the Origin of the credential is a service principal, go to ‘Identity’ \u003e ‘Enterprise applications’ \u003e ‘Single sign-on’ \u003e ‘SAML certificates’ then locate the unused credential and remove it..\nIn the instance where the origin of the credential in the recommendation is marked as service principal but there are no SAML certificates, you can use the Microsoft Graph API to query specific properties and remove the credential from the Service Principal. For more information, see Recommendation to remove unused apps.\nLearn more: https://maester.dev/docs/tests/MT.1024\nTag: Maester Entra Security All Recommendation MT.1024 staleAppCreds\nCategory: Entra Recommendations\nSource: C:\\maester-tests\\Maester\\Entra\\Test-EntraRecommendations.Tests.ps1\nMT.1024: Entra Recommendation - Renew expiring application credentials. Overview Renewing an application’s credentials prior to their expiry date is crucial for maintaining uninterrupted operations and minimizing the risk of any downtime resulting from outdated credentials.\nTest Results Your tenant has applications with credentials that will expire soon.\n➡️ Open Recommendation - Renew expiring application credentials in the Entra admin portal.\nRemediation actions: From the impacted resources table, click on “More details” to see and note the ID of the credential..\nClick the “Update credential” link to navigate to the Application registration blade..\nNavigate to the Certificates \u0026 Secrets section of the app registration..\nPick the credential type that you want to rotate and navigate to either Certificates or Client Secret tab and follow the prompts to add a new credential of that type..\nOnce the certificate or secret is successfully added, update the service code to ensure it works with the new credential..\nUse the Microsoft Entra sign-in logs to validate that the Key ID of the credential matches the one that was recently added..\nAfter validating the new credential, navigate back to App registrations \u003e Certificates and Secrets for the app and remove the old credential..\nLearn more: https://maester.dev/docs/tests/MT.1024\nTag: Maester Entra Security All Recommendation MT.1024 applicationCredentialExpiry\nCategory: Entra Recommendations\nSource: C:\\maester-tests\\Maester\\Entra\\Test-EntraRecommendations.Tests.ps1\nMT.1024: Entra Recommendation - Renew expiring service principal credentials. Overview Renewing the service principal credential(s) before expiration ensures the application continues to function and reduces the possibility of downtime due to an expired credential.\nTest Results Your tenant has service principals with credentials that will expire soon.\n➡️ Open Recommendation - Renew expiring service principal credentials in the Entra admin portal.\nRemediation actions: Navigate to the Enterprise applications section and locate the Enterprise application for which the credential needs to be rotated..\nNavigate to the “Single sign-on” blade..\nEdit the ‘SAML signing certificate’ section and follow prompts to add a new certificate..\nAfter adding the certificate, change its properties to make certificate active. This will make the previous certificate inactive..\nOnce the certificate is successfully added and activated, validate that your service is working with the new credential, and remove the old credential..\nIf the service principal does not show any credentials after navigating to the enterprise apps blade, we recommend checking the ‘passwordCredentials’ and ‘keyCredentials’ property of the service principal object using PowerShell or Microsoft Graph service principal API and use the Microsoft Graph API to rotate credentials..\nLearn more: https://maester.dev/docs/tests/MT.1024\nTag: Maester Entra Security All Recommendation MT.1024 servicePrincipalKeyExpiry\nCategory: Entra Recommendations\nSource: C:\\maester-tests\\Maester\\Entra\\Test-EntraRecommendations.Tests.ps1\nMT.1024: Entra Recommendation - Do not allow users to grant consent to unreliable applications. Overview To reduce the risk of malicious applications attempting to trick users into granting them access to your organization’s data, we recommend that you allow user consent only for applications that have been published by a verified publisher.\nTest Results You have no user consent policy in place.\nIf the recommendation is not applicable for your tenant, it can be marked as Dismissed for Maester to skip it in the future.\n➡️ Open Recommendation - Do not allow users to grant consent to unreliable applications in the Entra admin portal.\nRemediation actions: Go to Microsoft Entra ID \u003e Enterprise applications \u003e Consent and permissions. Go to Consent and permissions.\nSelect “Allow user consent for apps from verified publishers, for selected permissions (Recommended)” to follow Microsoft’s best practice. Learn more.\nConfigure the low-impact permissions that users are allowed to consent to. Click “Select permissions to classify as low impact”. Learn more.\nOptionally, you can help your users to consent to apps that require admin consent by setting up the admin consent workflow. This step is recommended but not required to get full score. Learn how to configure the admin consent workflow.\nLearn more: https://maester.dev/docs/tests/MT.1024\nTag: Maester Entra Security All Recommendation MT.1024 integratedApps\nCategory: Entra Recommendations\nSource: C:\\maester-tests\\Maester\\Entra\\Test-EntraRecommendations.Tests.ps1\nMT.1024: Entra Recommendation - Do not expire passwords. Overview Research has found that when periodic password resets are enforced, passwords become less secure. Users tend to pick a weaker password and vary it slightly for each reset. If a user creates a strong password (long, complex and without any pragmatic words present), it should remain as strong in the future as it is today. It is Microsoft’s official security position to not expire passwords periodically without a specific reason, and recommends that cloud-only tenants set the password policy to never expire.\nTest Results Your current policy is set to never let passwords expire.\n➡️ Open Recommendation - Do not expire passwords in the Entra admin portal.\nRemediation actions: In the Microsoft 365 admin center, go to Settings \u003e Org Settings \u003e Security \u0026 privacy \u003e Password expiration policy. Then check the box “Set passwords to never expire (recommended)”. You must be a global admin to edit the password policy. Go to Password expiration policy in Microsoft 365.\nIf your organization has an on-premises implementation, we recommend that you set the status for this action to “Completed” or “Resolved through alternate mitigation”..\nLearn more: https://maester.dev/docs/tests/MT.1024\nTag: Maester Entra Security All Recommendation MT.1024 pwagePolicyNew\nCategory: Entra Recommendations\nSource: C:\\maester-tests\\Maester\\Entra\\Test-EntraRecommendations.Tests.ps1\nMT.1024: Entra Recommendation - Enable password hash sync if hybrid. Overview Password hash synchronization is one of the sign-in methods used to accomplish hybrid identity. Microsoft Entra Connect synchronizes a hash of the hash of a user’s password from an on-premises Microsoft Entra Connect instance to a cloud-based Microsoft Entra Connect cloud sync instance. Password hash synchronization helps by reducing the number of passwords your users need to maintain to just one. Enabling password hash synchronization also allows for leaked credential reporting.\nTest Results You have enabled password hash sync.\n➡️ Open Recommendation - Enable password hash sync if hybrid in the Entra admin portal.\nRemediation actions: To use password hash synchronization in your organization, you need to install Microsoft Entra Connect and configure directory synchronization between your on-premises Microsoft Entra Connect instance and your Microsoft Entra Connect cloud sync instance. Follow these steps to enable password hash synchronization. Learn more: https://maester.dev/docs/tests/MT.1024\nTag: Maester Entra Security All Recommendation MT.1024 passwordHashSync\nCategory: Entra Recommendations\nSource: C:\\maester-tests\\Maester\\Entra\\Test-EntraRecommendations.Tests.ps1\nMT.1024: Entra Recommendation - Migrate Service Principals from the retiring Azure AD Graph APIs to Microsoft Graph. Overview Azure AD Graph APIs are in the retirement cycle and have no SLA or maintenance commitment beyond security-related fixes. Applications that continue to use Azure AD Graph APIs and have not migrated to Microsoft Graph will be impacted by future retirement activity for Azure AD Graph. Microsoft Graph offers a single unified endpoint to access Microsoft Entra services and Microsoft 365 services. Microsoft Graph has all the capabilities that have been available in Azure AD Graph and many newer APIs and features. Its client libraries offer built-in support for features like retry handling, secure redirects, transparent authentication, and payload compression.\nTest Results 1 Service Principals in your tenant are calling one or more retiring APIs from Azure AD Graph and need to be migrated to Microsoft Graph.\n➡️ Open Recommendation - Migrate Service Principals from the retiring Azure AD Graph APIs to Microsoft Graph in the Entra admin portal.\nRemediation actions: Review the list of Service Principals calling Azure AD Graph under Impacted Resources..\nWorking with the owner or publisher of the corresponding application, identify steps required to update the application to a version that is using Microsoft Graph APIs instead of Azure AD Graph APIs..\nLearn more about Azure AD Graph retirement. Azure AD Graph Retirement.\nLearn more about Microsoft Graph. Microsoft Graph.\nLearn more: https://maester.dev/docs/tests/MT.1024\nTag: Maester Entra Security All Recommendation MT.1024 aadGraphDeprecationServicePrincipal\nCategory: Entra Recommendations\nSource: C:\\maester-tests\\Maester\\Entra\\Test-EntraRecommendations.Tests.ps1\nMT.1024: Entra Recommendation - Use least privileged administrative roles . Overview Ensure that your administrators can accomplish their work with the least amount of privilege assigned to their account. Assigning users roles like Password Administrator or Exchange Online Administrator, instead of Global Administrator, reduces the likelihood of a global administrative privileged account being breached.\nTest Results You currently have 1 users with privileged administrative roles.\n➡️ Open Recommendation - Use least privileged administrative roles in the Entra admin portal.\nRemediation actions: Identify the users in your organization with a persistent global administrator role assigned. Go to Microsoft Entra ID \u003e Roles and administrators and select the Global administrator role in the table. Identify the global admins you want to reassign to a different role. Go to Roles and administrators in Microsoft Entra ID.\nAssign these users to roles where they can complete necessary tasks with the least amount of privilege required. For example, if a user is primarily responsible for Exchange Online administration, they should be assigned that role instead of global administrator. Be sure to have at least two global admins designated to allow for full access to the network if one of the accounts is locked out or compromised. Check out this overview of available limited administrative roles.\nAfter these persistent global admins have been reassigned new roles, return to Roles and administrators and select the Global administrator role. Select the users that no longer need persistent access and then click Remove. Go to Roles and administrators in Microsoft Entra ID.\nEmergency access accounts: If the only other global admin accounts your organization has set up are for “break-glass” scenarios, which are ineligible for role reassignment, we recommend that you set the status of this action to “Dismissed” or “Risk accepted”. Learn more about emergency access accounts.\nLearn more: https://maester.dev/docs/tests/MT.1024\nTag: Maester Entra Security All Recommendation MT.1024 roleOverlap\nCategory: Entra Recommendations\nSource: C:\\maester-tests\\Maester\\Entra\\Test-EntraRecommendations.Tests.ps1\nMT.1024: Entra Recommendation - Enable self-service password reset. Overview With self-service password reset in Microsoft Entra ID, users no longer need to engage helpdesk to reset passwords. This feature works well with Microsoft Entra ID dynamically banned passwords, which prevents easily guessable passwords from being used.\nTest Results You have 22 of users who don’t have self-service password reset enabled.\nIf the recommendation is not applicable for your tenant, it can be marked as Dismissed for Maester to skip it in the future.\n➡️ Open Recommendation - Enable self-service password reset in the Entra admin portal.\nRemediation actions: Follow our step-by-step guidance to enable self-service password reset.\nIf you have users that are synced from on-premises Microsoft Entra Connect using Microsoft Entra Connect, you may also need to enable the password writeback feature. For more information, see this article.\nLearn more: https://maester.dev/docs/tests/MT.1024\nTag: Maester Entra Security All Recommendation MT.1024 selfServicePasswordReset\nCategory: Entra Recommendations\nSource: C:\\maester-tests\\Maester\\Entra\\Test-EntraRecommendations.Tests.ps1\nMT.1024: Entra Recommendation - Protect your tenant with Insider Risk condition in Conditional Access policy. Overview Enabling an Insider Risk-based Conditional Access policy offers crucial benefits, including early detection of anomalies, adaptive access controls, and real-time responses to insider threats. It prevents unauthorized access, enforces compliance, and reduces the impact of insider incidents. By fostering a security-aware culture, the policy integrates with the broader security ecosystem, providing a comprehensive approach to mitigate risks originating from within the organization, safeguarding sensitive data, and enhancing overall security posture.​\nTest Results You have 23 of 23 users that aren’t covered by the Insider Risk condition in a Conditional Access policy.\nIf the recommendation is not applicable for your tenant, it can be marked as Dismissed for Maester to skip it in the future.\n➡️ Open Recommendation - Protect your tenant with Insider Risk condition in Conditional Access policy in the Entra admin portal.\nRemediation actions: Enable Adaptive Protection in Microsoft Purview. You must be a member of the Insider Risk Management or Insider Risk Management Admins role group in Microsoft Purview to configure Adaptive Protection. Go to Adaptive Protection..\nCreate a Conditional Access policy that includes the Insider Risk condition. Use this risk policy template.\nFor more information about this recommendation and the associated features, see Adaptive Protection and Insider Risk Conditional Access recommendation..\nLearn more: https://maester.dev/docs/tests/MT.1024\nTag: Maester Entra Security All Recommendation MT.1024 insiderRiskPolicy\nCategory: Entra Recommendations\nSource: C:\\maester-tests\\Maester\\Entra\\Test-EntraRecommendations.Tests.ps1\nMT.1024: Entra Recommendation - Designate more than one global admin. Overview Having more than one global administrator helps if you’re unable to fulfill the needs or obligations of your organization. It’s important to have a delegate or an emergency access account that someone from your team can access if necessary. It also allows admins the ability to monitor each other for signs of a breach.\nTest Results You currently have 1 global admins.\nIf the recommendation is not applicable for your tenant, it can be marked as Dismissed for Maester to skip it in the future.\n➡️ Open Recommendation - Designate more than one global admin in the Entra admin portal.\nRemediation actions: Assign more than one user a global administrator role in your organization. Go to Microsoft Entra ID \u003e Roles and administrators and select the Global administrator role in the table. Then click Add assignments. Go to the Global administrator role in Microsoft Entra ID. Learn more: https://maester.dev/docs/tests/MT.1024\nTag: Maester Entra Security All Recommendation MT.1024 oneAdmin\nCategory: Entra Recommendations\nSource: C:\\maester-tests\\Maester\\Entra\\Test-EntraRecommendations.Tests.ps1\nMT.1025: No external user with permanent role assignment on Control Plane. Overview Take attention on B2B collaboration user with Entra ID directory role assignments on ControlPlane. Verify the affected external users, the user source (e.g., MSSP/partner or managing tenant) and if the privileged accounts pass your requirements for Conditional Access, Lifecycle Workflow and Identity Protection. Learn more about the best practices for privileges users:\nSecuring privileged access for hybrid and cloud deployments in Microsoft Entra ID Test Results Well done!\nLearn more: https://maester.dev/docs/tests/MT.1025\nTag: Maester Privileged Security All MT.1025\nCategory: Directory Roles - Permanent assignments\nSource: C:\\maester-tests\\Maester\\Entra\\Test-PrivilegedAssignments.Tests.ps1\nMT.1026: No hybrid user with permanent role assignment on Control Plane. Overview It’s recommended to use cloud-only accounts for privileges with ControlPlane privileges to avoid attack paths from on-premises environment. Learn more about the best practices for privileges users:\nSecuring privileged access for hybrid and cloud deployments in Microsoft Entra ID Protecting Microsoft 365 from on-premises attacks Test Results Well done!\nLearn more: https://maester.dev/docs/tests/MT.1026\nTag: Maester Privileged Security All MT.1026\nCategory: Directory Roles - Permanent assignments\nSource: C:\\maester-tests\\Maester\\Entra\\Test-PrivilegedAssignments.Tests.ps1\nMT.1027: No Service Principal with Client Secret and permanent role assignment on Control Plane. Overview Review your Service Principals with Client Secrets and ControlPlane privileges. It’s recommended to use certificates for Service Principals. Review if you can replace client secrets by certificates or use managed identities instead of a Service Principal. Learn more about the best practices for issuing certificates for Service Principals:\nSecuring service principals in Microsoft Entra ID Best practices for all isolation architectures - Service Principal Credentials Test Results Well done!\nLearn more: https://maester.dev/docs/tests/MT.1027\nTag: Maester Privileged Security All MT.1027\nCategory: Directory Roles - Permanent assignments\nSource: C:\\maester-tests\\Maester\\Entra\\Test-PrivilegedAssignments.Tests.ps1\nMT.1028: No user with mailbox and permanent role assignment on Control Plane. Overview Take attention on mail-enabled administrative accounts with ControlPlane privileges. It’s recommended to use mail forwarding to regular work account which allows to avoid direct mail access and phishing attacks on privileged user. Learn more about the best practices for securing privileged user accounts:\nSecuring privileged access for hybrid and cloud deployments in Microsoft Entra ID Test Results These directory role assignments for UserMailbox exists:\nJoi Jons with Global Administrator on scope directory (tenant-wide) Administrator on scope directory (tenant-wide) Learn more: https://maester.dev/docs/tests/MT.1028\nTag: Maester Privileged Security All MT.1028\nCategory: Directory Roles - Permanent assignments\nSource: C:\\maester-tests\\Maester\\Entra\\Test-PrivilegedAssignments.Tests.ps1\nMT.1029: Stale accounts are not assigned to privileged roles. Overview Security Impact\nAccounts in a privileged role have not signed in recently. These accounts might be service or shared accounts that aren’t being maintained and are vulnerable to attackers.\nMitigation steps\nReview the accounts in the list. If they no longer need access, remove them from their privileged roles.\nHow to prevent\nRegularly review accounts with privileged roles using access reviews and remove role assignments which are no longer needed.\nTest Results 1 account(s) in privileged roles that have not signed in to Azure AD in the past 30 day(s)\nJoi Jons with Global Administrator by AssigneeId 663f1ee9-74d5-4c94-833b-b5e8013942f5 Get more details from the PIM alert Potential stale accounts in a privileged role in the Azure Portal.\nLearn more: https://maester.dev/docs/tests/MT.1029\nTag: Privileged Security All MT.1029\nCategory: Privileged Identity Management (PIM) - Alerts\nSource: C:\\maester-tests\\Maester\\Entra\\Test-PrivilegedAssignments.Tests.ps1\nMT.1030: Eligible role assignments on Control Plane are in use by administrators. Overview if ( ( Get-MtLicenseInformation EntraID ) -ne “P2” ) { Add-MtTestResultDetail -SkippedBecause NotLicensedEntraIDP2 } else { $Check = Test-MtPimAlertsExists -AlertId “RedundantAssignmentAlert” -FilteredAccessLevel “ControlPlane” $check.numberOfAffectedItems -eq “0” | Should -Be $true -Because $check.securityImpact }\nReason for failure You cannot call a method on a null-valued expression.\nLearn more: https://maester.dev/docs/tests/MT.1030\nTag: Privileged Security All MT.1030\nCategory: Privileged Identity Management (PIM) - Alerts\nSource: C:\\maester-tests\\Maester\\Entra\\Test-PrivilegedAssignments.Tests.ps1\nMT.1031: Privileged role on Control Plane are managed by PIM only. Overview if ( ( Get-MtLicenseInformation EntraID ) -ne “P2” ) { Add-MtTestResultDetail -SkippedBecause NotLicensedEntraIDP2 } else { $Check = Test-MtPimAlertsExists -AlertId “RolesAssignedOutsidePimAlert” -FilteredAccessLevel “ControlPlane” $check.numberOfAffectedItems -eq “0” | Should -Be $true -Because $check.securityImpact }\nReason for failure You cannot call a method on a null-valued expression.\nLearn more: https://maester.dev/docs/tests/MT.1031\nTag: Privileged Security All MT.1031\nCategory: Privileged Identity Management (PIM) - Alerts\nSource: C:\\maester-tests\\Maester\\Entra\\Test-PrivilegedAssignments.Tests.ps1\nMT.1032: Limited number of Global Admins are assigned. Overview if ( ( Get-MtLicenseInformation EntraID ) -ne “P2” ) { Add-MtTestResultDetail -SkippedBecause NotLicensedEntraIDP2 } else { $Check = Test-MtPimAlertsExists -AlertId “TooManyGlobalAdminsAssignedToTenantAlert” $check.numberOfAffectedItems -eq “0” | Should -Be $true -Because $check.securityImpact }\nReason for failure You cannot call a method on a null-valued expression.\nLearn more: https://maester.dev/docs/tests/MT.1032\nTag: Privileged Security All MT.1032\nCategory: Privileged Identity Management (PIM) - Alerts\nSource: C:\\maester-tests\\Maester\\Entra\\Test-PrivilegedAssignments.Tests.ps1\nMT.1035: All security groups assigned to Conditional Access Policies should be protected by RMAU. Overview Test Results Well done! All security groups with assignment in Conditional Access are protected!\nLearn more: https://maester.dev/docs/tests/MT.1035\nTag: Maester CA Security All MT.1035\nCategory: Conditional Access Baseline Policies\nSource: C:\\maester-tests\\Maester\\Entra\\Test-ConditionalAccessBaseline.Tests.ps1\nMT.1036: All excluded objects should have a fallback include in another policy. Overview All excluded objects should have a fallback include in another policy\nTest Results All excluded objects seem to have a fallback in other policies.\nLearn more: https://maester.dev/docs/tests/MT.1036\nTag: Maester CA Security All MT.1036 Warning\nCategory: Conditional Access Baseline Policies\nSource: C:\\maester-tests\\Maester\\Entra\\Test-ConditionalAccessBaseline.Tests.ps1\nMT.1038: Conditional Access policies should not include or exclude deleted groups. Overview This test checks if there are any Conditional Access policies that target deleted security groups.\nThis usually happens when a group is deleted but is still referenced in a Conditional Access policy.\nDeleted groups in your policy can lead to unexpected gaps. This may result in Conditional Access policies not being applied to the users you intended or the policy not being applied at all.\nTo fix this issue:\nOpen the impacted Conditional access policy. If the group is no longer needed, click Save to remove the referenced group from the policy. If the group is still needed, update the policy to target a valid group. Test Results Well done! All Conditional Access policies are targeting active groups.\nNote: Names are not available for deleted groups. If the group was deleted in the last 30 days it may be available under Entra admin centre - Deleted groups.\nLearn more: https://maester.dev/docs/tests/MT.1038\nTag: Maester CA Security All MT.1038 Warning\nCategory: Conditional Access Baseline Policies\nSource: C:\\maester-tests\\Maester\\Entra\\Test-ConditionalAccessBaseline.Tests.ps1\nCIS 1.3.1 (L1) Ensure the ‘Password expiration policy’ is set to ‘Set passwords to never expire (recommended)’ Overview 1.3.1 (L1) Ensure the ‘Password expiration policy’ is set to ‘Set passwords to never expire (recommended)’\nOrganizations such as NIST and Microsoft have updated their password policy recommendations to not arbitrarily require users to change their passwords after a specific amount of time, unless there is evidence that the password is compromised, or the user forgot it.\nRemediation action: To set Office 365 passwords are set to never expire:\nNavigate to Microsoft 365 admin center https://admin.microsoft.com. Click to expand Settings select Org Settings. Click on Security \u0026 privacy. Check the Set passwords to never expire (recommended) box. Click Save. Related links Microsoft 365 Admin Center CIS Microsoft 365 Foundations Benchmark v3.1.0 - Page 37 Test Results Skipped. Missing Scope Domain.Read.All\nTag: CIS 1.3.1 L1 CIS E3 Level 1 CIS E3 CIS Security All CIS M365 v3.1.0\nCategory: CIS\nSource: C:\\maester-tests\\cis\\Test-MtCisPasswordExpiry.Tests.ps1\nEIDSCA.AF02: Authentication Method - FIDO2 security key - Allow self-service set up. Overview Allows users to register a FIDO key through the MySecurityInfo portal, even if enabled by Authentication Methods policy.\nTest script https://graph.microsoft.com/beta/policies/authenticationMethodsPolicy/authenticationMethodConfigurations('Fido2')\r.isSelfServiceRegistrationAllowed -eq 'true' Related links Open in Graph Explorer fido2AuthenticationMethodConfiguration resource type - Microsoft Graph v1.0 | Microsoft Learn Test Results Skipped. Authentication method of FIDO2 security keys is not enabled.\nLearn more: https://maester.dev/docs/tests/EIDSCA.AF02\nTag: EIDSCA Security All EIDSCA.AF02\nCategory: Authentication Method - FIDO2 security key\nSource: C:\\maester-tests\\EIDSCA\\Test-EIDSCA.Generated.Tests.ps1\nEIDSCA.AF03: Authentication Method - FIDO2 security key - Enforce attestation. Overview Requires the FIDO security key metadata to be published and verified with the FIDO Alliance Metadata Service, and also pass Microsoft’s additional set of validation testing.\nTest script https://graph.microsoft.com/beta/policies/authenticationMethodsPolicy/authenticationMethodConfigurations('Fido2')\r.isAttestationEnforced -eq 'true' Related links Open in Graph Explorer fido2AuthenticationMethodConfiguration resource type - Microsoft Graph v1.0 | Microsoft Learn Test Results Skipped. Authentication method of FIDO2 security keys is not enabled.\nLearn more: https://maester.dev/docs/tests/EIDSCA.AF03\nTag: EIDSCA Security All EIDSCA.AF03\nCategory: Authentication Method - FIDO2 security key\nSource: C:\\maester-tests\\EIDSCA\\Test-EIDSCA.Generated.Tests.ps1\nEIDSCA.AF04: Authentication Method - FIDO2 security key - Enforce key restrictions. Overview Manages if registration of FIDO2 keys should be restricted.\nRestrict usage of FIDO2 from unauthorized vendors or platforms\nTest script https://graph.microsoft.com/beta/policies/authenticationMethodsPolicy/authenticationMethodConfigurations('Fido2')\r.keyRestrictions.isEnforced -eq 'true' Related links Open in Graph Explorer fido2AuthenticationMethodConfiguration resource type - Microsoft Graph v1.0 | Microsoft Learn Test Results Skipped. Authentication method of FIDO2 security keys is not enabled.\nLearn more: https://maester.dev/docs/tests/EIDSCA.AF04\nTag: EIDSCA Security All EIDSCA.AF04\nCategory: Authentication Method - FIDO2 security key\nSource: C:\\maester-tests\\EIDSCA\\Test-EIDSCA.Generated.Tests.ps1\nEIDSCA.AF05: Authentication Method - FIDO2 security key - Restricted. Overview You can work with your Security key provider to determine the AAGuids of their devices for allowing or blocking usage.\nTest script https://graph.microsoft.com/beta/policies/authenticationMethodsPolicy/authenticationMethodConfigurations('Fido2')\r.keyRestrictions.aaGuids -notcontains $null -eq 'true' Related links Open in Graph Explorer fido2AuthenticationMethodConfiguration resource type - Microsoft Graph v1.0 | Microsoft Learn Test Results Skipped. Authentication method of FIDO2 security keys is not enabled and key restriction not enforced.\nLearn more: https://maester.dev/docs/tests/EIDSCA.AF05\nTag: EIDSCA Security All EIDSCA.AF05\nCategory: Authentication Method - FIDO2 security key\nSource: C:\\maester-tests\\EIDSCA\\Test-EIDSCA.Generated.Tests.ps1\nEIDSCA.AF06: Authentication Method - FIDO2 security key - Restrict specific keys. Overview Defines if list of AADGUID will be used to allow or block registration.\nYou should use Block or Allow as value to allow- or blocklisting of AAGuids.\nTest script https://graph.microsoft.com/beta/policies/authenticationMethodsPolicy/authenticationMethodConfigurations('Fido2')\r.keyRestrictions.aaGuids -notcontains $null -and ($result.keyRestrictions.enforcementType -eq 'allow' -or $result.keyRestrictions.enforcementType -eq 'block') -eq 'true' Related links Open in Graph Explorer fido2AuthenticationMethodConfiguration resource type - Microsoft Graph v1.0 | Microsoft Learn Test Results Skipped. Authentication method of FIDO2 security keys is not enabled and key restriction not enforced.\nLearn more: https://maester.dev/docs/tests/EIDSCA.AF06\nTag: EIDSCA Security All EIDSCA.AF06\nCategory: Authentication Method - FIDO2 security key\nSource: C:\\maester-tests\\EIDSCA\\Test-EIDSCA.Generated.Tests.ps1\nEIDSCA.AM02: Authentication Method - Microsoft Authenticator - Allow use of Microsoft Authenticator OTP. Overview Defines if users can use the OTP code generated by the Authenticator App.\ntrue\nTest script https://graph.microsoft.com/beta/policies/authenticationMethodsPolicy/authenticationMethodConfigurations('MicrosoftAuthenticator')\r.isSoftwareOathEnabled -eq 'true' Related links Open in Graph Explorer microsoftAuthenticatorAuthenticationMethodConfiguration resource type - Microsoft Graph v1.0 | Microsoft Learn View in Microsoft Entra admin center Test Results Skipped. Authentication method of Microsoft Authenticator is not enabled.\nLearn more: https://maester.dev/docs/tests/EIDSCA.AM02\nTag: EIDSCA Security All EIDSCA.AM02\nCategory: Authentication Method - Microsoft Authenticator\nSource: C:\\maester-tests\\EIDSCA\\Test-EIDSCA.Generated.Tests.ps1\nEIDSCA.AM03: Authentication Method - Microsoft Authenticator - Require number matching for push notifications. Overview Defines if number matching is required for MFA notifications.\nTest script https://graph.microsoft.com/beta/policies/authenticationMethodsPolicy/authenticationMethodConfigurations('MicrosoftAuthenticator')\r.featureSettings.numberMatchingRequiredState.state -eq 'enabled' Related links Open in Graph Explorer microsoftAuthenticatorAuthenticationMethodConfiguration resource type - Microsoft Graph v1.0 | Microsoft Learn Test Results Skipped. Authentication method of Microsoft Authenticator is not enabled.\nLearn more: https://maester.dev/docs/tests/EIDSCA.AM03\nTag: EIDSCA Security All EIDSCA.AM03\nCategory: Authentication Method - Microsoft Authenticator\nSource: C:\\maester-tests\\EIDSCA\\Test-EIDSCA.Generated.Tests.ps1\nEIDSCA.AM04: Authentication Method - Microsoft Authenticator - Included users/groups of number matching for push notifications. Overview Object Id or scope of users which will be showing number matching in the Authenticator App.\nTest script https://graph.microsoft.com/beta/policies/authenticationMethodsPolicy/authenticationMethodConfigurations('MicrosoftAuthenticator')\r.featureSettings.numberMatchingRequiredState.includeTarget.id -eq 'all_users' Related links Open in Graph Explorer microsoftAuthenticatorAuthenticationMethodConfiguration resource type - Microsoft Graph v1.0 | Microsoft Learn Test Results Skipped. Authentication method of Microsoft Authenticator is not enabled.\nLearn more: https://maester.dev/docs/tests/EIDSCA.AM04\nTag: EIDSCA Security All EIDSCA.AM04\nCategory: Authentication Method - Microsoft Authenticator\nSource: C:\\maester-tests\\EIDSCA\\Test-EIDSCA.Generated.Tests.ps1\nEIDSCA.AM06: Authentication Method - Microsoft Authenticator - Show application name in push and passwordless notifications. Overview Determines whether the user’s Authenticator app will show them the client app they are signing into.\nTest script https://graph.microsoft.com/beta/policies/authenticationMethodsPolicy/authenticationMethodConfigurations('MicrosoftAuthenticator')\r.featureSettings.displayAppInformationRequiredState.state -eq 'enabled' Related links Open in Graph Explorer microsoftAuthenticatorAuthenticationMethodConfiguration resource type - Microsoft Graph v1.0 | Microsoft Learn Test Results Skipped. Authentication method of Microsoft Authenticator is not enabled.\nLearn more: https://maester.dev/docs/tests/EIDSCA.AM06\nTag: EIDSCA Security All EIDSCA.AM06\nCategory: Authentication Method - Microsoft Authenticator\nSource: C:\\maester-tests\\EIDSCA\\Test-EIDSCA.Generated.Tests.ps1\nEIDSCA.AM07: Authentication Method - Microsoft Authenticator - Included users/groups to show application name in push and passwordless notifications. Overview Object Id or scope of users which will be showing app information in the Authenticator App.\nTest script https://graph.microsoft.com/beta/policies/authenticationMethodsPolicy/authenticationMethodConfigurations('MicrosoftAuthenticator')\r.featureSettings.displayAppInformationRequiredState.includeTarget.id -eq 'all_users' Related links Open in Graph Explorer microsoftAuthenticatorAuthenticationMethodConfiguration resource type - Microsoft Graph v1.0 | Microsoft Learn Test Results Skipped. Authentication method of Microsoft Authenticator is not enabled.\nLearn more: https://maester.dev/docs/tests/EIDSCA.AM07\nTag: EIDSCA Security All EIDSCA.AM07\nCategory: Authentication Method - Microsoft Authenticator\nSource: C:\\maester-tests\\EIDSCA\\Test-EIDSCA.Generated.Tests.ps1\nEIDSCA.AM09: Authentication Method - Microsoft Authenticator - Show geographic location in push and passwordless notifications. Overview Determines whether the user’s Authenticator app will show them the geographic location of where the authentication request originated from.\nTest script https://graph.microsoft.com/beta/policies/authenticationMethodsPolicy/authenticationMethodConfigurations('MicrosoftAuthenticator')\r.featureSettings.displayLocationInformationRequiredState.state -eq 'enabled' Related links Open in Graph Explorer microsoftAuthenticatorAuthenticationMethodConfiguration resource type - Microsoft Graph v1.0 | Microsoft Learn Test Results Skipped. Authentication method of Microsoft Authenticator is not enabled.\nLearn more: https://maester.dev/docs/tests/EIDSCA.AM09\nTag: EIDSCA Security All EIDSCA.AM09\nCategory: Authentication Method - Microsoft Authenticator\nSource: C:\\maester-tests\\EIDSCA\\Test-EIDSCA.Generated.Tests.ps1\nEIDSCA.AM10: Authentication Method - Microsoft Authenticator - Included users/groups to show geographic location in push and passwordless notifications. Overview Object Id or scope of users which will be showing geographic location in the Authenticator App.\nTest script https://graph.microsoft.com/beta/policies/authenticationMethodsPolicy/authenticationMethodConfigurations('MicrosoftAuthenticator')\r.featureSettings.displayLocationInformationRequiredState.includeTarget.id -eq 'all_users' Related links Open in Graph Explorer microsoftAuthenticatorAuthenticationMethodConfiguration resource type - Microsoft Graph v1.0 | Microsoft Learn Test Results Skipped. Authentication method of Microsoft Authenticator is not enabled.\nLearn more: https://maester.dev/docs/tests/EIDSCA.AM10\nTag: EIDSCA Security All EIDSCA.AM10\nCategory: Authentication Method - Microsoft Authenticator\nSource: C:\\maester-tests\\EIDSCA\\Test-EIDSCA.Generated.Tests.ps1\nEIDSCA.AS04: Authentication Method - SMS - Use for sign-in. Overview Determines if users can use this authentication method to sign in to Microsoft Entra ID. true if users can use this method for primary authentication, otherwise false.\nAvoid to use SMS as primary sign in factor (instead of a password) and consider to implement a MFA or passwordless option also for your special user groups, such as front-line workers.\nTest script https://graph.microsoft.com/beta/policies/authenticationMethodsPolicy/authenticationMethodConfigurations('Sms')\r.includeTargets.isUsableForSignIn -eq 'false' Related links Open in Graph Explorer phoneAuthenticationMethod resource type - Microsoft Graph v1.0 | Microsoft Learn Test Results Skipped. Authentication method of Sms is not enabled.\nLearn more: https://maester.dev/docs/tests/EIDSCA.AS04\nTag: EIDSCA Security All EIDSCA.AS04\nCategory: Authentication Method - SMS\nSource: C:\\maester-tests\\EIDSCA\\Test-EIDSCA.Generated.Tests.ps1\nEIDSCA.AT02: Authentication Method - Temporary Access Pass - One-time. Overview Determines whether the pass is limited to a one-time use.\nAvoid to allow reusable passes and restrict usage to one-time use (if applicable)\nTest script https://graph.microsoft.com/beta/policies/authenticationMethodsPolicy/authenticationMethodConfigurations('TemporaryAccessPass')\r.isUsableOnce -eq 'true' Related links Open in Graph Explorer temporaryAccessPassAuthenticationMethodConfiguration resource type - Microsoft Graph v1.0 | Microsoft Learn Test Results Skipped. Authentication method of Temporary Access Pass is not enabled.\nLearn more: https://maester.dev/docs/tests/EIDSCA.AT02\nTag: EIDSCA Security All EIDSCA.AT02\nCategory: Authentication Method - Temporary Access Pass\nSource: C:\\maester-tests\\EIDSCA\\Test-EIDSCA.Generated.Tests.ps1\nEIDSCA.CP01: Default Settings - Consent Policy Settings - Group owner consent for apps accessing data. Overview Group and team owners can authorize applications, such as applications published by third-party vendors, to access your organization’s data associated with a group. For example, a team owner in Microsoft Teams can allow an app to read all Teams messages in the team, or list the basic profile of a group’s members.\nCISA SCuBA 2.7: Non-Admin Users SHALL Be Prevented From Providing Consent To Third-Party Applications.\nTest script https://graph.microsoft.com/beta/settings\r.values | where-object name -eq 'EnableGroupSpecificConsent' | select-object -expand value -eq 'False' Related links Open in Graph Explorer directorySetting resource type - Microsoft Graph beta | Microsoft Learn View in Microsoft Entra admin center Test Results Skipped. Settings value is not available. This may be due to the change that this API is no longer available for recent created tenants.\nLearn more: https://maester.dev/docs/tests/EIDSCA.CP01\nTag: EIDSCA Security All EIDSCA.CP01\nCategory: Default Settings - Consent Policy Settings\nSource: C:\\maester-tests\\EIDSCA\\Test-EIDSCA.Generated.Tests.ps1\nEIDSCA.CP03: Default Settings - Consent Policy Settings - Block user consent for risky apps. Overview Defines whether user consent will be blocked when a risky request is detected\nConfigure risk-based step-up consent - Microsoft Entra ID - Microsoft Learn\nTest script https://graph.microsoft.com/beta/settings\r.values | where-object name -eq 'BlockUserConsentForRiskyApps' | select-object -expand value -eq 'true' Related links Open in Graph Explorer directorySetting resource type - Microsoft Graph beta | Microsoft Learn Test Results Skipped. Settings value is not available. This may be due to the change that this API is no longer available for recent created tenants.\nLearn more: https://maester.dev/docs/tests/EIDSCA.CP03\nTag: EIDSCA Security All EIDSCA.CP03\nCategory: Default Settings - Consent Policy Settings\nSource: C:\\maester-tests\\EIDSCA\\Test-EIDSCA.Generated.Tests.ps1\nEIDSCA.CP04: Default Settings - Consent Policy Settings - Users can request admin consent to apps they are unable to consent to. Overview If this option is set to enabled, then users request admin consent to any app that requires access to data they do not have the permission to grant. If this option is set to disabled, then users must contact their admin to request to consent in order to use the apps they need.\nCISA SCuBA 2.7: Non-Admin Users SHALL Be Prevented From Providing Consent To Third-Party Applications.\nTest script https://graph.microsoft.com/beta/settings\r.values | where-object name -eq 'EnableAdminConsentRequests' | select-object -expand value -eq 'true' Related links Open in Graph Explorer directorySetting resource type - Microsoft Graph beta | Microsoft Learn View in Microsoft Entra admin center Test Results Skipped. Settings value is not available. This may be due to the change that this API is no longer available for recent created tenants.\nLearn more: https://maester.dev/docs/tests/EIDSCA.CP04\nTag: EIDSCA Security All EIDSCA.CP04\nCategory: Default Settings - Consent Policy Settings\nSource: C:\\maester-tests\\EIDSCA\\Test-EIDSCA.Generated.Tests.ps1\nEIDSCA.CR02: Consent Framework - Admin Consent Request - Reviewers will receive email notifications for requests. Overview Specifies whether reviewers will receive notifications\nTest script https://graph.microsoft.com/beta/policies/adminConsentRequestPolicy\r.notifyReviewers -eq 'true' Related links Open in Graph Explorer adminConsentRequestPolicy resource type - Microsoft Graph v1.0 | Microsoft Learn View in Microsoft Entra admin center Test Results Skipped. Admin Consent Workflow is not enabled\nLearn more: https://maester.dev/docs/tests/EIDSCA.CR02\nTag: EIDSCA Security All EIDSCA.CR02\nCategory: Consent Framework - Admin Consent Request\nSource: C:\\maester-tests\\EIDSCA\\Test-EIDSCA.Generated.Tests.ps1\nEIDSCA.CR03: Consent Framework - Admin Consent Request - Reviewers will receive email notifications when admin consent requests are about to expire. Overview Specifies whether reviewers will receive reminder emails\nTest script https://graph.microsoft.com/beta/policies/adminConsentRequestPolicy\r.remindersEnabled -eq 'true' Related links Open in Graph Explorer adminConsentRequestPolicy resource type - Microsoft Graph v1.0 | Microsoft Learn View in Microsoft Entra admin center Test Results Skipped. Admin Consent Workflow is not enabled\nLearn more: https://maester.dev/docs/tests/EIDSCA.CR03\nTag: EIDSCA Security All EIDSCA.CR03\nCategory: Consent Framework - Admin Consent Request\nSource: C:\\maester-tests\\EIDSCA\\Test-EIDSCA.Generated.Tests.ps1\nEIDSCA.CR04: Consent Framework - Admin Consent Request - Consent request duration (days). Overview Specifies the duration the request is active before it automatically expires if no decision is applied\nTest script https://graph.microsoft.com/beta/policies/adminConsentRequestPolicy\r.requestDurationInDays -le '30' Related links Open in Graph Explorer adminConsentRequestPolicy resource type - Microsoft Graph v1.0 | Microsoft Learn View in Microsoft Entra admin center Test Results Skipped. Admin Consent Workflow is not enabled\nLearn more: https://maester.dev/docs/tests/EIDSCA.CR04\nTag: EIDSCA Security All EIDSCA.CR04\nCategory: Consent Framework - Admin Consent Request\nSource: C:\\maester-tests\\EIDSCA\\Test-EIDSCA.Generated.Tests.ps1\nEIDSCA.PR01: Default Settings - Password Rule Settings - Password Protection - Mode. Overview If set to Enforce, users will be prevented from setting banned passwords and the attempt will be logged. If set to Audit, the attempt will only be logged.\nMicrosoft Entra Password Protection - Microsoft Entra ID - Microsoft Learn\nTest script https://graph.microsoft.com/beta/settings\r.values | where-object name -eq 'BannedPasswordCheckOnPremisesMode' | select-object -expand value -eq 'Enforce' Related links Open in Graph Explorer directorySetting resource type - Microsoft Graph beta | Microsoft Learn View in Microsoft Entra admin center Test Results Skipped. Settings value is not available. This may be due to the change that this API is no longer available for recent created tenants.\nLearn more: https://maester.dev/docs/tests/EIDSCA.PR01\nTag: EIDSCA Security All EIDSCA.PR01\nCategory: Default Settings - Password Rule Settings\nSource: C:\\maester-tests\\EIDSCA\\Test-EIDSCA.Generated.Tests.ps1\nEIDSCA.PR03: Default Settings - Password Rule Settings - Enforce custom list. Overview When enabled, the words in the list below are used in the banned password system to prevent easy-to-guess passwords.\nPassword protection in Microsoft Entra ID - Microsoft Entra ID - Microsoft Learn\nTest script https://graph.microsoft.com/beta/settings\r.values | where-object name -eq 'EnableBannedPasswordCheck' | select-object -expand value -eq 'True' Related links Open in Graph Explorer directorySetting resource type - Microsoft Graph beta | Microsoft Learn View in Microsoft Entra admin center Test Results Skipped. Settings value is not available. This may be due to the change that this API is no longer available for recent created tenants.\nLearn more: https://maester.dev/docs/tests/EIDSCA.PR03\nTag: EIDSCA Security All EIDSCA.PR03\nCategory: Default Settings - Password Rule Settings\nSource: C:\\maester-tests\\EIDSCA\\Test-EIDSCA.Generated.Tests.ps1\nMS.EXO.04.3: The DMARC point of contact for aggregate reports SHALL include reports@dmarc.cyber.dhs.gov. Overview The DMARC point of contact for aggregate reports SHALL include reports@dmarc.cyber.dhs.gov.\nRationale: Email spoofing attempts are not inherently visible to domain owners. DMARC provides a mechanism to receive reports of spoofing attempts. Including reports@dmarc.cyber.dhs.gov as a point of contact for these reports gives CISA insight into spoofing attempts and is required by BOD 18-01 for FCEB departments and agencies.\nNote: Only federal, executive branch, departments and agencies should include this email address in their DMARC record.\nFor other organization’s there are many services that offer managed DMARC analysis and reporting, though ensure you properly align your implementation with your organization’s policies for data handling.\nRemediation action: See MS.EXO.4.1v1 Instructions for an overview of how to publish and check a DMARC record. Ensure the record published includes reports@dmarc.cyber.dhs.gov as one of the emails for the RUA field. Related links Exchange admin center - Accepted domains CISA 4 Domain-Based Message Authentication, Reporting, and Conformance (DMARC) - MS.EXO.4.3v1 CISA ScubaGear Rego Reference Test Results Skipped. This test is only for federal, executive branch, departments and agencies. To override use Test-MtCisaDmarcAggregateCisa -Force\nTag: MS.EXO MS.EXO.4.3 CISA Security All\nCategory: CISA SCuBA\nSource: C:\\maester-tests\\cisa\\exchange\\Test-MtCisaDmarcAggregateCisa.Tests.ps1\nMS.EXO.08.3: The selected DLP solution SHOULD offer services comparable to the native DLP solution offered by Microsoft. Overview The selected DLP solution SHOULD offer services comparable to the native DLP solution offered by Microsoft.\nRationale: Any alternative DLP solution should be able to detect sensitive information in Exchange Online and block access to unauthorized entities.\nThis test will always skip by default.\nRelated links Purview admin center - Data loss prevention policies CISA 8 Data Loss Prevention Solutions - MS.EXO.8.3 CISA ScubaGear Rego Reference Test Results Skipped. Unable to validate 3rd party solutions.\nTag: MS.EXO MS.EXO.8.3 CISA Security All\nCategory: CISA SCuBA\nSource: C:\\maester-tests\\cisa\\exchange\\Test-MtCisaDlpAlternate.Tests.ps1\nMS.EXO.09.4: Alternatively chosen filtering solutions SHOULD offer services comparable to Microsoft Defender’s Common Attachment Filter. Overview Alternatively chosen filtering solutions SHOULD offer services comparable to Microsoft Defender’s Common Attachment Filter.\nRationale: Malicious attachments often take the form of click-to-run files. Sharing high risk file types, when necessary, is better left to a means other than email; the dangers of allowing them to be sent over email outweigh any potential benefits. Filtering email attachments based on file types can prevent spread of malware distributed via click-to-run email attachments.\nNote: This test will always result in a skip result.\nRemediation action: Sign in to Microsoft 365 Defender. In the left-hand menu, go to Email \u0026 Collaboration \u003e Policies \u0026 Rules. Select Threat Policies. From the Templated policies section, select Preset Security Policies. Under Standard protection, slide the toggle switch to the right so the text next to the toggle reads Standard protection is on. Under Strict protection, slide the toggle switch to the right so the text next to the toggle reads Strict protection is on. Note: If the toggle slider in step 5 is grayed out, click on Manage protection settings instead and configure the policy settings according to Use the Microsoft 365 Defender portal to assign Standard and Strict preset security policies to users | Microsoft Learn.\nRelated links Defender admin center - Preset security policies CISA 9 Attachment File Type - MS.EXO.9.4v1 CISA ScubaGear Rego Reference Test Results Skipped. Only testing of MDO is supported\nTag: MS.EXO MS.EXO.9.4 CISA Security All\nCategory: CISA SCuBA\nSource: C:\\maester-tests\\cisa\\exchange\\Test-MtCisaEmailFilterAlternative.Tests.ps1\nMS.EXO.14.4: If a third-party party filtering solution is used, the solution SHOULD offer services comparable to the native spam filtering offered by Microsoft. Overview If a third-party party filtering solution is used, the solution SHOULD offer services comparable to the native spam filtering offered by Microsoft.\nRationale: Spam is a constant threat as junk mail can reduce user productivity, fill up mailboxes unnecessarily, and in some cases include malicious links or attachments. Filtering out spam reduces user workload burden, prevents junk mail congestion, and reduces potentially malicious content exposure.\nRemediation action: Sign in to Microsoft 365 Defender. In the left-hand menu, go to Email \u0026 Collaboration \u003e Policies \u0026 Rules. Select Threat Policies. From the Templated policies section, select Preset Security Policies. Under Standard protection, slide the toggle switch to the right so the text next to the toggle reads Standard protection is on. Under Strict protection, slide the toggle switch to the right so the text next to the toggle reads Strict protection is on. Note: If the toggle slider in step 5 is grayed out, click on Manage protection settings instead and configure the policy settings according to Use the Microsoft 365 Defender portal to assign Standard and Strict preset security policies to users | Microsoft Learn.\nRelated links Defender admin center - Preset security policies CISA 14 Inbound Anti-Spam Protections - MS.EXO.14.4 CISA ScubaGear Rego Reference Test Results Skipped. Unable to validate 3rd party solutions.\nTag: MS.EXO MS.EXO.14.4 CISA Security All\nCategory: CISA SCuBA\nSource: C:\\maester-tests\\cisa\\exchange\\Test-MtCisaSpamAlternative.Tests.ps1\nMS.EXO.16.2: Alerts SHOULD be sent to a monitored address or incorporated into a security information and event management (SIEM) system. Overview Alerts SHOULD be sent to a monitored address or incorporated into a security information and event management (SIEM) system.\nRationale: Suspicious or malicious events, if not resolved promptly, may have a greater impact to users and the agency. Sending alerts to a monitored email address or SIEM system helps ensure these suspicious or malicious events are acted upon in a timely manner to limit overall impact.\nRemediation action: Sign in to Microsoft 365 Defender. Select Settings. Select either: a. Microsoft Sentinel. b. Defender XDR, and under General, select Streaming API. Ensure a SIEM integration is configured for your organization. Related links Defender admin center - Alert policy Defender admin center - Streaming API Defender admin center - Sentinel workspaces CISA 16 Alerts - MS.EXO.16.2 CISA ScubaGear Rego Reference Test Results Skipped. Not available for API validation.\nTag: MS.EXO MS.EXO.16.2 CISA Security All\nCategory: CISA SCuBA\nSource: C:\\maester-tests\\cisa\\exchange\\Test-MtCisaExoAlertSiem.Tests.ps1\nMT.1002: App management restrictions on applications and service principals is configured and enabled. Overview By default Microsoft Entra ID allows service principals and applications to be configured with weak credentials.\nThis can include\nclient secrets instead of certificates secrets and certificates with long expiry (e.g. 10 year) How to fix Using shorter expiry periods and certificates instead of secrets can help reduce the risk of credentials being compromised and used by an attacker.\nThe sample policy below can be used to enforce credential configurations on apps and service principals.\nImport-Module Microsoft.Graph.Identity.SignIns $params = @{ isEnabled = $true applicationRestrictions = @{ passwordCredentials = @( @{ restrictionType = \"passwordAddition\" maxLifetime = $null restrictForAppsCreatedAfterDateTime = [System.DateTime]::Parse(\"2021-01-01T10:37:00Z\") } @{ restrictionType = \"passwordLifetime\" maxLifetime = \"P365D\" restrictForAppsCreatedAfterDateTime = [System.DateTime]::Parse(\"2017-01-01T10:37:00Z\") } @{ restrictionType = \"symmetricKeyAddition\" maxLifetime = $null restrictForAppsCreatedAfterDateTime = [System.DateTime]::Parse(\"2021-01-01T10:37:00Z\") } @{ restrictionType = \"customPasswordAddition\" maxLifetime = $null restrictForAppsCreatedAfterDateTime = [System.DateTime]::Parse(\"2015-01-01T10:37:00Z\") } @{ restrictionType = \"symmetricKeyLifetime\" maxLifetime = \"P365D\" restrictForAppsCreatedAfterDateTime = [System.DateTime]::Parse(\"2015-01-01T10:37:00Z\") } ) keyCredentials = @( @{ restrictionType = \"asymmetricKeyLifetime\" maxLifetime = \"P365D\" restrictForAppsCreatedAfterDateTime = [System.DateTime]::Parse(\"2015-01-01T10:37:00Z\") } ) } } Update-MgPolicyDefaultAppManagementPolicy -BodyParameter $params Learn more Tenant App Management Policy - Microsoft Graph Reference Test Results Skipped. This test is for tenants that are licensed for Entra Workload ID. See Entra Workload ID licensing\nLearn more: https://maester.dev/docs/tests/MT.1002\nTag: Maester App Security All MT.1002\nCategory: App Management Policies\nSource: C:\\maester-tests\\Maester\\Entra\\Test-AppManagementPolicies.Tests.ps1\nMT.1021: Security Defaults are enabled. Overview Test Results Skipped. This test is for tenants that are not licensed for any Entra ID Premium license. See Entra ID licensing\nLearn more: https://maester.dev/docs/tests/MT.1021\nTag: CA Security All MT.1021\nCategory: Security Defaults\nSource: C:\\maester-tests\\Maester\\Entra\\Test-ConditionalAccessBaseline.Tests.ps1\nMT.1033: User should be blocked from using legacy authentication () Overview Test-MtCaWIFBlockLegacyAuthentication -UserId $id | Should -Be $true\nTag: MT.1033\nCategory: Regular users\nSource: C:\\maester-tests\\Maester\\Entra\\Test-ConditionalAccessWhatIf.Tests.ps1\nMT.1033: User should be blocked from using legacy authentication () Overview Test-MtCaWIFBlockLegacyAuthentication -UserId $id | Should -Be $true\nTag: MT.1033\nCategory: Regular users\nSource: C:\\maester-tests\\Maester\\Entra\\Test-ConditionalAccessWhatIf.Tests.ps1\nMT.1033: User should be blocked from using legacy authentication () Overview Test-MtCaWIFBlockLegacyAuthentication -UserId $id | Should -Be $true\nTag: MT.1033\nCategory: Regular users\nSource: C:\\maester-tests\\Maester\\Entra\\Test-ConditionalAccessWhatIf.Tests.ps1\nMT.1033: User should be blocked from using legacy authentication () Overview Test-MtCaWIFBlockLegacyAuthentication -UserId $id | Should -Be $true\nTag: MT.1033\nCategory: Regular users\nSource: C:\\maester-tests\\Maester\\Entra\\Test-ConditionalAccessWhatIf.Tests.ps1\nMT.1033: User should be blocked from using legacy authentication () Overview Test-MtCaWIFBlockLegacyAuthentication -UserId $id | Should -Be $true\nTag: MT.1033\nCategory: Regular users\nSource: C:\\maester-tests\\Maester\\Entra\\Test-ConditionalAccessWhatIf.Tests.ps1\nMT.1037 Only users with Presenter role are allowed to present in Teams meetings Overview This test checks the Org-wide default meeting policy is configured to only allow users in the Presenter role to request control and share content during meetings.\nRestricting who can present limits meeting disruptions and reduces the risk of unwanted or inappropriate content being shared.\nRemediation action: To prevent standard attendees from sharing content during Teams meetings:\nClick here to open Org-wide default settings \u003e Meetings Or navigate to Teams Admin Center. Click Settings \u0026 policies \u003e Org-wide default settings \u003e Meetings. Scroll to the Content sharing section. Set Participants can give or request control to Off. Click Save. Related links Manage meeting policies for content sharing 7 tips for safe online meetings and collaboration with Microsoft Teams - Tip 3: Determine who can present content or share their screen in your Teams meeting Test Results Skipped. Not connected to Teams. See Connecting to Teams\nTag: Maester Teams MeetingPolicy All MT.1037\nCategory: Teams Meeting policies\nSource: C:\\maester-tests\\Maester\\Teams\\Test-TeamsMeeting.Tests.ps1\nMT.1038 Only invited users should be automatically admitted to Teams meetings Overview Test Results Skipped. Not connected to Teams. See Connecting to Teams\nTag: Maester Teams MeetingPolicy All MT.1038\nCategory: Teams Meeting policies\nSource: C:\\maester-tests\\Maester\\Teams\\Test-TeamsMeeting.Tests.ps1\nMT.1039 Restrict anonymous users from joining meetings Overview Test Results Skipped. Not connected to Teams. See Connecting to Teams\nTag: Maester Teams MeetingPolicy All MT.1039\nCategory: Teams Meeting policies\nSource: C:\\maester-tests\\Maester\\Teams\\Test-TeamsMeeting.Tests.ps1\nMT.1040 Restrict anonymous users from starting Teams meetings Overview Test Results Skipped. Not connected to Teams. See Connecting to Teams\nTag: Maester Teams MeetingPolicy All MT.1040\nCategory: Teams Meeting policies\nSource: C:\\maester-tests\\Maester\\Teams\\Test-TeamsMeeting.Tests.ps1\nMT.1041 Limit external participants from having control in a Teams meeting Overview Test Results Skipped. Not connected to Teams. See Connecting to Teams\nTag: Maester Teams MeetingPolicy All MT.1041\nCategory: Teams Meeting policies\nSource: C:\\maester-tests\\Maester\\Teams\\Test-TeamsMeeting.Tests.ps1\nMT.1042 Restrict dial-in users from bypassing a meeting lobby Overview Test Results Skipped. Not connected to Teams. See Connecting to Teams\nTag: Maester Teams MeetingPolicy All MT.1042\nCategory: Teams Meeting policies\nSource: C:\\maester-tests\\Maester\\Teams\\Test-TeamsMeeting.Tests.ps1\nMaester 1.0.0","test-details#Test details":"","test-summary#Test summary":""},"title":"Master Test"},"/demo/o365/":{"data":{"":"","powershell-scripts-for-microsoft-365-management-reporting-and-auditing#PowerShell Scripts for Microsoft 365 Management, Reporting, and Auditing":" Comprehensive PowerShell repository tailored for managing, reporting Tableau. Optional title Stade DFG (CKD-EPI) Définition 1 \u003e 90 MRC avec DFG normal ou augmenté 2 60-89 MRC avec DFG légèrement diminué 3A 45-59 IRC modérée 3B 30-44 IRC modérée 4 15-29 IRC sévère 5 \u003c 15 IRC terminale "},"title":"Reports CSV"}}